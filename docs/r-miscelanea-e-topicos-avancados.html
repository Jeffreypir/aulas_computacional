<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 R - miscelânea e tópicos avançados | ESTATÍSTICA COMPUTACIONAL</title>
  <meta name="description" content="Disciplina de Estatística Computacional - Departamento de Estatística" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="5 R - miscelânea e tópicos avançados | ESTATÍSTICA COMPUTACIONAL" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://prdm0.github.io/aulas_computacional/" />
  
  <meta property="og:description" content="Disciplina de Estatística Computacional - Departamento de Estatística" />
  <meta name="github-repo" content="prdm0/aulas_computacional" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 R - miscelânea e tópicos avançados | ESTATÍSTICA COMPUTACIONAL" />
  
  <meta name="twitter:description" content="Disciplina de Estatística Computacional - Departamento de Estatística" />
  

<meta name="author" content="Docente: Prof. Dr. Pedro Rafael Diniz Marinho   E-mail: pedro.rafael.marinho@gmail.com / pedro@de.ufpb.br" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="relatorio-markdown-em-r.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.1/DiagrammeR.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Início</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#tecnologias-abordadas-no-curso"><i class="fa fa-check"></i>Tecnologias abordadas no curso</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#teorias-abordadas-no-curso"><i class="fa fa-check"></i>Teorias abordadas no curso</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#sugestoes-de-passos-para-revisao-da-linguagem-r"><i class="fa fa-check"></i>Sugestões de passos para revisão da linguagem R</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="revisao-basica-da-linguagem-r.html"><a href="revisao-basica-da-linguagem-r.html"><i class="fa fa-check"></i><b>1</b> Revisão básica da linguagem R</a><ul>
<li class="chapter" data-level="" data-path="revisao-basica-da-linguagem-r.html"><a href="revisao-basica-da-linguagem-r.html#exercicios-propostos"><i class="fa fa-check"></i>Exercícios propostos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html"><i class="fa fa-check"></i><b>2</b> O Evangelho do GNU/Linux</a><ul>
<li class="chapter" data-level="2.1" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html#um-breve-historico"><i class="fa fa-check"></i><b>2.1</b> Um breve histórico</a></li>
<li class="chapter" data-level="2.2" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html#vantagens-em-utilizar-gnulinux"><i class="fa fa-check"></i><b>2.2</b> Vantagens em utilizar GNU/Linux</a></li>
<li class="chapter" data-level="2.3" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html#algumas-distribuicoes"><i class="fa fa-check"></i><b>2.3</b> Algumas distribuições</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="versionamento-de-codigo.html"><a href="versionamento-de-codigo.html"><i class="fa fa-check"></i><b>3</b> Versionamento de código</a><ul>
<li class="chapter" data-level="3.1" data-path="versionamento-de-codigo.html"><a href="versionamento-de-codigo.html#git"><i class="fa fa-check"></i><b>3.1</b> Git</a></li>
<li class="chapter" data-level="3.2" data-path="versionamento-de-codigo.html"><a href="versionamento-de-codigo.html#github"><i class="fa fa-check"></i><b>3.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html"><i class="fa fa-check"></i><b>4</b> Relatório Markdown em R</a><ul>
<li class="chapter" data-level="4.1" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#markdown"><i class="fa fa-check"></i><b>4.1</b> Markdown</a></li>
<li class="chapter" data-level="4.2" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#subsecao"><i class="fa fa-check"></i><b>4.2</b> Subseção</a><ul>
<li class="chapter" data-level="4.2.1" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#sintaxe"><i class="fa fa-check"></i><b>4.2.1</b> Sintaxe</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#um-programador-que-nao-organiza-o-seu-codigo-deveria-morrer-mais-cedo"><i class="fa fa-check"></i><b>4.3</b> Um programador que não organiza o seu código deveria morrer mais cedo</a></li>
<li class="chapter" data-level="4.4" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#subsecao-1"><i class="fa fa-check"></i><b>4.4</b> Subseção</a><ul>
<li class="chapter" data-level="4.4.1" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#subsubsecao"><i class="fa fa-check"></i><b>4.4.1</b> Subsubseção</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#r-markdown"><i class="fa fa-check"></i><b>4.5</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html"><i class="fa fa-check"></i><b>5</b> R - miscelânea e tópicos avançados</a><ul>
<li class="chapter" data-level="5.1" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#operador---pipe"><i class="fa fa-check"></i><b>5.1</b> Operador %&gt;% - Pipe</a><ul>
<li class="chapter" data-level="" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#exercicios-1"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ESTATÍSTICA COMPUTACIONAL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r---miscelanea-e-topicos-avancados" class="section level1">
<h1><span class="header-section-number">5</span> R - miscelânea e tópicos avançados</h1>
<p>Nesse ponto será assumido que você realizou os passos de <a href="prefacio.html#sugestoes-de-passos-para-revisao-da-linguagem-r"><strong>revisão</strong></a> da linguagem R sugeridos, bem como resolveu os <a href="revisao-basica-da-linguagem-r.html#exercicios-propostos"><strong>exercícios propostos</strong></a>. Considerá-los é de grande importância para que você consiga assimilar os conceitos apresentados nesse <a href="r-miscelanea-e-topicos-avancados.html#r---miscelanea-e-topicos-avancados"><strong>Capítulo</strong></a>.</p>
<p>Esse <a href="r-miscelanea-e-topicos-avancados.html#r---miscelanea-e-topicos-avancados"><strong>Capítulo</strong></a> visa apresentar algumas miscelâneas a respeito da linguagem de programação R, bem como, alguns tópicos mais avançados de programação em R. O termo “<strong>avançado</strong>” utilizado aqui não necessariamente tem correlação com dificuldade de entendimento. Aqui utilizo esse termo para abordar assuntos que normalmente eram pouco discutidos em livros mais antigos da linguagem R e que atualmente vem ganhando destaques em livros e discussões mais recentes na internet. Na verdade, a maioria dos conceitos que serão abordados são de fácil compreensão, porẽm ajudarão os programadores em R a construir códigos mais robustos e mais flexíveis. Alguns desses assuntos que serão abordados e divididos em subseções são:</p>
<ol style="list-style-type: decimal">
<li><p>Pipe %&gt;%</p></li>
<li><p>Funções:</p>
<ul>
<li><p>Funcionais</p></li>
<li><p>Closures</p></li>
<li><p>dot-dot-dot, ..1 e etc</p></li>
<li><p>Orientação à objeto por função genérica (sistema S3)</p></li>
</ul></li>
<li><p>Regex</p></li>
<li><p>Tópicos em metaprogramação</p></li>
<li><p>Paralelismo</p></li>
<li><p>Empacotando funções</p></li>
</ol>
<div id="operador---pipe" class="section level2">
<h2><span class="header-section-number">5.1</span> Operador %&gt;% - Pipe</h2>
<p>Para que possamos entender a utilidade dos operadores pipe, em especial do operador <code>%&gt;%</code>, vamos fazer um pão de queijo. Adiante, você encontrará a receita com 7 passos enumerados que deverão serem seguidos para que possamos fazer o nosso pão de queijo.</p>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Esse material não garante que você terá sucesso, caso seja curioso e tente fazer a receita. Foque apenas no código. E se você for de Minas Gerais e saiba fazer pão de queijo, desconsidere qualquer inconsistência na receita. =)</p>
</div>
</div>

<p><strong>Ingredientes</strong>: 2 copos americanos de leite, 1 copo americano de água, 1/3 de um copo americano de óleo, 1 colher de sopa de sal, 500g de povilho doce, queijo ralado a gosto, 3 ovos.</p>
<p><strong>Passos do Preparo</strong>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Ferva</strong> o leite com a água e o óleo;</p></li>
<li><p>Em uma vasilha <strong>misture</strong> o polvilho e o sal;</p></li>
<li><p><strong>Jogue</strong> o liquido fervido e <strong>misture</strong> com uma colher grande;</p></li>
<li><p><strong>Espere</strong> esfriar (30 minutos) e <strong>despeje</strong> o queijo ralado e os ovos;</p></li>
<li><p><strong>Misture</strong> a massa com a mão <strong>amassando</strong> até ficar homogênea;</p></li>
<li><p><strong>Faça</strong> bolinhas do tamanho que preferir;</p></li>
<li><p><strong>Sirva</strong> quentinho;</p></li>
</ol>
<p>Assuma, por absurdo, que poderemos fazer nossos pães de queijo no R que que os verbos destacados nos passos acima são funções que implementamos em R. Dessa forma, forma, pelo que sabemos de R, poderemos fazer nossos pães de queijo de forma que segue:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sirva</span>(<span class="kw">fazer</span>(<span class="kw">misture</span>(<span class="kw">despeje</span>(<span class="kw">esperar</span>(<span class="kw">misture</span>(<span class="dt">ingredientes =</span> <span class="kw">c</span>(povilho, sal), <span class="dt">add =</span> <span class="kw">ferver</span>(<span class="kw">c</span>(leite, óleo),
      <span class="dt">add_agua =</span> <span class="ot">TRUE</span>), <span class="dt">colher_grande =</span> <span class="ot">TRUE</span>), <span class="dt">tempo =</span> <span class="dv">30</span>), <span class="dt">homogenea =</span> <span class="ot">TRUE</span>),
      <span class="dt">modo =</span> <span class="st">&quot;amassando&quot;</span>), <span class="dt">formato =</span> <span class="st">&quot;bolinha&quot;</span>), <span class="dt">modo =</span> <span class="st">&quot;quentinho&quot;</span>)</code></pre>
<p>Perceba que o código acima poderá ser um pouco confuso, uma vez que envolve muitas composições de funções. Porém, nada impede que você esteja salvando os resultados intermediários em objetos, de modo a facilitar a leitura do código ao relacionar esses objetos intermediários. Fazer isso funciona bem e eu particularmente utilizo muito. Porém, você também poderá fazer uso de pipes (operador <code>%&gt;%</code>) que poderá, nessas situações, deixar a leitura do código mais fácil, lógica e consequentimente mais compreensível., como veremos adiante.
O operador de tubo <code>%&gt;%</code> foi implementando no pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> por <a href="https://github.com/smbache"><strong>Stefan Milton Bache</strong></a> e atualmente recebe a colaboração de diversas pessoas, incluindo programadores da <a href="https://www.rstudio.com/"><strong>RStudio, Inc</strong></a>. Atualmente, o pacote não recebe muitas atualizações, muito provavelmente por já está estável e cumprindo bem o seu papel.</p>
<p>O nome <strong>magrittr</strong> muito provavelmente faz alusão à <a href="https://pt.wikipedia.org/wiki/Ren%C3%A9_Magritte"><strong>René Magritte</strong></a>, um dos principais pintores surrealista belga, em que a letra <strong>r</strong>, ao final, obviamente faz referências à linguagem R. É possível inferir isso com base no logo do pacote, apresentado logo abaixo:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="images/logo_magrittr.png" alt="Logo do pacote [**magrittr**](https://github.com/tidyverse/magrittr) com frase ***Ceci n'est pas une pipe*** ([**ouça a pronuncia**](files/audio_magrittr.ogg), mesmo frase que acompanha pintura ***La trahison des images*** de [**René Magritte**](https://pt.wikipedia.org/wiki/Ren%C3%A9_Magritte)." width="25%" />
<p class="caption">
Figura 5.1: Logo do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> com frase <strong><em>Ceci n’est pas une pipe</em></strong> (<a href="files/audio_magrittr.ogg"><strong>ouça a pronuncia</strong></a>, mesmo frase que acompanha pintura <strong><em>La trahison des images</em></strong> de <a href="https://pt.wikipedia.org/wiki/Ren%C3%A9_Magritte"><strong>René Magritte</strong></a>.
</p>
</div>
<p>Voltemos à algo mais interessante, ao preparo de pães de queijo. O preparo, “em R”, poderia ser quase tão saboroso quanto comer os pães de queijo, se fossem “preparados” utilizando o operador <code>%&gt;%</code>, na forma que segue:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fazendo pão de queijo utilizando o operador pipe, isto é,</span>
<span class="co"># utilizando o operador %&gt;%.</span>

<span class="kw">ferver</span>(<span class="dt">ingradientes =</span> <span class="kw">c</span>(leite,  água,  óleo)) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">misturar</span>(<span class="dt">colher_grande =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">esperar</span>(<span class="dt">tempo =</span> <span class="dv">30</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">despejar</span>(<span class="dt">ingredientes =</span> <span class="kw">c</span>(<span class="st">&quot;queijo&quot;</span>, <span class="st">&quot;ovos&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">amassar</span>(<span class="dt">forma =</span> <span class="st">&quot;mãos&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fazer_bolinhas</span>(<span class="dt">volume =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">sirvir</span>(<span class="dt">froma =</span> <span class="st">&quot;quentinho&quot;</span>)</code></pre>
<p>É possível observar que o código acima é consideravelmente mais legível que o código apresentado mais acima desta subseção. O código acima é mais legível, por que os verbos/funções são encadeadas na sequência lógica do preparo e não lidos de dentro para fora, como no primeiro exemplo. Olhando rapidamente para cada um dos códigos, percebemos que o código que faz uso do operador <code>%&gt;%</code> fornece mais informações a respeito do que se está à fazer.</p>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<p>Apesar de ser um operador útil, não exagere no uso de <code>%&gt;%</code>, principalmente quando se tem um conjunto de passos demasiadamente grande. Nessas situações, procure atribuir parte do código à objetos intermediários e depois componha esses objetos. Além disso, as funções envolvidas possuem diversas entradas e saídas, pode ser que o uso do operador <code>%&gt;%</code> não seja interessante.</p>
No RStudio, você poderá utilizar o atalho <strong>Ctrl + Shift + M</strong> como atalho para escrever mais rapidamente o operador <code>%&gt;%</code>.
</div>

<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<p>Como curiosidade, o recurso de pipes estão disponíveis em outras linguagens de programação, como <a href="https://pt.wikipedia.org/wiki/F_Sharp"><strong>F#</strong></a>, e os pielines de sistemas *<strong>nix</strong> que usa pipes para a <a href="https://en.wikipedia.org/wiki/Pipeline_(Unix)"><strong>comunicação entre os processos</strong></a> utilizando passagem de mensagens.</p>
</div>
</div>

<p>Você poderá instalar o <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> diretamente pelo CRAN ou por meio do repositório GitHub do pacote, ou seja, por meio de um dos comandos abaixo:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Instalando o pacote magrittr disponível</span>
<span class="co"># nos repositórios do CRAN.</span>
<span class="kw">library</span>(magrittr)

<span class="co"># ou</span>

<span class="co"># Para instalar pacotes diretamente do GitHub,</span>
<span class="co"># você de deve ter instalado o pacote</span>
<span class="co"># devtools para poder fazer uso da função</span>
<span class="co"># install_github().</span>

<span class="co"># Instalando o repositório magrittr do usuário/organização de</span>
<span class="co"># nome tidyverse do GitHub.</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tidyverse/magrittr&quot;</span>, <span class="dt">ref =</span> <span class="st">&quot;master&quot;</span>) </code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Há pontos positivos e negativos ao considerar a instalação de um pacote diretamente do epositório do pacote no GitHub ou em qualquer outro sistema de hospedagem de código. Mencionarei apenas GitHub, mas o comentário se extende à outros sistemas de hospedagem de códigos, como, por exemplo, o GitLab.</p>
<p>Basicamente, o ponto positivo refere-se à possibilidade de estarmos instalando uma versão mais recente do pacote, porém, em alguns casos, o pacote poderá apresentar alguns bugs, muito embora os códigos no <strong><em>branch master</em></strong> são normalmente estáveis e possuem códigos iguais aos que temos no CRAN.</p>
<p>Instalar diretamente um pacote que está sendo mantido no GitHub dará a possibilidade de instalar versões mais recentes do pacote que ainda não encontram-se no CRAN. Pelo GitHub, você também terá a vantagem de instalar versões mais antigas do pacote. Por exemplo, no repositório do <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>, no GitHub, você verá que, em <strong><em>Branch</em></strong>, haverá diversas versões versionadas do pacote, em que uma delas chama-se <strong>dev</strong>. Fazer <code>devtools::install_github("tidyverse/magrittr", ref = "dev")</code> fará com que você instale a versão de desenvolvimento do pacote. Dessa forma, aconselho que sempre considere a instalação da versão no <strong><em>branch master</em></strong> de qualquer pacote que venha instalar diretamente do GitHub. Assim, haverá menos possibilidade de você deparar-se com códigos que ainda não funcionam ou que possuam algum(s) bug(s).</p>
</div>
</div>

<p>Para um entendimento geral do operador <code>%&gt;%</code>, considere a existência dos objetos <code>x</code>, <code>y</code>e <code>f</code>. Então,</p>
<pre class="{r},"><code>x %&gt;% f(y)</code></pre>
<p>irá atribuir o objeto <code>x</code> à <code>f</code>, como <strong>primeiro argumento</strong> da função <code>f</code>, ou seja, será equivalente à fazer <code>f(x, y)</code>.</p>
<p>Porém, nem sempre desejamos introduzir o que está a esquerda do operador <code>%&gt;%</code> como primeiro agumento daquilo que está à sua direita. Para isso, poderemos fazer uso do caracter <code>.</code> (ponto). Esse caracter irá designar em qual posição será introduzido o objeto à esquerda de <code>%&gt;%</code> na função à sua direita. Por exemplo, a expressão <code>x %&gt;% f(a, b = .)</code> fará com que <code>x</code> à esqueda de <code>%&gt;%</code> seja substituído no lugar do caracter <code>.</code>, ou seja, <code>x</code> é passado como argumento à <code>b</code>, segundo argumento de <code>f</code>.</p>
<p><strong>Exemplo</strong>: Uso do caracter <code>.</code> em um contexto de bloco de instrução. Esse exemplo mostra que o que está a direita do operador <code>%&gt;%</code> não necessariamente precisa ser uma função. Nesses casos, o caracter <code>.</code> é de grande importância para que o operador saiba substituir corretamente o objeto <code>x</code> no bloco de instruções.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(magrittr)
x &lt;-<span class="st"> </span>mtcars
x <span class="op">%&gt;%</span><span class="st"> </span>{
  <span class="cf">if</span> (<span class="kw">is.data.frame</span>(.) <span class="op">||</span><span class="st"> </span><span class="kw">is.matrix</span>(.)){
    <span class="kw">cat</span>(<span class="st">&quot;A dimensão dos dados é&quot;</span>, <span class="kw">dim</span>(.))
  } <span class="cf">else</span> {
    <span class="kw">cat</span>(<span class="st">&quot;Objeto não é uma matriz ou um data frame&quot;</span>)
  }
}</code></pre>
<pre><code>## A dimensão dos dados é 32 11</code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Observe que, por exemplo, fazer <code>x %&gt;% f(., y = 1)</code> equivale a fazer <code>x %&gt;% f(y = 1)</code>, uma vez que por padrão, o objeto que está à esquerda de <code>%&gt;%</code>sempre será substituído como primeiro argumento da função que está mais a sua direta, caso não seja utilizado o caractere <code>.</code> para indicar o lugar do substituição.</p>
</div>
</div>

<p>Um outro operador útil disponível no pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> é o operator <strong><em>tee</em></strong>, denotado por <code>%T&gt;%</code>. Esse operador funciona de forma muito parecida com o operador <code>%&gt;%</code>, exceto pelo fato de que ele irá retornar o conteúdo do lado esquedo e <strong>não</strong> o resultado da operação do seu lado diretio.</p>
<p>O uso do operador <code>%T&gt;%</code> não é tão comum. Normalmente a frequência de uso do operador <code>%&gt;%</code> é muito maior. Porém, veja que não é possível resolver o exemplo que segue utilizando apenas o operador <code>%&gt;%</code>.</p>
<p><strong>Exemplo</strong>: Pelo que entendemos do operador <code>%&gt;%</code>, não faz nenhum sentido o código abaixo:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fixando uma semente.</span>
<span class="kw">set.seed</span>(<span class="dv">0</span>) 
<span class="kw">rnorm</span>(1000L) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">hist</span>(., <span class="dt">main =</span> <span class="st">&quot;Histograma Qualquer&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>,
                      <span class="dt">ylab =</span> <span class="st">&quot;Frequência&quot;) %&gt;% mean </span></code></pre>
<pre><code>## Warning in mean.default(.): argumento não é numérico nem lógico: retornando
## NA</code></pre>
<p><img src="r_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;" /></p>
<pre><code>## [1] NA</code></pre>
<p>Nesse exemplo, observamos que o histograma foi construído, porém, não faz nenhum sentido passar um gráfico à função <code>mean</code>. Muito provavelmente o desejo de quem viria escrever um código como esse seria tirar a média do vetor resultante do código <code>rnorm(1000L)</code>. Nessas situações, poderemos fazer uso do operador <code>%T&gt;%</code> (operador <strong><em>tee</em></strong>).</p>
<p><strong>Exemplo</strong>: Aqui temos um típico uso do operador <code>%T&gt;%</code>. Perceba que utilizando o perador <code>%T&gt;%</code>, foi possível passar <code>rnorm(1000L)</code> como argumento à função <code>hist</code>, assim como seria possível utilizando o operador <code>%&gt;%</code>. Porém, com o operador <code>%T&gt;%</code>, conseguimos passar <code>rnorm(1000L)</code> à função <code>mean</code> e não à função <code>hist</code>, que seria esperado se utilizássemos o operador <code>%&gt;%</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fixando uma semente.</span>
<span class="kw">set.seed</span>(<span class="dv">0</span>) 
<span class="kw">rnorm</span>(1000L) <span class="op">%T&gt;%</span><span class="st"> </span><span class="kw">hist</span>(., <span class="dt">main =</span> <span class="st">&quot;Histograma Qualquer&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>,
                       <span class="dt">ylab =</span> <span class="st">&quot;Frequência&quot;) %&gt;% mean </span></code></pre>
<p><img src="r_files/figure-html/unnamed-chunk-10-1.png" width="384" style="display: block; margin: auto;" /></p>
<pre><code>## [1] -0.01582957</code></pre>
<p>Um outro operador pipe que é bastante útil é o perador de exposição, denotado por <code>%$%</code>. Trata-se de um operador que é bastante útil quando estamos trabalhando com (quadro de dados) data frames ou matrizes, onde temos variáveis dispostas em suas colunas. Com esse operador, poderemos tornar visíveis as variáveis do objeto à sua esquerda nas funções à sua direita. Considere o exemplo que segue:</p>
<p><strong>Exemplo</strong>: No código que segue, estamos tornando visíveis as variáveis do objeto <code>mtcars</code> na função <code>cor</code>. Dessa forma, poderemos calcular a correlação entre as variáveis <strong>cyl</strong> e <strong>hp</strong> do data frame <strong>mtcars</strong>.</p>
<pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%$%</span><span class="st"> </span><span class="kw">cor</span>(cyl, hp)</code></pre>
<pre><code>## [1] 0.8324475</code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Normalmente esse operador é útil quando a função a direita não possui argumento de dados. Por exemplo, se o objetivo fosse calcular uma regressão linear simples com essas variáveis, poderíamos fazer:</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lm</span>(cyl <span class="op">~</span><span class="st"> </span>hp, <span class="dt">data =</span> .)</code></pre>
<pre><code>## 
## Call:
## lm(formula = cyl ~ hp, data = .)
## 
## Coefficients:
## (Intercept)           hp  
##     3.00680      0.02168</code></pre>
<p>uma vez que a função <code>lm</code> já possui um argumento para o conjunto de dados a ser utilizado. Ao passar o conjunto de dados para a função <code>lm</code>, todas as variáveis de <strong>mtcars</strong> estarão visíveis no interior da função <code>lm</code>.</p>
</div>
<p>Por fim e não menos importante, existe o operador de pipe compostos, denotado por <code>%&lt;&gt;%</code>. Esse operador é útil quando queremos realizar uma operação e atribuir essa modificação ao objeto à esquerda do operador. Considere um exemplo de uso do operador de pipe composto:</p>
<p><strong>Exemplo</strong>: Utilizando o operador <code>%&lt;&gt;%</code> para alterar o conteúdo da variável <strong>disp</strong> do data frame <strong>mtcars</strong>. Perceba que ao chamar mtcars, a variável <strong>disp</strong> agora é do tipo inteiro.</p>
<pre class="sourceCode r"><code class="sourceCode r">mtcars<span class="op">$</span>disp <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()
<span class="kw">str</span>(mtcars)</code></pre>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: int  160 160 108 258 360 225 360 146 140 167 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
<p><strong>Observação</strong>:</p>

<div class="rmdobservation">
<div class="text-justify">
<p>Alguns pacotes de R possuem vinhetas que facilitam o entendimento das funções empacotadas. Não necessariamente as vinhetas irão dissertar sobre todas as funções implementadas. Porém, essas vinhetas normalmente focam no que há de mais importante no pacote. Você poderá encontrar a vinheta do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html"><strong>aqui</strong></a>. Normalmente essas vinhetas são mais fáceis de serem lidas do que as documentações dos pacotes. Porém, consultar a documentação é o caminho correto para encontrar as respostas mais difícies e que muitas vezes não são abordadas nas vinhetas.</p>
</div>
</div>

<div id="exercicios-1" class="section level3 unnumbered">
<h3>Exercícios</h3>
<p>Resolva os exercícios que seguem. Os operadores pipes que você utilizará para resolver os exercícios não necessariamente irão produzir as melhores soluções. Porém, esses exercícios farão você pensar a respeito do emprego dos operadores e, aqui, é isso o que importará.</p>
<ol style="list-style-type: decimal">
<li><p>Resolva os itens abaixo utilizando o operador <code>%&gt;%</code> do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>:</p>
<ul>
<li><p><code>as.character(log(cos(sin(pi))))</code></p></li>
<li><p><code>round(var(seq(from = 1, to = 10, by = 0.5)), digits = 1)</code></p></li>
<li><p><code>summary(anova(lm(mpg ~ wt, data = mtcars)))</code></p></li>
<li><p><code>summary(lm(dist ~ log(accel), data = na.omit(attenu)))</code></p></li>
</ul></li>
<li><p>Sem salvar objetos intermediários, utilize operadore(s) pipe(s) para reescrever o código abaixo:</p>
<pre class="sourceCode r"><code class="sourceCode r">   dados &lt;-<span class="st"> </span><span class="kw">subset</span>(iris, Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(Sepal.Length))
   <span class="kw">cor</span>(dados<span class="op">$</span>Sepal.Length, dados<span class="op">$</span>Sepal.Width)</code></pre></li>
<li><p>Sem salvar objetos intermediários, utilize operadore(s) pipe(s) para reescrever o código abaixo:</p>
<pre class="sourceCode r"><code class="sourceCode r">   vetor &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>
   <span class="kw">plot</span>(<span class="kw">matrix</span>(<span class="dt">data =</span> vetor, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">nrow =</span> <span class="dv">5</span>))
   quantil &lt;-<span class="st"> </span><span class="kw">quantile</span>(vetor)
   <span class="kw">print</span>(quantil)</code></pre></li>
<li><p>Sem fazer uso dos operadores de atribuições <code>&lt;-</code> ou <code>=</code>, reescreva o código abaixo usando operadore(s) pipe(s):</p>
<pre class="sourceCode r"><code class="sourceCode r">   mtcars &lt;-<span class="st"> </span><span class="kw">transform</span>(mtcars, <span class="dt">cyl =</span> cyl <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)</code></pre></li>
<li><p>Considere o código abaixo que faz uso do operador <code>%&gt;%</code>. <strong>Dica</strong>: busque nas documentações do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>, o uso das funções <code>subtract</code> e <code>divide_by</code>. O que esse código faz? Reescreva-o sem fazer uso do operador <code>%&gt;%</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">    vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.7</span>, <span class="fl">2.74</span>, <span class="fl">5.66</span>, <span class="fl">8.13</span>, <span class="fl">4.04</span>)
    vetor <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">subtract</span>(., <span class="kw">mean</span>(.)) 
    vetor <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">divide_by</span>(., <span class="kw">sd</span>(.))</code></pre></li>
<li><p>Considere o código abaixo e reescreva-o utilizando o operador <code>%&gt;%</code> sem utilizar de passos intermediários. <strong>Dica</strong>: Procure identificar o uso da função <code>extract</code> do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">   <span class="co"># Essa função não deverá entrar no pipe.</span>
   <span class="kw">set.seed</span>(<span class="dv">0</span>) 

   x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">100</span>)
   x &lt;-<span class="st"> </span>x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>]
   <span class="kw">round</span>(<span class="kw">mean</span>(x), <span class="dt">digits =</span> <span class="dv">1</span>)</code></pre></li>
<li><p>Reescreva o código abaixo utilizando o operador pipe <code>%&gt;%</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">   dados &lt;-<span class="st"> </span><span class="kw">subset</span>(iris, Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>) 
   <span class="kw">aggregate</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species, dados, <span class="dt">FUN =</span> mean)</code></pre>
<p>Tente reescrever o código apenas utilizando o operador <code>%&gt;%</code>e depois modifique-o para utilizar o operador de exposição <code>%$%</code>. <strong>Dica</strong>: procure entender o emprego das funções <code>subset</code> e <code>aggregate</code>, funções dos pacotes <strong>base</strong> e <strong>stats</strong>, respectivamente.</p></li>
<li><p>Estude a vinheta do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>. Acesse a vinheta <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html"><strong>aqui</strong></a>.</p></li>
<li><p>Explique o que o código abaixo faz:</p>
<pre class="sourceCode r"><code class="sourceCode r">   f &lt;-<span class="st"> </span>. <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">subtract</span>(., <span class="kw">mean</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">divide_by</span>(., <span class="kw">sd</span>(.))</code></pre></li>
<li><p>Use o que aprendeu ao resolver o exercício anterior para reescrever o código abaixo usando pipes:</p>
<pre class="sourceCode r"><code class="sourceCode r">  vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.7</span>, <span class="fl">2.74</span>, <span class="fl">5.66</span>, <span class="fl">8.13</span>, <span class="fl">4.04</span>)
  <span class="kw">sum</span>(x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">/</span><span class="kw">sd</span>(x)</code></pre></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="relatorio-markdown-em-r.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/prdm0/aulas_computacional/edit/master/r.Rmd",
"text": "Editar"
},
"history": {
"link": null,
"text": null
},
"download": ["aulas_r.pdf"],
"toc": {
"collapse": "none"
},
"toolbar": {
"position": "fixed",
"download": "pdf",
"search": true
}
});
});
</script>

</body>

</html>
