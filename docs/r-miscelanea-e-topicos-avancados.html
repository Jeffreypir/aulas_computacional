<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 R - miscelânea e tópicos avançados | ESTATÍSTICA COMPUTACIONAL</title>
  <meta name="description" content="Disciplina de Estatística Computacional - Departamento de Estatística" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="5 R - miscelânea e tópicos avançados | ESTATÍSTICA COMPUTACIONAL" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://prdm0.github.io/aulas_computacional/" />
  
  <meta property="og:description" content="Disciplina de Estatística Computacional - Departamento de Estatística" />
  <meta name="github-repo" content="prdm0/aulas_computacional" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 R - miscelânea e tópicos avançados | ESTATÍSTICA COMPUTACIONAL" />
  
  <meta name="twitter:description" content="Disciplina de Estatística Computacional - Departamento de Estatística" />
  

<meta name="author" content="Docente: Prof. Dr. Pedro Rafael Diniz Marinho   E-mail: pedro.rafael.marinho@gmail.com / pedro@de.ufpb.br" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="relatorio-markdown-em-r.html">
<link rel="next" href="topicos-em-estatistica-computacional.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.1/DiagrammeR.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Início</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#tecnologias-abordadas-no-curso"><i class="fa fa-check"></i>Tecnologias abordadas no curso</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#teorias-abordadas-no-curso"><i class="fa fa-check"></i>Teorias abordadas no curso</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#sugestoes-de-passos-para-revisao-da-linguagem-r"><i class="fa fa-check"></i>Sugestões de passos para revisão da linguagem R</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="revisao-basica-da-linguagem-r.html"><a href="revisao-basica-da-linguagem-r.html"><i class="fa fa-check"></i><b>1</b> Revisão básica da linguagem R</a><ul>
<li class="chapter" data-level="" data-path="revisao-basica-da-linguagem-r.html"><a href="revisao-basica-da-linguagem-r.html#exercicios-propostos"><i class="fa fa-check"></i>Exercícios propostos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html"><i class="fa fa-check"></i><b>2</b> O Evangelho do GNU/Linux</a><ul>
<li class="chapter" data-level="2.1" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html#um-breve-historico"><i class="fa fa-check"></i><b>2.1</b> Um breve histórico</a></li>
<li class="chapter" data-level="2.2" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html#vantagens-em-utilizar-gnulinux"><i class="fa fa-check"></i><b>2.2</b> Vantagens em utilizar GNU/Linux</a></li>
<li class="chapter" data-level="2.3" data-path="o-evangelho-do-gnulinux.html"><a href="o-evangelho-do-gnulinux.html#algumas-distribuicoes"><i class="fa fa-check"></i><b>2.3</b> Algumas distribuições</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="versionamento-de-codigo.html"><a href="versionamento-de-codigo.html"><i class="fa fa-check"></i><b>3</b> Versionamento de código</a><ul>
<li class="chapter" data-level="3.1" data-path="versionamento-de-codigo.html"><a href="versionamento-de-codigo.html#git"><i class="fa fa-check"></i><b>3.1</b> Git</a></li>
<li class="chapter" data-level="3.2" data-path="versionamento-de-codigo.html"><a href="versionamento-de-codigo.html#github"><i class="fa fa-check"></i><b>3.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html"><i class="fa fa-check"></i><b>4</b> Relatório Markdown em R</a><ul>
<li class="chapter" data-level="4.1" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#markdown"><i class="fa fa-check"></i><b>4.1</b> Markdown</a><ul>
<li class="chapter" data-level="4.1.1" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#sintaxe"><i class="fa fa-check"></i><b>4.1.1</b> Sintaxe</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="relatorio-markdown-em-r.html"><a href="relatorio-markdown-em-r.html#r-markdown"><i class="fa fa-check"></i><b>4.2</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html"><i class="fa fa-check"></i><b>5</b> R - miscelânea e tópicos avançados</a><ul>
<li class="chapter" data-level="5.1" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#operador---pipe"><i class="fa fa-check"></i><b>5.1</b> Operador %&gt;% - Pipe</a><ul>
<li class="chapter" data-level="" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#exercicios-1"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#funcoes"><i class="fa fa-check"></i><b>5.2</b> Funções</a><ul>
<li class="chapter" data-level="5.2.1" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#passando-atributos"><i class="fa fa-check"></i><b>5.2.1</b> Passando atributos</a></li>
<li class="chapter" data-level="5.2.2" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#funcoes-anonimas"><i class="fa fa-check"></i><b>5.2.2</b> Funções anônimas</a></li>
<li class="chapter" data-level="5.2.3" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#escopo-lexico"><i class="fa fa-check"></i><b>5.2.3</b> Escopo léxico</a></li>
<li class="chapter" data-level="5.2.4" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#avaliacao-preguicosa"><i class="fa fa-check"></i><b>5.2.4</b> Avaliação preguiçosa</a></li>
<li class="chapter" data-level="5.2.5" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#varargs-dot-dot-dot"><i class="fa fa-check"></i><b>5.2.5</b> varargs: … (dot-dot-dot)</a></li>
<li class="chapter" data-level="5.2.6" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#funcoes-infixas"><i class="fa fa-check"></i><b>5.2.6</b> Funções infixas</a></li>
<li class="chapter" data-level="5.2.7" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#funcao-de-substituicao"><i class="fa fa-check"></i><b>5.2.7</b> Função de substituição</a></li>
<li class="chapter" data-level="5.2.8" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#closures"><i class="fa fa-check"></i><b>5.2.8</b> Closures</a></li>
<li class="chapter" data-level="" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#exercicios-2"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#funcionais"><i class="fa fa-check"></i><b>5.3</b> Funcionais</a><ul>
<li class="chapter" data-level="5.3.1" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#funcionais-do-r-base"><i class="fa fa-check"></i><b>5.3.1</b> Funcionais do R Base</a></li>
<li class="chapter" data-level="5.3.2" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#funcionais-do-pacote-purrr"><i class="fa fa-check"></i><b>5.3.2</b> Funcionais do pacote purrr</a></li>
<li class="chapter" data-level="" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#exercicios-3"><i class="fa fa-check"></i>Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#sistema-s3"><i class="fa fa-check"></i><b>5.4</b> Sistema S3</a><ul>
<li class="chapter" data-level="5.4.1" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#classes"><i class="fa fa-check"></i><b>5.4.1</b> Classes</a></li>
<li class="chapter" data-level="5.4.2" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#criando-funcoes-genericas"><i class="fa fa-check"></i><b>5.4.2</b> Criando funções genéricas</a></li>
<li class="chapter" data-level="" data-path="r-miscelanea-e-topicos-avancados.html"><a href="r-miscelanea-e-topicos-avancados.html#exercicio"><i class="fa fa-check"></i>Exercício</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html"><i class="fa fa-check"></i><b>6</b> Tópicos em Estatística Computacional</a><ul>
<li class="chapter" data-level="6.1" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#geracao-de-numeros-pseudo-aleatorios"><i class="fa fa-check"></i><b>6.1</b> Geração de Números Pseudo-Aleatórios</a><ul>
<li class="chapter" data-level="6.1.1" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#metodo-da-transformacao-inversa-caso-discreto"><i class="fa fa-check"></i><b>6.1.1</b> Método da Transformação Inversa (Caso Discreto)</a></li>
<li class="chapter" data-level="6.1.2" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#metodo-da-aceitacao-e-rejeicao"><i class="fa fa-check"></i><b>6.1.2</b> Método da aceitação e rejeição</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#exercicio-1"><i class="fa fa-check"></i>Exercício</a></li>
<li class="chapter" data-level="6.2" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#otimizacao-nao-linear"><i class="fa fa-check"></i><b>6.2</b> Otimização Não-Linear</a><ul>
<li class="chapter" data-level="6.2.1" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#metodos-gradiente"><i class="fa fa-check"></i><b>6.2.1</b> Metódos Gradiente</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#exercicio-2"><i class="fa fa-check"></i>Exercício</a></li>
<li class="chapter" data-level="6.3" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#monte-carlo"><i class="fa fa-check"></i><b>6.3</b> Monte Carlo</a><ul>
<li class="chapter" data-level="6.3.1" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#um-breve-historico-1"><i class="fa fa-check"></i><b>6.3.1</b> Um breve histórico</a></li>
<li class="chapter" data-level="6.3.2" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#metodos-de-monte-carlo"><i class="fa fa-check"></i><b>6.3.2</b> Métodos de Monte Carlo</a></li>
<li class="chapter" data-level="6.3.3" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#integracao-por-monte-carlo"><i class="fa fa-check"></i><b>6.3.3</b> Integração por Monte Carlo</a></li>
<li class="chapter" data-level="6.3.4" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#aproximando-o-valor-de-pi"><i class="fa fa-check"></i><b>6.3.4</b> Aproximando o valor de <span class="math inline">\(\pi\)</span></a></li>
<li class="chapter" data-level="6.3.5" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#paralelizando-um-procedimento-de-monte-carlo"><i class="fa fa-check"></i><b>6.3.5</b> Paralelizando um procedimento de Monte Carlo</a></li>
<li class="chapter" data-level="6.3.6" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#speedup"><i class="fa fa-check"></i><b>6.3.6</b> Speedup</a></li>
<li class="chapter" data-level="6.3.7" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#pacote-parallel"><i class="fa fa-check"></i><b>6.3.7</b> Pacote parallel</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#exercicio-3"><i class="fa fa-check"></i>Exercício</a></li>
<li class="chapter" data-level="6.4" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#bootstrap"><i class="fa fa-check"></i><b>6.4</b> Bootstrap</a><ul>
<li class="chapter" data-level="6.4.1" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#estimando-erro-padrao"><i class="fa fa-check"></i><b>6.4.1</b> Estimando erro-padrão</a></li>
<li class="chapter" data-level="6.4.2" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#diminuindo-o-vies"><i class="fa fa-check"></i><b>6.4.2</b> Diminuindo o viés</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="topicos-em-estatistica-computacional.html"><a href="topicos-em-estatistica-computacional.html#exercicio-4"><i class="fa fa-check"></i>Exercício</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ESTATÍSTICA COMPUTACIONAL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r---miscelanea-e-topicos-avancados" class="section level1">
<h1><span class="header-section-number">5</span> R - miscelânea e tópicos avançados</h1>
<p>Nesse ponto será assumido que você realizou os passos de <a href="prefacio.html#sugestoes-de-passos-para-revisao-da-linguagem-r"><strong>revisão</strong></a> da linguagem R sugeridos, bem como resolveu os <a href="revisao-basica-da-linguagem-r.html#exercicios-propostos"><strong>exercícios propostos</strong></a>. Considerá-los é de grande importância para que você consiga assimilar os conceitos apresentados nesse <a href="r-miscelanea-e-topicos-avancados.html#r---miscelanea-e-topicos-avancados"><strong>Capítulo</strong></a>.</p>
<p>Esse <a href="r-miscelanea-e-topicos-avancados.html#r---miscelanea-e-topicos-avancados"><strong>Capítulo</strong></a> visa apresentar algumas miscelâneas a respeito da linguagem de programação R, bem como, alguns tópicos mais avançados de programação em R. O termo “<strong>avançado</strong>” utilizado aqui não necessariamente tem correlação com dificuldade de entendimento. Aqui utilizo esse termo para abordar assuntos que normalmente eram pouco discutidos em livros mais antigos da linguagem R e que atualmente vem ganhando destaques em livros e discussões mais recentes na internet. Na verdade, a maioria dos conceitos que serão abordados são de fácil compreensão, porẽm ajudarão os programadores em R a construir códigos mais robustos e mais flexíveis. Alguns desses assuntos que serão abordados e divididos em subseções são:</p>
<ol style="list-style-type: decimal">
<li><p>Pipe %&gt;%</p></li>
<li><p>Funções:</p>
<ul>
<li><p>Funcionais</p></li>
<li><p>Closures</p></li>
<li><p>dot-dot-dot, ..1, ..2 e etc</p></li>
<li><p>Orientação à objeto por função genérica (sistema S3)</p></li>
</ul></li>
<li><p>Regex</p></li>
<li><p>Tópicos em metaprogramação</p></li>
<li><p>Paralelismo</p></li>
<li><p>Empacotando funções</p></li>
</ol>
<div id="operador---pipe" class="section level2">
<h2><span class="header-section-number">5.1</span> Operador %&gt;% - Pipe</h2>
<p>Para que possamos entender a utilidade dos operadores pipe, em especial do operador <code>%&gt;%</code>, vamos fazer um pão de queijo. Adiante, você encontrará a receita com 7 passos enumerados que deverão serem seguidos para que possamos fazer o nosso pão de queijo.</p>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Esse material não garante que você terá sucesso, caso seja curioso e tente fazer a receita. Foque apenas no código. E se você for de Minas Gerais e saiba fazer pão de queijo, desconsidere qualquer inconsistência na receita. =)</p>
</div>
</div>

<p><strong>Ingredientes</strong>: 2 copos americanos de leite, 1 copo americano de água, 1/3 de um copo americano de óleo, 1 colher de sopa de sal, 500g de povilho doce, queijo ralado a gosto, 3 ovos.</p>
<p><strong>Passos do Preparo</strong>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Ferva</strong> o leite com a água e o óleo;</p></li>
<li><p>Em uma vasilha <strong>misture</strong> o polvilho e o sal;</p></li>
<li><p><strong>Jogue</strong> o liquido fervido e <strong>misture</strong> com uma colher grande;</p></li>
<li><p><strong>Espere</strong> esfriar (30 minutos) e <strong>despeje</strong> o queijo ralado e os ovos;</p></li>
<li><p><strong>Misture</strong> a massa com a mão <strong>amassando</strong> até ficar homogênea;</p></li>
<li><p><strong>Faça</strong> bolinhas do tamanho que preferir;</p></li>
<li><p><strong>Sirva</strong> quentinho;</p></li>
</ol>
<p>Assuma, por absurdo, que poderemos fazer nossos pães de queijo no R que que os verbos destacados nos passos acima são funções que implementamos em R. Dessa forma, forma, pelo que sabemos de R, poderemos fazer nossos pães de queijo de forma que segue:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="r-miscelanea-e-topicos-avancados.html#cb53-1"></a><span class="kw">sirva</span>(<span class="kw">fazer</span>(<span class="kw">misture</span>(<span class="kw">despeje</span>(<span class="kw">esperar</span>(<span class="kw">misture</span>(<span class="dt">ingredientes =</span> <span class="kw">c</span>(povilho, sal), <span class="dt">add =</span> <span class="kw">ferver</span>(<span class="kw">c</span>(leite, óleo),</span>
<span id="cb53-2"><a href="r-miscelanea-e-topicos-avancados.html#cb53-2"></a>      <span class="dt">add_agua =</span> <span class="ot">TRUE</span>), <span class="dt">colher_grande =</span> <span class="ot">TRUE</span>), <span class="dt">tempo =</span> <span class="dv">30</span>), <span class="dt">homogenea =</span> <span class="ot">TRUE</span>),</span>
<span id="cb53-3"><a href="r-miscelanea-e-topicos-avancados.html#cb53-3"></a>      <span class="dt">modo =</span> <span class="st">&quot;amassando&quot;</span>), <span class="dt">formato =</span> <span class="st">&quot;bolinha&quot;</span>), <span class="dt">modo =</span> <span class="st">&quot;quentinho&quot;</span>)</span></code></pre></div>
<p>Perceba que o código acima poderá ser um pouco confuso, uma vez que envolve muitas composições de funções. Porém, nada impede que você esteja salvando os resultados intermediários em objetos, de modo a facilitar a leitura do código ao relacionar esses objetos intermediários. Fazer isso funciona bem e eu particularmente utilizo muito. Porém, você também poderá fazer uso de pipes (operador <code>%&gt;%</code>) que poderá, nessas situações, deixar a leitura do código mais fácil, lógica e consequentimente mais compreensível., como veremos adiante.
O operador de tubo <code>%&gt;%</code> foi implementando no pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> por <a href="https://github.com/smbache"><strong>Stefan Milton Bache</strong></a> e atualmente recebe a colaboração de diversas pessoas, incluindo programadores da <a href="https://www.rstudio.com/"><strong>RStudio, Inc</strong></a>. Atualmente, o pacote não recebe muitas atualizações, muito provavelmente por já está estável e cumprindo bem o seu papel.</p>
<p>O nome <strong>magrittr</strong> muito provavelmente faz alusão à <a href="https://pt.wikipedia.org/wiki/Ren%C3%A9_Magritte"><strong>René Magritte</strong></a>, um dos principais pintores surrealista belga, em que a letra <strong>r</strong>, ao final, obviamente faz referências à linguagem R. É possível inferir isso com base no logo do pacote, apresentado logo abaixo:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="images/logo_magrittr.png" alt="Logo do pacote [**magrittr**](https://github.com/tidyverse/magrittr) com frase ***Ceci n'est pas une pipe*** ([**ouça a pronuncia**](files/audio_magrittr.ogg), mesmo frase que acompanha pintura ***La trahison des images*** de [**René Magritte**](https://pt.wikipedia.org/wiki/Ren%C3%A9_Magritte)." width="25%" />
<p class="caption">
Figura 5.1: Logo do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> com frase <strong><em>Ceci n’est pas une pipe</em></strong> (<a href="files/audio_magrittr.ogg"><strong>ouça a pronuncia</strong></a>, mesmo frase que acompanha pintura <strong><em>La trahison des images</em></strong> de <a href="https://pt.wikipedia.org/wiki/Ren%C3%A9_Magritte"><strong>René Magritte</strong></a>.
</p>
</div>
<p>Voltemos à algo mais interessante, ao preparo de pães de queijo. O preparo, “em R”, poderia ser quase tão saboroso quanto comer os pães de queijo, se fossem “preparados” utilizando o operador <code>%&gt;%</code>, na forma que segue:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="r-miscelanea-e-topicos-avancados.html#cb54-1"></a><span class="co"># Fazendo pão de queijo utilizando o operador pipe, isto é,</span></span>
<span id="cb54-2"><a href="r-miscelanea-e-topicos-avancados.html#cb54-2"></a><span class="co"># utilizando o operador %&gt;%.</span></span>
<span id="cb54-3"><a href="r-miscelanea-e-topicos-avancados.html#cb54-3"></a></span>
<span id="cb54-4"><a href="r-miscelanea-e-topicos-avancados.html#cb54-4"></a><span class="kw">ferver</span>(<span class="dt">ingradientes =</span> <span class="kw">c</span>(leite,  água,  óleo)) <span class="op">%&gt;%</span></span>
<span id="cb54-5"><a href="r-miscelanea-e-topicos-avancados.html#cb54-5"></a><span class="st">   </span><span class="kw">misturar</span>(<span class="dt">colher_grande =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb54-6"><a href="r-miscelanea-e-topicos-avancados.html#cb54-6"></a><span class="st">   </span><span class="kw">esperar</span>(<span class="dt">tempo =</span> <span class="dv">30</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">despejar</span>(<span class="dt">ingredientes =</span> <span class="kw">c</span>(<span class="st">&quot;queijo&quot;</span>, <span class="st">&quot;ovos&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb54-7"><a href="r-miscelanea-e-topicos-avancados.html#cb54-7"></a><span class="st">   </span><span class="kw">amassar</span>(<span class="dt">forma =</span> <span class="st">&quot;mãos&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fazer_bolinhas</span>(<span class="dt">volume =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb54-8"><a href="r-miscelanea-e-topicos-avancados.html#cb54-8"></a><span class="st">   </span><span class="kw">sirvir</span>(<span class="dt">froma =</span> <span class="st">&quot;quentinho&quot;</span>)</span></code></pre></div>
<p>É possível observar que o código acima é consideravelmente mais legível que o código apresentado mais acima desta subseção. O código acima é mais legível, por que os verbos/funções são encadeadas na sequência lógica do preparo e não lidos de dentro para fora, como no primeiro exemplo. Olhando rapidamente para cada um dos códigos, percebemos que o código que faz uso do operador <code>%&gt;%</code> fornece mais informações a respeito do que se está à fazer.</p>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<p>Apesar de ser um operador útil, não exagere no uso de <code>%&gt;%</code>, principalmente quando se tem um conjunto de passos demasiadamente grande. Nessas situações, procure atribuir parte do código à objetos intermediários e depois componha esses objetos. Além disso, as funções envolvidas possuem diversas entradas e saídas, pode ser que o uso do operador <code>%&gt;%</code> não seja interessante.</p>
No RStudio, você poderá utilizar o atalho <strong>Ctrl + Shift + M</strong> como atalho para escrever mais rapidamente o operador <code>%&gt;%</code>.
</div>

<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<p>Como curiosidade, o recurso de pipes estão disponíveis em outras linguagens de programação, como <a href="https://pt.wikipedia.org/wiki/F_Sharp"><strong>F#</strong></a>, e os pielines de sistemas *<strong>nix</strong> que usa pipes para a <a href="https://en.wikipedia.org/wiki/Pipeline_(Unix)"><strong>comunicação entre os processos</strong></a> utilizando passagem de mensagens.</p>
</div>
</div>

<p>Você poderá instalar o <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> diretamente pelo CRAN ou por meio do repositório GitHub do pacote, ou seja, por meio de um dos comandos abaixo:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="r-miscelanea-e-topicos-avancados.html#cb55-1"></a><span class="co"># Instalando o pacote magrittr disponível</span></span>
<span id="cb55-2"><a href="r-miscelanea-e-topicos-avancados.html#cb55-2"></a><span class="co"># nos repositórios do CRAN.</span></span>
<span id="cb55-3"><a href="r-miscelanea-e-topicos-avancados.html#cb55-3"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb55-4"><a href="r-miscelanea-e-topicos-avancados.html#cb55-4"></a></span>
<span id="cb55-5"><a href="r-miscelanea-e-topicos-avancados.html#cb55-5"></a><span class="co"># ou</span></span>
<span id="cb55-6"><a href="r-miscelanea-e-topicos-avancados.html#cb55-6"></a></span>
<span id="cb55-7"><a href="r-miscelanea-e-topicos-avancados.html#cb55-7"></a><span class="co"># Para instalar pacotes diretamente do GitHub,</span></span>
<span id="cb55-8"><a href="r-miscelanea-e-topicos-avancados.html#cb55-8"></a><span class="co"># você de deve ter instalado o pacote</span></span>
<span id="cb55-9"><a href="r-miscelanea-e-topicos-avancados.html#cb55-9"></a><span class="co"># devtools para poder fazer uso da função</span></span>
<span id="cb55-10"><a href="r-miscelanea-e-topicos-avancados.html#cb55-10"></a><span class="co"># install_github().</span></span>
<span id="cb55-11"><a href="r-miscelanea-e-topicos-avancados.html#cb55-11"></a></span>
<span id="cb55-12"><a href="r-miscelanea-e-topicos-avancados.html#cb55-12"></a><span class="co"># Instalando o repositório magrittr do usuário/organização de</span></span>
<span id="cb55-13"><a href="r-miscelanea-e-topicos-avancados.html#cb55-13"></a><span class="co"># nome tidyverse do GitHub.</span></span>
<span id="cb55-14"><a href="r-miscelanea-e-topicos-avancados.html#cb55-14"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tidyverse/magrittr&quot;</span>, <span class="dt">ref =</span> <span class="st">&quot;master&quot;</span>) </span></code></pre></div>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Há pontos positivos e negativos ao considerar a instalação de um pacote diretamente do epositório do pacote no GitHub ou em qualquer outro sistema de hospedagem de código. Mencionarei apenas GitHub, mas o comentário se extende à outros sistemas de hospedagem de códigos, como, por exemplo, o GitLab.</p>
<p>Basicamente, o ponto positivo refere-se à possibilidade de estarmos instalando uma versão mais recente do pacote, porém, em alguns casos, o pacote poderá apresentar alguns bugs, muito embora os códigos no <strong><em>branch master</em></strong> são normalmente estáveis e possuem códigos iguais aos que temos no CRAN.</p>
<p>Instalar diretamente um pacote que está sendo mantido no GitHub dará a possibilidade de instalar versões mais recentes do pacote que ainda não encontram-se no CRAN. Pelo GitHub, você também terá a vantagem de instalar versões mais antigas do pacote. Por exemplo, no repositório do <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>, no GitHub, você verá que, em <strong><em>Branch</em></strong>, haverá diversas versões versionadas do pacote, em que uma delas chama-se <strong>dev</strong>. Fazer <code>devtools::install_github("tidyverse/magrittr", ref = "dev")</code> fará com que você instale a versão de desenvolvimento do pacote. Dessa forma, aconselho que sempre considere a instalação da versão no <strong><em>branch master</em></strong> de qualquer pacote que venha instalar diretamente do GitHub. Assim, haverá menos possibilidade de você deparar-se com códigos que ainda não funcionam ou que possuam algum(s) bug(s).</p>
</div>
</div>

<p>Para um entendimento geral do operador <code>%&gt;%</code>, considere a existência dos objetos <code>x</code>, <code>y</code>e <code>f</code>. Então,</p>
<pre class="{r},"><code>x %&gt;% f(y)</code></pre>
<p>irá atribuir o objeto <code>x</code> à <code>f</code>, como <strong>primeiro argumento</strong> da função <code>f</code>, ou seja, será equivalente à fazer <code>f(x, y)</code>.</p>
<p>Porém, nem sempre desejamos introduzir o que está a esquerda do operador <code>%&gt;%</code> como primeiro agumento daquilo que está à sua direita. Para isso, poderemos fazer uso do caracter <code>.</code> (ponto). Esse caracter irá designar em qual posição será introduzido o objeto à esquerda de <code>%&gt;%</code> na função à sua direita. Por exemplo, a expressão <code>x %&gt;% f(a, b = .)</code> fará com que <code>x</code> à esqueda de <code>%&gt;%</code> seja substituído no lugar do caracter <code>.</code>, ou seja, <code>x</code> é passado como argumento à <code>b</code>, segundo argumento de <code>f</code>.</p>
<p><strong>Exemplo</strong>: Uso do caracter <code>.</code> em um contexto de bloco de instrução. Esse exemplo mostra que o que está a direita do operador <code>%&gt;%</code> não necessariamente precisa ser uma função. Nesses casos, o caracter <code>.</code> é de grande importância para que o operador saiba substituir corretamente o objeto <code>x</code> no bloco de instruções.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="r-miscelanea-e-topicos-avancados.html#cb57-1"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb57-2"><a href="r-miscelanea-e-topicos-avancados.html#cb57-2"></a>x &lt;-<span class="st"> </span>mtcars</span>
<span id="cb57-3"><a href="r-miscelanea-e-topicos-avancados.html#cb57-3"></a>x <span class="op">%&gt;%</span><span class="st"> </span>{</span>
<span id="cb57-4"><a href="r-miscelanea-e-topicos-avancados.html#cb57-4"></a>  <span class="cf">if</span> (<span class="kw">is.data.frame</span>(.) <span class="op">||</span><span class="st"> </span><span class="kw">is.matrix</span>(.)){</span>
<span id="cb57-5"><a href="r-miscelanea-e-topicos-avancados.html#cb57-5"></a>    <span class="kw">cat</span>(<span class="st">&quot;A dimensão dos dados é&quot;</span>, <span class="kw">dim</span>(.))</span>
<span id="cb57-6"><a href="r-miscelanea-e-topicos-avancados.html#cb57-6"></a>  } <span class="cf">else</span> {</span>
<span id="cb57-7"><a href="r-miscelanea-e-topicos-avancados.html#cb57-7"></a>    <span class="kw">cat</span>(<span class="st">&quot;Objeto não é uma matriz ou um data frame&quot;</span>)</span>
<span id="cb57-8"><a href="r-miscelanea-e-topicos-avancados.html#cb57-8"></a>  }</span>
<span id="cb57-9"><a href="r-miscelanea-e-topicos-avancados.html#cb57-9"></a>}</span></code></pre></div>
<pre><code>## A dimensão dos dados é 32 11</code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Observe que, por exemplo, fazer <code>x %&gt;% f(., y = 1)</code> equivale a fazer <code>x %&gt;% f(y = 1)</code>, uma vez que por padrão, o objeto que está à esquerda de <code>%&gt;%</code>sempre será substituído como primeiro argumento da função que está mais a sua direta, caso não seja utilizado o caractere <code>.</code> para indicar o lugar do substituição.</p>
</div>
</div>

<p>Um outro operador útil disponível no pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> é o operator <strong><em>tee</em></strong>, denotado por <code>%T&gt;%</code>. Esse operador funciona de forma muito parecida com o operador <code>%&gt;%</code>, exceto pelo fato de que ele irá retornar o conteúdo do lado esquedo e <strong>não</strong> o resultado da operação do seu lado diretio.</p>
<p>O uso do operador <code>%T&gt;%</code> não é tão comum. Normalmente a frequência de uso do operador <code>%&gt;%</code> é muito maior. Porém, veja que não é possível resolver o exemplo que segue utilizando apenas o operador <code>%&gt;%</code>.</p>
<p><strong>Exemplo</strong>: Pelo que entendemos do operador <code>%&gt;%</code>, não faz nenhum sentido o código abaixo:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="r-miscelanea-e-topicos-avancados.html#cb59-1"></a><span class="co"># Fixando uma semente.</span></span>
<span id="cb59-2"><a href="r-miscelanea-e-topicos-avancados.html#cb59-2"></a><span class="kw">set.seed</span>(<span class="dv">0</span>) </span>
<span id="cb59-3"><a href="r-miscelanea-e-topicos-avancados.html#cb59-3"></a><span class="kw">rnorm</span>(1000L) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">hist</span>(., <span class="dt">main =</span> <span class="st">&quot;Histograma Qualquer&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb59-4"><a href="r-miscelanea-e-topicos-avancados.html#cb59-4"></a>                      <span class="dt">ylab =</span> <span class="st">&quot;Frequência&quot;, col = rgb(1, 0.9, 0.8), border = NA) %&gt;% mean </span></span></code></pre></div>
<pre><code>## Warning in mean.default(.): argumento não é numérico nem lógico: retornando
## NA</code></pre>
<p><img src="r_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;" /></p>
<pre><code>## [1] NA</code></pre>
<p>Nesse exemplo, observamos que o histograma foi construído, porém, não faz nenhum sentido passar um gráfico à função <code>mean</code>. Muito provavelmente o desejo de quem viria escrever um código como esse seria tirar a média do vetor resultante do código <code>rnorm(1000L)</code>. Nessas situações, poderemos fazer uso do operador <code>%T&gt;%</code> (operador <strong><em>tee</em></strong>).</p>
<p><strong>Exemplo</strong>: Aqui temos um típico uso do operador <code>%T&gt;%</code>. Perceba que utilizando o perador <code>%T&gt;%</code>, foi possível passar <code>rnorm(1000L)</code> como argumento à função <code>hist</code>, assim como seria possível utilizando o operador <code>%&gt;%</code>. Porém, com o operador <code>%T&gt;%</code>, conseguimos passar <code>rnorm(1000L)</code> à função <code>mean</code> e não à função <code>hist</code>, que seria esperado se utilizássemos o operador <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="r-miscelanea-e-topicos-avancados.html#cb62-1"></a><span class="co"># Fixando uma semente.</span></span>
<span id="cb62-2"><a href="r-miscelanea-e-topicos-avancados.html#cb62-2"></a><span class="kw">set.seed</span>(<span class="dv">0</span>) </span>
<span id="cb62-3"><a href="r-miscelanea-e-topicos-avancados.html#cb62-3"></a><span class="kw">rnorm</span>(1000L) <span class="op">%T&gt;%</span><span class="st"> </span><span class="kw">hist</span>(., <span class="dt">main =</span> <span class="st">&quot;Histograma Qualquer&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb62-4"><a href="r-miscelanea-e-topicos-avancados.html#cb62-4"></a>                       <span class="dt">ylab =</span> <span class="st">&quot;Frequência&quot;, col = rgb(1, 0.9, 0.8), border = NA) %&gt;% mean </span></span></code></pre></div>
<p><img src="r_files/figure-html/unnamed-chunk-10-1.png" width="384" style="display: block; margin: auto;" /></p>
<pre><code>## [1] -0.01582957</code></pre>
<p>Um outro operador pipe que é bastante útil é o perador de exposição, denotado por <code>%$%</code>. Trata-se de um operador que é bastante útil quando estamos trabalhando com (quadro de dados) data frames ou matrizes, onde temos variáveis dispostas em suas colunas. Com esse operador, poderemos tornar visíveis as variáveis do objeto à sua esquerda nas funções à sua direita. Considere o exemplo que segue:</p>
<p><strong>Exemplo</strong>: No código que segue, estamos tornando visíveis as variáveis do objeto <code>mtcars</code> na função <code>cor</code>. Dessa forma, poderemos calcular a correlação entre as variáveis <strong>cyl</strong> e <strong>hp</strong> do data frame <strong>mtcars</strong>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="r-miscelanea-e-topicos-avancados.html#cb64-1"></a>mtcars <span class="op">%$%</span><span class="st"> </span><span class="kw">cor</span>(cyl, hp)</span></code></pre></div>
<pre><code>## [1] 0.8324475</code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Normalmente esse operador é útil quando a função a direita não possui argumento de dados. Por exemplo, se o objetivo fosse calcular uma regressão linear simples com essas variáveis, poderíamos fazer:</p>
</div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="r-miscelanea-e-topicos-avancados.html#cb66-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lm</span>(cyl <span class="op">~</span><span class="st"> </span>hp, <span class="dt">data =</span> .)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = cyl ~ hp, data = .)
## 
## Coefficients:
## (Intercept)           hp  
##     3.00680      0.02168</code></pre>
<p>uma vez que a função <code>lm</code> já possui um argumento para o conjunto de dados a ser utilizado. Ao passar o conjunto de dados para a função <code>lm</code>, todas as variáveis de <strong>mtcars</strong> estarão visíveis no interior da função <code>lm</code>.</p>
</div>
<p>Por fim e não menos importante, existe o operador de pipe compostos, denotado por <code>%&lt;&gt;%</code>. Esse operador é útil quando queremos realizar uma operação e atribuir essa modificação ao objeto à esquerda do operador. Considere um exemplo de uso do operador de pipe composto:</p>
<p><strong>Exemplo</strong>: Utilizando o operador <code>%&lt;&gt;%</code> para alterar o conteúdo da variável <strong>disp</strong> do data frame <strong>mtcars</strong>. Perceba que ao chamar mtcars, a variável <strong>disp</strong> agora é do tipo inteiro.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="r-miscelanea-e-topicos-avancados.html#cb68-1"></a>mtcars<span class="op">$</span>disp <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()</span>
<span id="cb68-2"><a href="r-miscelanea-e-topicos-avancados.html#cb68-2"></a><span class="kw">str</span>(mtcars)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: int  160 160 108 258 360 225 360 146 140 167 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
<p><strong>Observação</strong>:</p>

<div class="rmdobservation">
<div class="text-justify">
<p>Alguns pacotes de R possuem vinhetas que facilitam o entendimento das funções empacotadas. Não necessariamente as vinhetas irão dissertar sobre todas as funções implementadas. Porém, essas vinhetas normalmente focam no que há de mais importante no pacote. Você poderá encontrar a vinheta do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a> <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html"><strong>aqui</strong></a>. Normalmente essas vinhetas são mais fáceis de serem lidas do que as documentações dos pacotes. Porém, consultar a documentação é o caminho correto para encontrar as respostas mais difícies e que muitas vezes não são abordadas nas vinhetas.</p>
</div>
</div>

<div id="exercicios-1" class="section level3 unnumbered">
<h3>Exercícios</h3>
<p>Resolva os exercícios que seguem. Os operadores pipes que você utilizará para resolver os exercícios não necessariamente irão produzir as melhores soluções. Porém, esses exercícios farão você pensar a respeito do emprego dos operadores e, aqui, é isso o que importará.</p>
<ol style="list-style-type: decimal">
<li><p>Resolva os itens abaixo utilizando o operador <code>%&gt;%</code> do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>:</p>
<ul>
<li><p><code>as.character(log(cos(sin(pi))))</code></p></li>
<li><p><code>round(var(seq(from = 1, to = 10, by = 0.5)), digits = 1)</code></p></li>
<li><p><code>summary(anova(lm(mpg ~ wt, data = mtcars)))</code></p></li>
<li><p><code>summary(lm(dist ~ log(accel), data = na.omit(attenu)))</code></p></li>
</ul></li>
<li><p>Sem salvar objetos intermediários, utilize operadore(s) pipe(s) para reescrever o código abaixo:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="r-miscelanea-e-topicos-avancados.html#cb70-1"></a>   dados &lt;-<span class="st"> </span><span class="kw">subset</span>(iris, Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(Sepal.Length))</span>
<span id="cb70-2"><a href="r-miscelanea-e-topicos-avancados.html#cb70-2"></a>   <span class="kw">cor</span>(dados<span class="op">$</span>Sepal.Length, dados<span class="op">$</span>Sepal.Width)</span></code></pre></div></li>
<li><p>Sem salvar objetos intermediários, utilize operadore(s) pipe(s) para reescrever o código abaixo:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="r-miscelanea-e-topicos-avancados.html#cb71-1"></a>   vetor &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb71-2"><a href="r-miscelanea-e-topicos-avancados.html#cb71-2"></a>   <span class="kw">plot</span>(<span class="kw">matrix</span>(<span class="dt">data =</span> vetor, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">nrow =</span> <span class="dv">5</span>))</span>
<span id="cb71-3"><a href="r-miscelanea-e-topicos-avancados.html#cb71-3"></a>   quantil &lt;-<span class="st"> </span><span class="kw">quantile</span>(vetor)</span>
<span id="cb71-4"><a href="r-miscelanea-e-topicos-avancados.html#cb71-4"></a>   <span class="kw">print</span>(quantil)</span></code></pre></div></li>
<li><p>Sem fazer uso dos operadores de atribuições <code>&lt;-</code> ou <code>=</code>, reescreva o código abaixo usando operadore(s) pipe(s):</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="r-miscelanea-e-topicos-avancados.html#cb72-1"></a>   mtcars &lt;-<span class="st"> </span><span class="kw">transform</span>(mtcars, <span class="dt">cyl =</span> cyl <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div></li>
<li><p>Considere o código abaixo que faz uso do operador <code>%&gt;%</code>. <strong>Dica</strong>: busque nas documentações do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>, o uso das funções <code>subtract</code> e <code>divide_by</code>. O que esse código faz? Reescreva-o sem fazer uso do operador <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="r-miscelanea-e-topicos-avancados.html#cb73-1"></a>    vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.7</span>, <span class="fl">2.74</span>, <span class="fl">5.66</span>, <span class="fl">8.13</span>, <span class="fl">4.04</span>)</span>
<span id="cb73-2"><a href="r-miscelanea-e-topicos-avancados.html#cb73-2"></a>    vetor <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">subtract</span>(., <span class="kw">mean</span>(.)) </span>
<span id="cb73-3"><a href="r-miscelanea-e-topicos-avancados.html#cb73-3"></a>    vetor <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">divide_by</span>(., <span class="kw">sd</span>(.))</span></code></pre></div></li>
<li><p>Considere o código abaixo e reescreva-o utilizando o operador <code>%&gt;%</code> sem utilizar de passos intermediários. <strong>Dica</strong>: Procure identificar o uso da função <code>extract</code> do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="r-miscelanea-e-topicos-avancados.html#cb74-1"></a>   <span class="co"># Essa função não deverá entrar no pipe.</span></span>
<span id="cb74-2"><a href="r-miscelanea-e-topicos-avancados.html#cb74-2"></a>   <span class="kw">set.seed</span>(<span class="dv">0</span>) </span>
<span id="cb74-3"><a href="r-miscelanea-e-topicos-avancados.html#cb74-3"></a></span>
<span id="cb74-4"><a href="r-miscelanea-e-topicos-avancados.html#cb74-4"></a>   x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">100</span>)</span>
<span id="cb74-5"><a href="r-miscelanea-e-topicos-avancados.html#cb74-5"></a>   x &lt;-<span class="st"> </span>x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>]</span>
<span id="cb74-6"><a href="r-miscelanea-e-topicos-avancados.html#cb74-6"></a>   <span class="kw">round</span>(<span class="kw">mean</span>(x), <span class="dt">digits =</span> <span class="dv">1</span>)</span></code></pre></div></li>
<li><p>Reescreva o código abaixo utilizando o operador pipe <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="r-miscelanea-e-topicos-avancados.html#cb75-1"></a>   dados &lt;-<span class="st"> </span><span class="kw">subset</span>(iris, Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>) </span>
<span id="cb75-2"><a href="r-miscelanea-e-topicos-avancados.html#cb75-2"></a>   <span class="kw">aggregate</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species, dados, <span class="dt">FUN =</span> mean)</span></code></pre></div>
<p>Tente reescrever o código apenas utilizando o operador <code>%&gt;%</code>e depois modifique-o para utilizar o operador de exposição <code>%$%</code>. <strong>Dica</strong>: procure entender o emprego das funções <code>subset</code> e <code>aggregate</code>, funções dos pacotes <strong>base</strong> e <strong>stats</strong>, respectivamente.</p></li>
<li><p>Estude a vinheta do pacote <a href="https://github.com/tidyverse/magrittr"><strong>magrittr</strong></a>. Acesse a vinheta <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html"><strong>aqui</strong></a>.</p></li>
<li><p>Explique o que o código abaixo faz:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="r-miscelanea-e-topicos-avancados.html#cb76-1"></a>   f &lt;-<span class="st"> </span>. <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">subtract</span>(., <span class="kw">mean</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">divide_by</span>(., <span class="kw">sd</span>(.))</span></code></pre></div></li>
<li><p>Use o que aprendeu ao resolver o exercício anterior para reescrever o código abaixo usando pipes:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="r-miscelanea-e-topicos-avancados.html#cb77-1"></a>  vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.7</span>, <span class="fl">2.74</span>, <span class="fl">5.66</span>, <span class="fl">8.13</span>, <span class="fl">4.04</span>)</span>
<span id="cb77-2"><a href="r-miscelanea-e-topicos-avancados.html#cb77-2"></a>  <span class="kw">sum</span>(x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">/</span><span class="kw">sd</span>(x)</span></code></pre></div></li>
</ol>
</div>
</div>
<div id="funcoes" class="section level2">
<h2><span class="header-section-number">5.2</span> Funções</h2>
<p>Como já sabemos, uma vez que você deve ter utilizado bastante o confeito de funções ao resolver os <a href="revisao-basica-da-linguagem-r.html#exercicios-propostos"><strong>exercícios sugeridos</strong></a>, funções são objetos que recebe uma ou algumas entradas, as processas em seu interior e te retorna uma ou mais saída(s). O diagrama <a href="r-miscelanea-e-topicos-avancados.html#fig:diagramafuncao">5.2</a> mostra um comportamento genérico de uma função qualquer (<strong>function</strong>) que recebe uma quantidade arbitrária de argumentos, com estruturas de dados distintas, e retorna também uma quantidade arbitrária de informações, objetos com estruturas de dados distintas:</p>
<div class="figure" style="text-align: center"><span id="fig:diagramafuncao"></span>
<div id="htmlwidget-192e9aee0e22115d0314" style="width:770px;height:350px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-192e9aee0e22115d0314">{"x":{"diagram":"\ngraph TD\n\nA(arg_1)\nB(arg_2)\nC(arg_3)\nD(...)\nE(arg_n)\nF(arg_n+1)\nG(...)\nH((function))\n\nA-->|vector|H\nB-->|matrix|H\nC-->|data frame|H\nD-->|...|H\nE-->|list|H\nF-->|factor|H\nG-->|new structure|H\n\nH-->|matrix|I(out_1)\nH-->|list|J(out_2)\nH-->|vector|K(out_3)\nH-->|...|L(...)\nH-->|factor|M(out_n)\nH-->|data frame|N(out_n+1)\nH-->|new structure|O(...)\n\nstyle A fill:#ffe5cc\nstyle B fill:#ffe5cc\nstyle C fill:#ffe5cc\nstyle D fill:#ffe5cc\nstyle E fill:#ffe5cc\nstyle F fill:#ffe5cc\nstyle G fill:#ffe5cc\nstyle H fill:#ff8900\nstyle I fill:#ffe5cc\nstyle J fill:#ffe5cc\nstyle K fill:#ffe5cc\nstyle L fill:#ffe5cc\nstyle M fill:#ffe5cc\nstyle N fill:#ffe5cc\nstyle O fill:#ffe5cc\n"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figura 5.2: Comportamento genérico da função de nome <strong>function</strong> que recebe diversos argumentos com estruturas de dados distintas e retorna diversos diversos objetos com estuturas de dados distintas. Note que <strong><em>new structure</em></strong>, no diagrama, deixa claro que o programador poderá criar suas novas estruturas de dados que poderão ser passadas e/ou retornadas por uma função.
</p>
</div>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<p>Algo que torma uma função bastante flexível é a capacidade de podermos passar funções como argumentos à outras funções. Muito embora esse fato não esteja destacado no diagrama acima, nunca se esqueça que, em R, você facilmente poderá passar uma função como argumento de uma outra função.</p>
<p><strong>Exemplo</strong>: <code>round(sum(c(1.73, 2.47, 7.21, 8.74, NA), na.rm = TRUE), digits = 1)</code></p>
</div>
</div>

<p>Uma função em R é dividida em três partes:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Lista de Argumentos</strong>: Conjunto de argumentos, podendo ter as mais variadas estruras de dados que pode inclusive alterar o comportamento da função.</p></li>
<li><p><strong>Corpo</strong>: Código no interior da função que será capas de processar e tomar decisões de acordo com sua lista de argumentos.</p></li>
<li><p><strong>Ambiente</strong>: Os ambientes (<strong><em>environment</em></strong>) de reconhecimentos de objetos no interior da função. Isso permite que possamos ter objetos com o mesmo nome referindo-se à conteúdos distintos na memória do computador.</p></li>
</ol>
<p>Como já sabemos, mas irei repetir, a forma geral de implementação de uma função é:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="r-miscelanea-e-topicos-avancados.html#cb78-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(argumentos){</span>
<span id="cb78-2"><a href="r-miscelanea-e-topicos-avancados.html#cb78-2"></a>   <span class="co"># Aqui é onde as coisas acontecem.</span></span>
<span id="cb78-3"><a href="r-miscelanea-e-topicos-avancados.html#cb78-3"></a>   corpo</span>
<span id="cb78-4"><a href="r-miscelanea-e-topicos-avancados.html#cb78-4"></a>} <span class="co"># Fim da função.</span></span></code></pre></div>
<p>Poderemos identificar essas três partes de uma função utilizando as funções <code>formals()</code>, <code>body()</code> e <code>environment()</code>. Por exemplo, considere a função abaixo:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="r-miscelanea-e-topicos-avancados.html#cb79-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</span>
<span id="cb79-2"><a href="r-miscelanea-e-topicos-avancados.html#cb79-2"></a>   <span class="st">`</span><span class="dt">+</span><span class="st">`</span>(x,y)</span>
<span id="cb79-3"><a href="r-miscelanea-e-topicos-avancados.html#cb79-3"></a>}</span>
<span id="cb79-4"><a href="r-miscelanea-e-topicos-avancados.html#cb79-4"></a></span>
<span id="cb79-5"><a href="r-miscelanea-e-topicos-avancados.html#cb79-5"></a><span class="co"># Lista de argumentos.</span></span>
<span id="cb79-6"><a href="r-miscelanea-e-topicos-avancados.html#cb79-6"></a><span class="kw">formals</span>(f)</span></code></pre></div>
<pre><code>## $x
## 
## 
## $y</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="r-miscelanea-e-topicos-avancados.html#cb81-1"></a><span class="co"># Corpo da função.</span></span>
<span id="cb81-2"><a href="r-miscelanea-e-topicos-avancados.html#cb81-2"></a><span class="kw">body</span>(f)</span></code></pre></div>
<pre><code>## {
##     x + y
## }</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="r-miscelanea-e-topicos-avancados.html#cb83-1"></a><span class="co"># Ambiente que a função foi definida.</span></span>
<span id="cb83-2"><a href="r-miscelanea-e-topicos-avancados.html#cb83-2"></a><span class="kw">environment</span>(f)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>Além disso, lembre-se que funções podem ter argumentos com valores já pré-definidos, como é o caso de <code>f()</code> no código que segue:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="r-miscelanea-e-topicos-avancados.html#cb85-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">2</span>){</span>
<span id="cb85-2"><a href="r-miscelanea-e-topicos-avancados.html#cb85-2"></a>   x <span class="op">+</span><span class="st"> </span>y</span>
<span id="cb85-3"><a href="r-miscelanea-e-topicos-avancados.html#cb85-3"></a>}</span>
<span id="cb85-4"><a href="r-miscelanea-e-topicos-avancados.html#cb85-4"></a><span class="kw">f</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="r-miscelanea-e-topicos-avancados.html#cb87-1"></a><span class="kw">f</span>(<span class="dv">2</span>,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div id="passando-atributos" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Passando atributos</h3>
<p>Uma função em R é um objeto qualquer. Dessa forma, assim como qualquer objeto, uma função poderá carregar consigo uma quantidade qualquer de atributos que podem ser recuperados e utilizados a qualquer momento. Considere os códigos que seguem:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="r-miscelanea-e-topicos-avancados.html#cb89-1"></a><span class="co"># Vetor com valores inteiros em memória de 1 à 10.</span></span>
<span id="cb89-2"><a href="r-miscelanea-e-topicos-avancados.html#cb89-2"></a>x &lt;-<span class="st"> </span>1L<span class="op">:</span>10L</span>
<span id="cb89-3"><a href="r-miscelanea-e-topicos-avancados.html#cb89-3"></a></span>
<span id="cb89-4"><a href="r-miscelanea-e-topicos-avancados.html#cb89-4"></a><span class="co"># Introduzindo dois argumentos ao objeto x.</span></span>
<span id="cb89-5"><a href="r-miscelanea-e-topicos-avancados.html#cb89-5"></a><span class="co"># Primeiro argumento: desc, que apresenta uma pequena descrição do objeto x.</span></span>
<span id="cb89-6"><a href="r-miscelanea-e-topicos-avancados.html#cb89-6"></a><span class="co"># Segundo argumento: M, uma matriz qualquer que poderia vir a ser útil guardar.</span></span>
<span id="cb89-7"><a href="r-miscelanea-e-topicos-avancados.html#cb89-7"></a><span class="kw">attr</span>(<span class="dt">x =</span> x, <span class="dt">which =</span> <span class="st">&quot;desc&quot;</span>) &lt;-<span class="st"> &quot;vetor com valores inteiros&quot;</span></span>
<span id="cb89-8"><a href="r-miscelanea-e-topicos-avancados.html#cb89-8"></a><span class="kw">attr</span>(<span class="dt">x =</span> x, <span class="dt">which =</span> <span class="st">&quot;M&quot;</span>) &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">8</span>), <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Note que agora o objeto <code>x</code> carrega não apenas os valores inteiros de 1 a 10. Foram acrescentados dois argumentos à <code>x</code>, são eles, <code>desc</code> que contém uma string descrevendo o que é o objeto <code>x</code>. Perceba que os atributos não afetam as operações que realizamos com <code>x</code>, mas poderemos, se desejarmos, acessar os atributos e trabalharmos com eles, como postra o trecho de código abaixo:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="r-miscelanea-e-topicos-avancados.html#cb90-1"></a><span class="co"># Os atributos não irão afetar as operações realizadas </span></span>
<span id="cb90-2"><a href="r-miscelanea-e-topicos-avancados.html#cb90-2"></a><span class="co"># considerando o objeto x.</span></span>
<span id="cb90-3"><a href="r-miscelanea-e-topicos-avancados.html#cb90-3"></a><span class="kw">sum</span>(x <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 65</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="r-miscelanea-e-topicos-avancados.html#cb92-1"></a><span class="co"># Listando os atributos do objeto x:</span></span>
<span id="cb92-2"><a href="r-miscelanea-e-topicos-avancados.html#cb92-2"></a><span class="kw">attributes</span>(x)</span></code></pre></div>
<pre><code>## $desc
## [1] &quot;vetor com valores inteiros&quot;
## 
## $M
##      [,1] [,2]
## [1,]    1    3
## [2,]    7    8</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="r-miscelanea-e-topicos-avancados.html#cb94-1"></a><span class="co"># Acessando o atributo de nome M (uma matriz) </span></span>
<span id="cb94-2"><a href="r-miscelanea-e-topicos-avancados.html#cb94-2"></a><span class="co"># e invertendo.</span></span>
<span id="cb94-3"><a href="r-miscelanea-e-topicos-avancados.html#cb94-3"></a><span class="kw">solve</span>(<span class="kw">attr</span>(x, <span class="st">&quot;M&quot;</span>))</span></code></pre></div>
<pre><code>##            [,1]        [,2]
## [1,] -0.6153846  0.23076923
## [2,]  0.5384615 -0.07692308</code></pre>
<p>Como é possível introduzir atributos à qualquer objeto em R, e funções são objetos, então considerre o trecho de código que segue, em que é introduzido o atributo <code>M</code> do objeto <code>x</code> como atributo da função <code>f()</code> abaixo:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="r-miscelanea-e-topicos-avancados.html#cb96-1"></a><span class="co"># Retorna os caracteres &quot;-&quot;, &quot;0&quot;, &quot;+&quot;</span></span>
<span id="cb96-2"><a href="r-miscelanea-e-topicos-avancados.html#cb96-2"></a><span class="co"># a depender do valor informado.</span></span>
<span id="cb96-3"><a href="r-miscelanea-e-topicos-avancados.html#cb96-3"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb96-4"><a href="r-miscelanea-e-topicos-avancados.html#cb96-4"></a>   <span class="co"># x é um objeto numérico.</span></span>
<span id="cb96-5"><a href="r-miscelanea-e-topicos-avancados.html#cb96-5"></a>   </span>
<span id="cb96-6"><a href="r-miscelanea-e-topicos-avancados.html#cb96-6"></a>   <span class="cf">if</span> (x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="st">&quot;0&quot;</span></span>
<span id="cb96-7"><a href="r-miscelanea-e-topicos-avancados.html#cb96-7"></a>   <span class="cf">else</span> <span class="kw">ifelse</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb96-8"><a href="r-miscelanea-e-topicos-avancados.html#cb96-8"></a>}</span>
<span id="cb96-9"><a href="r-miscelanea-e-topicos-avancados.html#cb96-9"></a></span>
<span id="cb96-10"><a href="r-miscelanea-e-topicos-avancados.html#cb96-10"></a><span class="co"># Introduzindo o atributo de nome desc que contém uma breve descrição da</span></span>
<span id="cb96-11"><a href="r-miscelanea-e-topicos-avancados.html#cb96-11"></a><span class="co"># função f():</span></span>
<span id="cb96-12"><a href="r-miscelanea-e-topicos-avancados.html#cb96-12"></a><span class="kw">attr</span>(f, <span class="st">&quot;desc&quot;</span>) &lt;-<span class="st"> &quot;retorna -, 0 ou +, a depender do valor passado à x&quot;</span></span>
<span id="cb96-13"><a href="r-miscelanea-e-topicos-avancados.html#cb96-13"></a></span>
<span id="cb96-14"><a href="r-miscelanea-e-topicos-avancados.html#cb96-14"></a><span class="co"># Acessando o conteúdo do atributo desc:</span></span>
<span id="cb96-15"><a href="r-miscelanea-e-topicos-avancados.html#cb96-15"></a><span class="kw">attr</span>(f, <span class="st">&quot;desc&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;retorna -, 0 ou +, a depender do valor passado à x&quot;</code></pre>
<p>Sabemos que o uso da função <code>body()</code> permete-nos acessar o corpo de uma função (código da função). Porém, você apenas irá visualizar as partes do código que foram implementadas estritamente em R. Por exemplo, no trecho de código abaixo é apresentado o sudo da função <code>body()</code> sobre uma função implementada em R e outra função que tem o seu código implementado em uma linguagem de mais baixo nível:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="r-miscelanea-e-topicos-avancados.html#cb98-1"></a>    <span class="co"># Acessando o corpo da fução rm():</span></span>
<span id="cb98-2"><a href="r-miscelanea-e-topicos-avancados.html#cb98-2"></a>    <span class="kw">body</span>(ls)</span>
<span id="cb98-3"><a href="r-miscelanea-e-topicos-avancados.html#cb98-3"></a>    </span>
<span id="cb98-4"><a href="r-miscelanea-e-topicos-avancados.html#cb98-4"></a>    <span class="co"># Tentando acessar o corpo da função sum():</span></span>
<span id="cb98-5"><a href="r-miscelanea-e-topicos-avancados.html#cb98-5"></a>    <span class="kw">body</span>(sum)</span></code></pre></div>
<p>Note que foi possível acessar parte do conteúdo, implementado em R, da função <code>rm()</code>. Porém, no caso da função <code>sum()</code> o retorno foi <code>NULL</code>, uma vez que essa função é por completo implementada em uma linguagem de mais baixo nível. Isso se deve ao fato de que essas funções foram escritas em linguagens compiladas como o caso de C/C++, camhando assim um código objeto e não um código fonte.</p>
<p>Em muitas situações desejamos passar uma função como argumento à outra função. O trecho de código abaixo cria duas simples funções, <code>f()</code> e <code>g()</code>, em que passamos <code>f()</code> como argumento à função <code>g()</code>:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="r-miscelanea-e-topicos-avancados.html#cb99-1"></a><span class="co"># As funções não necessariamente necessitam ter argumentos.</span></span>
<span id="cb99-2"><a href="r-miscelanea-e-topicos-avancados.html#cb99-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb99-3"><a href="r-miscelanea-e-topicos-avancados.html#cb99-3"></a>   <span class="st">&quot;Olá&quot;</span></span>
<span id="cb99-4"><a href="r-miscelanea-e-topicos-avancados.html#cb99-4"></a>}</span>
<span id="cb99-5"><a href="r-miscelanea-e-topicos-avancados.html#cb99-5"></a></span>
<span id="cb99-6"><a href="r-miscelanea-e-topicos-avancados.html#cb99-6"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(func){</span>
<span id="cb99-7"><a href="r-miscelanea-e-topicos-avancados.html#cb99-7"></a>   <span class="kw">paste</span>(func, <span class="st">&quot;mundo&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb99-8"><a href="r-miscelanea-e-topicos-avancados.html#cb99-8"></a>}</span>
<span id="cb99-9"><a href="r-miscelanea-e-topicos-avancados.html#cb99-9"></a></span>
<span id="cb99-10"><a href="r-miscelanea-e-topicos-avancados.html#cb99-10"></a><span class="co"># Passando a função f() como argumento da função g():</span></span>
<span id="cb99-11"><a href="r-miscelanea-e-topicos-avancados.html#cb99-11"></a><span class="kw">g</span>(<span class="dt">func =</span> <span class="kw">f</span>())</span></code></pre></div>
<pre><code>## [1] &quot;Olá mundo&quot;</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="r-miscelanea-e-topicos-avancados.html#cb101-1"></a><span class="co"># Compondo as funçoes nchar(), g() e f().</span></span>
<span id="cb101-2"><a href="r-miscelanea-e-topicos-avancados.html#cb101-2"></a><span class="co"># A função nchar() retorna a quantidade de caracteres </span></span>
<span id="cb101-3"><a href="r-miscelanea-e-topicos-avancados.html#cb101-3"></a><span class="co"># na estring retornada por g().</span></span>
<span id="cb101-4"><a href="r-miscelanea-e-topicos-avancados.html#cb101-4"></a><span class="kw">nchar</span>(<span class="kw">g</span>(<span class="dt">func =</span> <span class="kw">f</span>()))</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
</div>
<div id="funcoes-anonimas" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Funções anônimas</h3>
<p>Algo que é bastante útil quando estamos trabalhando com funções é a possibilidade de não nomear uma função. Essa estratégia é interessante quando temos funções curtas que não queremos nos dar o trabalho de pensarmos em um nome. Normalmente, aplica-se à casos de funções curtas que são passadas como argumento à outras funções. O trecho de código que segue apresenta o uso de uma função anônima passada como argumento à função <code>integrate()</code> de R:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="r-miscelanea-e-topicos-avancados.html#cb103-1"></a><span class="co"># Passando a função anônima function(x) x ^ 2 como argumento da </span></span>
<span id="cb103-2"><a href="r-miscelanea-e-topicos-avancados.html#cb103-2"></a><span class="co"># função integrate().</span></span>
<span id="cb103-3"><a href="r-miscelanea-e-topicos-avancados.html#cb103-3"></a><span class="kw">integrate</span>(<span class="cf">function</span>(x) x <span class="op">^</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">2</span>)<span class="op">$</span>value</span></code></pre></div>
<pre><code>## [1] 2.666667</code></pre>
<p>Não esqueça que, em muitos casos, compor funções utilizando o operador <code>%&gt;%</code> pode ser interessante. As composições acimas poderiam ser realizadas da forma que segue:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="r-miscelanea-e-topicos-avancados.html#cb105-1"></a><span class="co"># Primeira composição utilizando o operador %&gt;%: </span></span>
<span id="cb105-2"><a href="r-miscelanea-e-topicos-avancados.html#cb105-2"></a>f <span class="op">%&gt;%</span><span class="st"> </span>g <span class="op">%&gt;%</span><span class="st"> </span>nchar</span>
<span id="cb105-3"><a href="r-miscelanea-e-topicos-avancados.html#cb105-3"></a></span>
<span id="cb105-4"><a href="r-miscelanea-e-topicos-avancados.html#cb105-4"></a><span class="co"># Segunda composição utulizando os operadores pipes %&gt;%  e %$%:</span></span>
<span id="cb105-5"><a href="r-miscelanea-e-topicos-avancados.html#cb105-5"></a>(<span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">integrate</span>(<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">2</span>) <span class="op">%$%</span><span class="st"> </span>value</span></code></pre></div>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Utilizar os operadores pipes pode ser interessante quando estamos a fazer uma análise de dados, em que queremos deixar claro uma sequência lógica de operações. Porém, note que pipes não irão tornar o seu código mais eficientes do ponto de vista computacional, nem o contrário, ou seja, utilizar pipes não irão tornar os seus códigos menos eficientes.</p>
</div>
</div>

</div>
<div id="escopo-lexico" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Escopo léxico</h3>
<p>Em computação, o escopo é o que delimita a relação de objetos e expressões, ou seja, em que partes do código um ou mais objetos são reconhecidos por uma dada expressão ou conjunto de expressões. Na maioria das linguagens de programção o escopo é léxico, também chamado de escopo estático, uma vez que podem ser delimitados estaticamente, antes da execução do programa por meio da sintaxe da linguagem, ou seja, por meio da estrutura léxica da linguagem.</p>
<p>A linguagem R tem escopo léxico, assim como diversas outras linguagens de programação. Trata-se de tipo de escopo comum em linguagens como Pascal, C, C++, Ada, Go, Haskell, R, Julia, Python, Ruby, entre diversas outras. Considere o exemplo apresentado no código abaixo:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="r-miscelanea-e-topicos-avancados.html#cb106-1"></a>x &lt;-<span class="st"> &quot;fora&quot;</span></span>
<span id="cb106-2"><a href="r-miscelanea-e-topicos-avancados.html#cb106-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb106-3"><a href="r-miscelanea-e-topicos-avancados.html#cb106-3"></a>   x &lt;-<span class="st"> &quot;dentro&quot;</span></span>
<span id="cb106-4"><a href="r-miscelanea-e-topicos-avancados.html#cb106-4"></a>   x</span>
<span id="cb106-5"><a href="r-miscelanea-e-topicos-avancados.html#cb106-5"></a>}; <span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] &quot;dentro&quot;</code></pre>
<p>Para quem já programa um pouco em R, o retorno da função <code>f()</code> era esperado, uma vez que olhando para o código, entendemos facilmente qual a saída, uma vez que a sintaxe nos acusa (escopo léxico). Na verdade, o termo vem de <strong><em>lexing</em></strong>, que refere-se ao processo de conversão de partes significativas do código intendíveis para o interpretador.</p>
<p>Existem linguagens que fazem uso de <a href="https://pt.wikipedia.org/wiki/Escopo_(computa%C3%A7%C3%A3o)#Escopo_din%C3%A2mico"><strong>escopo dinâmico</strong></a>, como é o caso do Emacs Lisp, shell Bash, LaTeX (linguagem de marcação), entre outras. Como esse não é o caso da linguagem R que frequentemente nos deparamos em R, aqui não é o lugar para dissertar em relação à esse assunto.</p>
<p>No código acima, perceba que havia um objeto <code>x</code> definido no interior da função. Dessa forma, o retorno da função buscará por referências à <code>x</code> no mesmo escopo da função, isto é, irá considerar <code>x</code> definido por <code>x &lt;- "dentro"</code>. Porém, considere a simples modificação do código na forma que segue:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="r-miscelanea-e-topicos-avancados.html#cb108-1"></a>x &lt;-<span class="st"> &quot;fora&quot;</span></span>
<span id="cb108-2"><a href="r-miscelanea-e-topicos-avancados.html#cb108-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb108-3"><a href="r-miscelanea-e-topicos-avancados.html#cb108-3"></a>   x</span>
<span id="cb108-4"><a href="r-miscelanea-e-topicos-avancados.html#cb108-4"></a>}; <span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] &quot;fora&quot;</code></pre>
<p>No código acima, a função <code>f()</code> não pode encontrar referências ao objeto <code>x</code> no interior da função. Dessa forma, R considerar-a o objeto <code>x</code> no respectivo escopo mais externo, que nesse caso é o objeto <code>x</code> definido por <code>x &lt;- "fora"</code>. Esse comportamento é válido se consideramos estruturas mais aninhadas, como a que é apresentada no código que segue:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="r-miscelanea-e-topicos-avancados.html#cb110-1"></a>x &lt;-<span class="st"> &quot;estou fora de f&quot;</span></span>
<span id="cb110-2"><a href="r-miscelanea-e-topicos-avancados.html#cb110-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb110-3"><a href="r-miscelanea-e-topicos-avancados.html#cb110-3"></a></span>
<span id="cb110-4"><a href="r-miscelanea-e-topicos-avancados.html#cb110-4"></a>   <span class="co"># Podemos definir funções dentro de funções.</span></span>
<span id="cb110-5"><a href="r-miscelanea-e-topicos-avancados.html#cb110-5"></a>   g &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb110-6"><a href="r-miscelanea-e-topicos-avancados.html#cb110-6"></a>      x</span>
<span id="cb110-7"><a href="r-miscelanea-e-topicos-avancados.html#cb110-7"></a>   } <span class="co"># fim da função interna</span></span>
<span id="cb110-8"><a href="r-miscelanea-e-topicos-avancados.html#cb110-8"></a>   <span class="kw">list</span>(<span class="dt">g =</span> <span class="kw">g</span>(), <span class="dt">x =</span> x)</span>
<span id="cb110-9"><a href="r-miscelanea-e-topicos-avancados.html#cb110-9"></a>} <span class="co"># fim da função externa</span></span>
<span id="cb110-10"><a href="r-miscelanea-e-topicos-avancados.html#cb110-10"></a></span>
<span id="cb110-11"><a href="r-miscelanea-e-topicos-avancados.html#cb110-11"></a><span class="kw">f</span>()</span></code></pre></div>
<pre><code>## $g
## [1] &quot;estou fora de f&quot;
## 
## $x
## [1] &quot;estou fora de f&quot;</code></pre>
<p>Perceba que tanto o retorno da função <code>g()</code> quando o objeto <code>x</code> da função <code>f()</code> referem-se ao valor de <code>x</code> definido fora do escopo da função <code>f()</code>. Isso se deve ao fato da linguagem R procurar um objeto de nome <code>x</code> de froma sucessivas, partindo do escopo ao qual o objeto é invocado à escopos em níveis mais externos. No código acima, tanto <code>g()</code> definida dentro de <code>f()</code> quanto a prórpia função <code>f()</code> apenas encontrará referência à <code>x</code> no ambiente mais externo, isto é, será considerado o objeto <code>x</code> definido por <code>x &lt;- "estou fora de f"</code>.</p>
<p>Algo interessante de se observar é que muito embora o R procure em escopos mais externos a primeira referência ao objeto que invocamos em um escopo mais interno, escopo este em que não há nenhuma referência à este objeto, em futuras invocações da função, a partir da segunda chamada, o objeto <code>x</code> já encontra-se definido no interior da função <code>f()</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="r-miscelanea-e-topicos-avancados.html#cb112-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb112-2"><a href="r-miscelanea-e-topicos-avancados.html#cb112-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb112-3"><a href="r-miscelanea-e-topicos-avancados.html#cb112-3"></a>   <span class="co"># x encontra-se definido no escopo externo na primeira chamada à</span></span>
<span id="cb112-4"><a href="r-miscelanea-e-topicos-avancados.html#cb112-4"></a>   <span class="co"># função f.</span></span>
<span id="cb112-5"><a href="r-miscelanea-e-topicos-avancados.html#cb112-5"></a>   x &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb112-6"><a href="r-miscelanea-e-topicos-avancados.html#cb112-6"></a>   x</span>
<span id="cb112-7"><a href="r-miscelanea-e-topicos-avancados.html#cb112-7"></a>}</span>
<span id="cb112-8"><a href="r-miscelanea-e-topicos-avancados.html#cb112-8"></a><span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="r-miscelanea-e-topicos-avancados.html#cb114-1"></a><span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Observe que mesmo que você chame por diversas vezes consecutivas a função <code>f()</code> o retorno sempre será <code>1</code>. Para ser possível obter somas em 1 iterativas, uma solução para esse problema seria fazer uso do operador de atribuição profunda, denotado por <code>&lt;&lt;-</code>. Esse operador permite que as alterações no objeto <code>x</code> ocorra no primeiro escopo mais abrangente que faz referência à um objeto <code>x</code>. Considere o trecho de código que segue:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="r-miscelanea-e-topicos-avancados.html#cb116-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb116-2"><a href="r-miscelanea-e-topicos-avancados.html#cb116-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb116-3"><a href="r-miscelanea-e-topicos-avancados.html#cb116-3"></a>   <span class="co"># x encontra-se definido no escopo externo na primeira chamada à</span></span>
<span id="cb116-4"><a href="r-miscelanea-e-topicos-avancados.html#cb116-4"></a>   <span class="co"># função f.</span></span>
<span id="cb116-5"><a href="r-miscelanea-e-topicos-avancados.html#cb116-5"></a>   x &lt;&lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="co"># Operador de atribuição profunda.</span></span>
<span id="cb116-6"><a href="r-miscelanea-e-topicos-avancados.html#cb116-6"></a>   x</span>
<span id="cb116-7"><a href="r-miscelanea-e-topicos-avancados.html#cb116-7"></a>}</span>
<span id="cb116-8"><a href="r-miscelanea-e-topicos-avancados.html#cb116-8"></a><span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="r-miscelanea-e-topicos-avancados.html#cb118-1"></a><span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Porém, perceba o resultado que segue:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="r-miscelanea-e-topicos-avancados.html#cb120-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb120-2"><a href="r-miscelanea-e-topicos-avancados.html#cb120-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb120-3"><a href="r-miscelanea-e-topicos-avancados.html#cb120-3"></a>   x =<span class="st"> </span><span class="dv">7</span></span>
<span id="cb120-4"><a href="r-miscelanea-e-topicos-avancados.html#cb120-4"></a>   x &lt;&lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="co"># Operador de atribuição profunda.</span></span>
<span id="cb120-5"><a href="r-miscelanea-e-topicos-avancados.html#cb120-5"></a>   x</span>
<span id="cb120-6"><a href="r-miscelanea-e-topicos-avancados.html#cb120-6"></a>}</span>
<span id="cb120-7"><a href="r-miscelanea-e-topicos-avancados.html#cb120-7"></a><span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="r-miscelanea-e-topicos-avancados.html#cb122-1"></a>x</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>Note no código acima que o valor retornado pela função é <code>7</code> (sempre) e não <code>8</code>, como alguns poderiam esperar. Perceba que isso se deve ao fato de que no interior de <code>f()</code>, sempre teremos que <code>x</code> ao lado direito do operador <code>&lt;&lt;-</code> será <code>7</code>, uma vez que em todas as chamadas, há dentro da função <code>f()</code> a definição de <code>x = 7</code>. Isso também implicará que o valor de <code>x</code> do lado esquerdo do operador <code>&lt;&lt;-</code> sempre será atualizado para <code>8</code>, em todas as chamadas. Veja que <code>x</code> ao lado esquerdo de <code>&lt;&lt;-</code> refere-se ao objeto <code>x</code> no escopo mais extero ao escopo de <code>x</code> no interior da função.</p>
<p><strong>Observação</strong>:</p>

<div class="rmdobservation">
<div class="text-justify">
<p>Em R, os operadores <code>&lt;-</code> e <code>&lt;&lt;-</code> também informam o sentido da atribuição, que normalmente é da direita para a esquerda, assim como ocorre ao considerar o operador <code>=</code>. Quase sempre as atribuições são da esquerda para a direita, com exceção das situações em que invertemos os sentidos dos operadores <code>&lt;-</code> e <code>&lt;&lt;-</code>, isto é, quando consideramos as variantes <code>-&gt;</code> e <code>-&gt;&gt;</code>, respectivamente.</p>
</div>
</div>

<p><strong>Exemplo</strong>:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="r-miscelanea-e-topicos-avancados.html#cb124-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb124-2"><a href="r-miscelanea-e-topicos-avancados.html#cb124-2"></a>   <span class="dv">2</span> -&gt;<span class="st"> </span>x</span>
<span id="cb124-3"><a href="r-miscelanea-e-topicos-avancados.html#cb124-3"></a>   x <span class="op">*</span><span class="st"> </span><span class="dv">2</span> -&gt;&gt;<span class="st"> </span>x</span>
<span id="cb124-4"><a href="r-miscelanea-e-topicos-avancados.html#cb124-4"></a>   x</span>
<span id="cb124-5"><a href="r-miscelanea-e-topicos-avancados.html#cb124-5"></a>}</span>
<span id="cb124-6"><a href="r-miscelanea-e-topicos-avancados.html#cb124-6"></a></span>
<span id="cb124-7"><a href="r-miscelanea-e-topicos-avancados.html#cb124-7"></a><span class="kw">f</span>(); x</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<pre><code>## [1] 4</code></pre>
</div>
<div id="avaliacao-preguicosa" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Avaliação preguiçosa</h3>
<p>Tecnicamente, os argumentos de uma função são promessas <a href="https://cran.r-project.org/doc/manuals/R-lang.html#Promise-objects"><strong><em>promises</em></strong></a> e fazem parte do mecanismo de (<strong><em>lazy evaluation</em></strong>). Quando uma função é chamada, cada um de seus argumentos formais são vinculados à uma promessa. Dessa forma, cada promessa, para cada um dos argumentos, armazenam a expressão do argumento e um ponteiro para o ambiente ao qual a função foi chamada. Tais promessas não armazenam nenhum valor, até o momento em que o argumento seja necessário para a função. Sendo assim, (<strong><em>promises</em></strong>) trata-se de uma estrutura de dados. <strong><em>Promisses</em></strong> possuem:</p>
<ul>
<li>Um <strong>ambiente</strong>: ambiente em que uma função é avaliada/invocada.</li>
<li>Uma <strong>expressão</strong>: uma expressão válida passada para um argumento de uma função;</li>
<li>Um <strong>valor</strong>: resultado da avaliação de uma expressão em um ambiente específico.</li>
</ul>
<p>Em R, os argumentos de uma função são avaliados de forma preguiçosa (<strong><em>lazy evaluation</em></strong>), são apenas promessas, ou seja, só serão avaliados na necessidade de uso do parâmetro. Em outras palavras, um parâmetro poderá eventualmente nunca ser avaliado quando uma função é executada. Considere o código que segue:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="r-miscelanea-e-topicos-avancados.html#cb127-1"></a><span class="co"># A função f() tem o argumento x que</span></span>
<span id="cb127-2"><a href="r-miscelanea-e-topicos-avancados.html#cb127-2"></a><span class="co"># não é utilizado.</span></span>
<span id="cb127-3"><a href="r-miscelanea-e-topicos-avancados.html#cb127-3"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb127-4"><a href="r-miscelanea-e-topicos-avancados.html#cb127-4"></a>   y &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb127-5"><a href="r-miscelanea-e-topicos-avancados.html#cb127-5"></a>   y</span>
<span id="cb127-6"><a href="r-miscelanea-e-topicos-avancados.html#cb127-6"></a>}</span>
<span id="cb127-7"><a href="r-miscelanea-e-topicos-avancados.html#cb127-7"></a><span class="kw">f</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Como é possível observar, a função <code>f()</code> possui <code>x</code> como argumento, argumento este que em nenhum momento é utilizado. Dessa forma, mesmo que <code>x</code> não esteja definido, não teremos como retorno um erro ao executar <code>f()</code>. Isso se deve ao fato de que argumentos de funções, em R, são avaliados de forma preguiçosa.</p>
<p>Um dos grandes benefícios da avaliação preguiçosa é a possibilidade que temos de atrasar a computação, de modo que um dos argumentos poderá conter cálculos intensivos que só será avaliado se necessário. Dessa forma, devido a possibilidade de uma função matemática poder ser passado como argumento à uma funçãom, que ventualmente pode ser algo custoso do ponto de vista computacional, <a href="https://en.wikipedia.org/wiki/Lazy_evaluation"><strong><em>lazy evaluation</em></strong></a> é o padrão da linguagem.</p>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<p>Como estamos a falar de argumeto de funções, destaco algo importante da linguagem R. Ao se utilizar o operador <code>&lt;-</code> para realizar uma atribuição em uma chamada de função, a variável é ligada fora da função, ou seja, no ambiente em que a função é chamada, como mostra o exemplo que segue:</p>
<p><strong>Exemplo</strong>:</p>
</div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="r-miscelanea-e-topicos-avancados.html#cb129-1"></a>y &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb129-2"><a href="r-miscelanea-e-topicos-avancados.html#cb129-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb129-3"><a href="r-miscelanea-e-topicos-avancados.html#cb129-3"></a>   y &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb129-4"><a href="r-miscelanea-e-topicos-avancados.html#cb129-4"></a>   x <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb129-5"><a href="r-miscelanea-e-topicos-avancados.html#cb129-5"></a>}</span>
<span id="cb129-6"><a href="r-miscelanea-e-topicos-avancados.html#cb129-6"></a><span class="kw">f</span>(y &lt;-<span class="st"> </span><span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="r-miscelanea-e-topicos-avancados.html#cb131-1"></a>y</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>Perceba que fazer <code>f(y = 7)</code> retornará um erro, uma vez que R entende que estamos passando o valor <code>7</code> à um argumento <code>y</code> que não existe em <code>f()</code>. Note que <code>f(y &lt;- 7)</code> é equivalente a escrever <code>f(x = y &lt;- 7)</code> ou <code>f(x = (y = 7))</code>. Porém, ao utilizarmos o operador <code>&lt;-</code>, além de passarmos os argumentos à <code>f()</code> estamos também criando os objetos à esquerda do operador fora da função.</p>
</div>
</div>
<div id="varargs-dot-dot-dot" class="section level3">
<h3><span class="header-section-number">5.2.5</span> varargs: … (dot-dot-dot)</h3>
<p>Algo bastante útil e que torna flexível uma linguagem de programação é a possibilidade de escrever funções com quantidade variádicas de argumentos, isto é, funções <a href="https://en.wikipedia.org/wiki/Variadic_function"><strong>varargs</strong></a>. Em R isso é possível especificando o argumento especial <code>...</code> (<strong><em>dot-dot-dot</em></strong>), ou <strong>ponto-ponto-ponto</strong>, em português.</p>
<p>Um uso comum do operador <code>...</code> é a possibilidade de passarmos argumentos adicionais para uma função que utilizamos em nossa implementação. Por exmeplo, considere o código abaixo:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="r-miscelanea-e-topicos-avancados.html#cb133-1"></a><span class="co"># Fixando uma semente para gerarmos sempre a mesma amostra.</span></span>
<span id="cb133-2"><a href="r-miscelanea-e-topicos-avancados.html#cb133-2"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb133-3"><a href="r-miscelanea-e-topicos-avancados.html#cb133-3"></a></span>
<span id="cb133-4"><a href="r-miscelanea-e-topicos-avancados.html#cb133-4"></a><span class="co"># Gerando um conjunto de dados com distribuição normal padrão.</span></span>
<span id="cb133-5"><a href="r-miscelanea-e-topicos-avancados.html#cb133-5"></a>data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb133-6"><a href="r-miscelanea-e-topicos-avancados.html#cb133-6"></a>myhist &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x =</span> data, ...){</span>
<span id="cb133-7"><a href="r-miscelanea-e-topicos-avancados.html#cb133-7"></a>  <span class="co"># Perceba o uso de ... em hist():</span></span>
<span id="cb133-8"><a href="r-miscelanea-e-topicos-avancados.html#cb133-8"></a>  result &lt;-<span class="st"> </span><span class="kw">hist</span>(x, ...)</span>
<span id="cb133-9"><a href="r-miscelanea-e-topicos-avancados.html#cb133-9"></a>  <span class="kw">list</span>(<span class="dt">n =</span> <span class="kw">length</span>(result<span class="op">$</span>counts), <span class="dt">counts =</span> result<span class="op">$</span>counts)</span>
<span id="cb133-10"><a href="r-miscelanea-e-topicos-avancados.html#cb133-10"></a>}</span>
<span id="cb133-11"><a href="r-miscelanea-e-topicos-avancados.html#cb133-11"></a></span>
<span id="cb133-12"><a href="r-miscelanea-e-topicos-avancados.html#cb133-12"></a><span class="co"># A função myhist() não possuia a definição dos argumentos col,</span></span>
<span id="cb133-13"><a href="r-miscelanea-e-topicos-avancados.html#cb133-13"></a><span class="co"># main, ylab e border.</span></span>
<span id="cb133-14"><a href="r-miscelanea-e-topicos-avancados.html#cb133-14"></a><span class="kw">myhist</span>(<span class="dt">x =</span> data, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb133-15"><a href="r-miscelanea-e-topicos-avancados.html#cb133-15"></a>       <span class="dt">ylab =</span> <span class="st">&quot;Frequência&quot;, border = NA)</span></span></code></pre></div>
<p><img src="r_files/figure-html/unnamed-chunk-47-1.png" width="384" style="display: block; margin: auto;" /></p>
<pre><code>## $n
## [1] 10
## 
## $counts
##  [1]  1  2  8 15 26 19 14 12  1  2</code></pre>
<p>A função <code>myhist()</code>, implementada acima, constroi um histograma com base em um vetor de dados passado como argumento à <code>x</code>, retornando uma lista com o número de classes e a quantidade de observações da amostra, em cada uma das classes. Note que <code>myhist()</code> possui apenas dois argumentos, <code>x</code> e <code>...</code>, respectivamente. O argumento especial <code>...</code> permite que <code>myhist()</code> herde todos argumentos da função <code>hist()</code>. Asim, muito embora a função <code>myhist()</code> não possui os argumentos <code>col</code>, <code>main</code>, <code>ylab</code>e <code>border</code> definidos formalmente, poderemos ascessar esses e os demais argumentos de <code>hist()</code> mesmo sem defini-los.</p>
<p>Nas situações em que desejarmos acessar os elementos passados à <code>...</code> por suas posições, poderemos fazer uso da notação especial <code>..1</code>, <code>..2</code>, etc. Considere o trecho de código que segue:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="r-miscelanea-e-topicos-avancados.html#cb135-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(...){</span>
<span id="cb135-2"><a href="r-miscelanea-e-topicos-avancados.html#cb135-2"></a></span>
<span id="cb135-3"><a href="r-miscelanea-e-topicos-avancados.html#cb135-3"></a>   n &lt;-<span class="st"> </span><span class="kw">...length</span>()</span>
<span id="cb135-4"><a href="r-miscelanea-e-topicos-avancados.html#cb135-4"></a>   <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb135-5"><a href="r-miscelanea-e-topicos-avancados.html#cb135-5"></a>      <span class="kw">stop</span>(<span class="st">&quot;A função deve ter exatamente 3 argumentos.&quot;</span>)</span>
<span id="cb135-6"><a href="r-miscelanea-e-topicos-avancados.html#cb135-6"></a>   <span class="cf">else</span></span>
<span id="cb135-7"><a href="r-miscelanea-e-topicos-avancados.html#cb135-7"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">...length</span>()){</span>
<span id="cb135-8"><a href="r-miscelanea-e-topicos-avancados.html#cb135-8"></a>         <span class="kw">cat</span>(<span class="st">&quot;O elemento &quot;</span>, i, <span class="st">&quot; de </span><span class="ch">\&quot;</span><span class="st">...</span><span class="ch">\&quot;</span><span class="st"> é: &quot;</span>, <span class="kw">...elt</span>(i), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb135-9"><a href="r-miscelanea-e-topicos-avancados.html#cb135-9"></a>      }</span>
<span id="cb135-10"><a href="r-miscelanea-e-topicos-avancados.html#cb135-10"></a></span>
<span id="cb135-11"><a href="r-miscelanea-e-topicos-avancados.html#cb135-11"></a>   <span class="kw">return</span>(..<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>..<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>..<span class="dv">3</span>)</span>
<span id="cb135-12"><a href="r-miscelanea-e-topicos-avancados.html#cb135-12"></a>}</span>
<span id="cb135-13"><a href="r-miscelanea-e-topicos-avancados.html#cb135-13"></a><span class="kw">f</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## O elemento  1  de &quot;...&quot; é:  2 
## O elemento  2  de &quot;...&quot; é:  3 
## O elemento  3  de &quot;...&quot; é:  1</code></pre>
<pre><code>## [1] 7</code></pre>
<p>Note que a função <code>f()</code> retorna o produto do primeiro com o segundo argumento e soma com o terceiro. Além disso, foram utilizadas as funções <code>...length()</code> que retorna o tamanho de <code>...</code> e <code>...elt(i)</code> que equivale à <code>..i</code>. A função <code>...elt(i)</code> nada mais é do que fazer <code>eval(paste0("..", n))</code>.</p>
<p>Como dito, uma das grandes vantagens do uso de <code>...</code> é a possibilidade de passarmos argumento de outras funções que estão sendo utilizadas pela função que estamos a implementar. O uso de funções <strong>varargs</strong> destacam-se também em situações em que fazemos uso de programação orientada à objeto por função genérica, sistema de orientação à objeto conhecido, em R, como sistema S3 de orientação à objeto e que estudaremos mais a frente. Considerando o sistema S3 de orientação à objeto, note que funções como <code>summary()</code> e <code>print()</code> podem ser utilizadas em diversas situações e que muito provavelmente terão argumentos distintos em cada uma dessas circunstâncias. A capacidade de uma função ter várias formas e se adequar a cada uma delas está fortemente relacionada com a definição de funções <a href="https://en.wikipedia.org/wiki/Polymorphism_(computer_science)"><strong>polimórficas</strong></a>, uma das principais características do paradigma de programação orientada à objeto e que está intimamente relacionadas com funções <strong>varargs</strong>, principalmente no sistema S3.</p>
<p>Perceba que diversas funções R são <strong>varargs</strong>, por exemplos, a função <code>sum()</code>. Note, no trecho de código abaixo, que a característica de <strong><em>lazy evaluation</em></strong> quando associada à uma função com um número arbitrário de argumentos poderá retornar algo equivocado e nenhum erro é dado para nos alertarmos de um possível problema:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="r-miscelanea-e-topicos-avancados.html#cb138-1"></a>   <span class="kw">sum</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="ot">NA</span>, <span class="dt">narm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Para o código acima, gostaríamos que o equívoco a respeito do nome correto do argumento (<code>na.rm</code>) não tivesse ocorrido. Aqui, nosso interesse seria fazer:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="r-miscelanea-e-topicos-avancados.html#cb140-1"></a>   <span class="kw">sum</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="ot">NA</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Um outro inconveniente de construir funções <strong>varargs</strong> além dos equívocos desarpesebidos quando erramos algum de seus arugmentos é que essas funções normalmente são um pouco mais complicadas de serem documentadas, visto que devemos ter um grande cuidado ao deixar claro como os argumentos serão substituídos e utilizados.</p>
<p>Esses problemas não são suficientes justificar um desaconselho do uso de funções <strong>varargs</strong>. Na verdade é muito importante a construção de funções <strong>varargs</strong> e você deve utilizar, sempre que puder e na medida da necessidade, uma vez que isto tornará suas funções bastante flexíveis.</p>
</div>
</div>

</div>
<div id="funcoes-infixas" class="section level3">
<h3><span class="header-section-number">5.2.6</span> Funções infixas</h3>
<p>Para começarmos a falar de funções infixas (<strong><em>infix</em></strong>), os slogans abaixo, traduzidos para o português, poderão ser úteis para um melhor entendimento:</p>
<blockquote>
<p>"Para entender a computação em R, dois slogans são úteis:</p>
</blockquote>
<blockquote>
<ul>
<li>Tudo o que existe é um objeto.</li>
<li>Tudo o que acontece é uma chamada de função."</li>
</ul>
</blockquote>
<blockquote>
<p>— <a href="https://en.wikipedia.org/wiki/John_Chambers_(statistician)"><strong>John M. Chambers</strong></a>, no artigo intitulado <a href="https://projecteuclid.org/download/pdfview_1/euclid.ss/1408368569"><strong><em>Object-Oriented Programming, Functional Programming and R</em></strong></a>, <em>Statistical Science</em>, Vol. 29, 2014, p. 170.</p>
</blockquote>
<p>Nas situações de funções que possuem dois argumentos, construir um operador infixo pode ser de grande utilidade. O exemplo abaixo mostra duas formas de somarmos dois termos utilizando a função `+` e o operador infixo <code>+</code>, respectivamente. Perceba que a segunda forma é mais conveniente que a primeira:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="r-miscelanea-e-topicos-avancados.html#cb142-1"></a>x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb142-2"><a href="r-miscelanea-e-topicos-avancados.html#cb142-2"></a></span>
<span id="cb142-3"><a href="r-miscelanea-e-topicos-avancados.html#cb142-3"></a><span class="co"># Forma 1 (prefix):</span></span>
<span id="cb142-4"><a href="r-miscelanea-e-topicos-avancados.html#cb142-4"></a><span class="st">`</span><span class="dt">+</span><span class="st">`</span>(x, y)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="r-miscelanea-e-topicos-avancados.html#cb144-1"></a><span class="co"># Forma 2 (infix):</span></span>
<span id="cb144-2"><a href="r-miscelanea-e-topicos-avancados.html#cb144-2"></a>x <span class="op">+</span><span class="st"> </span>y</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Além dos operadores matemáticos <code>+</code>, <code>-</code>, <code>*</code> e <code>/</code> serem funções infixas, podendo também chamar de operadores infixos ou <strong><em>infix</em></strong>, diversas outras funções são infixas, como por exemplo, <code>^</code>, <code>::</code>, <code>&amp;</code>, <code>|</code>, <code>&amp;&amp;</code>, <code>||</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>==</code>, <code>!=</code>, <code>$</code>, <code>%%</code>, <code>%*%</code>, <code>%in%</code>, <code>&lt;-</code>, <code>&lt;&lt;-</code>, entre diversas outras funções. O exemplo abaixo apreseta o uso de algumas dessas funções na forma prefixa:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="r-miscelanea-e-topicos-avancados.html#cb146-1"></a><span class="st">`</span><span class="dt">&lt;=</span><span class="st">`</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="r-miscelanea-e-topicos-avancados.html#cb148-1"></a><span class="st">`</span><span class="dt">^</span><span class="st">`</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="r-miscelanea-e-topicos-avancados.html#cb150-1"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>)</span>
<span id="cb150-2"><a href="r-miscelanea-e-topicos-avancados.html#cb150-2"></a><span class="st">`</span><span class="dt">$</span><span class="st">`</span>(x, a)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Assim como existem diversas funções infixas em R previamente implementadas, também poderemos construir nossas funções infixas. Para tanto, basta considerarmos a notação <code>%nome%</code>, em que <code>nome</code> deverá ser substituído por um nome válido de função. Considere o código abaixo:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="r-miscelanea-e-topicos-avancados.html#cb152-1"></a><span class="st">`</span><span class="dt">%+%</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, n){</span>
<span id="cb152-2"><a href="r-miscelanea-e-topicos-avancados.html#cb152-2"></a>   <span class="kw">rep</span>(x, <span class="dt">times =</span> n)</span>
<span id="cb152-3"><a href="r-miscelanea-e-topicos-avancados.html#cb152-3"></a>}</span>
<span id="cb152-4"><a href="r-miscelanea-e-topicos-avancados.html#cb152-4"></a></span>
<span id="cb152-5"><a href="r-miscelanea-e-topicos-avancados.html#cb152-5"></a><span class="co"># Forma prefixa:</span></span>
<span id="cb152-6"><a href="r-miscelanea-e-topicos-avancados.html#cb152-6"></a><span class="st">`</span><span class="dt">%+%</span><span class="st">`</span>(<span class="st">&quot;infix&quot;</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] &quot;infix&quot; &quot;infix&quot; &quot;infix&quot; &quot;infix&quot;</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="r-miscelanea-e-topicos-avancados.html#cb154-1"></a><span class="co"># Forma infixa:</span></span>
<span id="cb154-2"><a href="r-miscelanea-e-topicos-avancados.html#cb154-2"></a><span class="st">&quot;infix&quot;</span> <span class="op">%+%</span><span class="st"> </span><span class="dv">4</span></span></code></pre></div>
<pre><code>## [1] &quot;infix&quot; &quot;infix&quot; &quot;infix&quot; &quot;infix&quot;</code></pre>
</div>
<div id="funcao-de-substituicao" class="section level3">
<h3><span class="header-section-number">5.2.7</span> Função de substituição</h3>
<p>Você muito provavelmente já deve ter feito uso de funções de substituição, como por exemplo, <code>names()</code>, <code>colnames()</code>, <code>rownames()</code>, entre outras funções. Essas são chamadas de funções de substituição devido ao comportamento que é expresso no código que segue:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="r-miscelanea-e-topicos-avancados.html#cb156-1"></a>vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb156-2"><a href="r-miscelanea-e-topicos-avancados.html#cb156-2"></a><span class="kw">names</span>(vetor) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb156-3"><a href="r-miscelanea-e-topicos-avancados.html#cb156-3"></a>x</span></code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## [1] 2</code></pre>
<p>A função <code>names()</code>, para produzir o mesmo resultado do código acima, poderia ser invocada na foma que segue:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="r-miscelanea-e-topicos-avancados.html#cb158-1"></a>vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb158-2"><a href="r-miscelanea-e-topicos-avancados.html#cb158-2"></a><span class="st">`</span><span class="dt">names&lt;-</span><span class="st">`</span>(<span class="dt">x =</span> vetor, <span class="dt">value =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<pre><code>## a b c 
## 1 2 3</code></pre>
<p>Pelo código acima podemos perceber que as funções de substituição nada mais são que funções de dois argumentos, a saber <code>x</code> e <code>value</code>, respectivamente. Dessa forma, os valores passados à <code>value</code> modificam o objeto <code>x</code> que nesse caso são os nomes do objeto <code>vetor</code>.</p>
<p><strong>Exemplo</strong>: Implementação da função de substituição <code>samenames()</code> que atribui o mesmo nome à todos elementos do vetor <code>x</code>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="r-miscelanea-e-topicos-avancados.html#cb160-1"></a><span class="st">`</span><span class="dt">samenames&lt;-</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, value){</span>
<span id="cb160-2"><a href="r-miscelanea-e-topicos-avancados.html#cb160-2"></a>   <span class="cf">if</span> (<span class="kw">length</span>(value) <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;Um vetor de comprimento 1 deverá ser atribuído.&quot;</span>)</span>
<span id="cb160-3"><a href="r-miscelanea-e-topicos-avancados.html#cb160-3"></a>   <span class="cf">else</span>{</span>
<span id="cb160-4"><a href="r-miscelanea-e-topicos-avancados.html#cb160-4"></a>      <span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="kw">rep</span>(value, <span class="dt">times =</span> <span class="kw">length</span>(x))</span>
<span id="cb160-5"><a href="r-miscelanea-e-topicos-avancados.html#cb160-5"></a>   }</span>
<span id="cb160-6"><a href="r-miscelanea-e-topicos-avancados.html#cb160-6"></a>   x</span>
<span id="cb160-7"><a href="r-miscelanea-e-topicos-avancados.html#cb160-7"></a>}</span>
<span id="cb160-8"><a href="r-miscelanea-e-topicos-avancados.html#cb160-8"></a>x &lt;-<span class="st"> </span>1L<span class="op">:</span>10L</span>
<span id="cb160-9"><a href="r-miscelanea-e-topicos-avancados.html#cb160-9"></a><span class="kw">samenames</span>(x) &lt;-<span class="st"> &quot;a&quot;</span></span>
<span id="cb160-10"><a href="r-miscelanea-e-topicos-avancados.html#cb160-10"></a>x</span></code></pre></div>
<pre><code>##  a  a  a  a  a  a  a  a  a  a 
##  1  2  3  4  5  6  7  8  9 10</code></pre>
<p>Em situações em que a função de substituição necessita de mais argumentos além dos argumentos obrigatórios <code>x</code> e <code>value</code>, deveremos colocá-los entre os argumentos <code>x</code> e <code>value</code>. No exemplo do código abaixo introduzimos o argumento <code>rm.id</code> em que, se desejarmos, poderemos omitir algumas posições do vetor <code>x</code>:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="r-miscelanea-e-topicos-avancados.html#cb162-1"></a><span class="st">`</span><span class="dt">samenames&lt;-</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">rm.id =</span> <span class="ot">NULL</span>, value){</span>
<span id="cb162-2"><a href="r-miscelanea-e-topicos-avancados.html#cb162-2"></a></span>
<span id="cb162-3"><a href="r-miscelanea-e-topicos-avancados.html#cb162-3"></a>  <span class="cf">if</span> (<span class="kw">length</span>(value) <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;Um vetor de comprimento 1 deverá ser atribuído.&quot;</span>)</span>
<span id="cb162-4"><a href="r-miscelanea-e-topicos-avancados.html#cb162-4"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(rm.id) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(rm.id)){</span>
<span id="cb162-5"><a href="r-miscelanea-e-topicos-avancados.html#cb162-5"></a>    x &lt;-<span class="st"> </span>x[<span class="op">-</span>rm.id]</span>
<span id="cb162-6"><a href="r-miscelanea-e-topicos-avancados.html#cb162-6"></a>    <span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="kw">rep</span>(value, <span class="dt">times =</span> <span class="kw">length</span>(x))</span>
<span id="cb162-7"><a href="r-miscelanea-e-topicos-avancados.html#cb162-7"></a>  }<span class="cf">else</span>{</span>
<span id="cb162-8"><a href="r-miscelanea-e-topicos-avancados.html#cb162-8"></a>    <span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="kw">rep</span>(value, <span class="dt">times =</span> <span class="kw">length</span>(x))</span>
<span id="cb162-9"><a href="r-miscelanea-e-topicos-avancados.html#cb162-9"></a>  }</span>
<span id="cb162-10"><a href="r-miscelanea-e-topicos-avancados.html#cb162-10"></a>  x</span>
<span id="cb162-11"><a href="r-miscelanea-e-topicos-avancados.html#cb162-11"></a>}</span>
<span id="cb162-12"><a href="r-miscelanea-e-topicos-avancados.html#cb162-12"></a>x &lt;-<span class="st"> </span>1L<span class="op">:</span>10L</span>
<span id="cb162-13"><a href="r-miscelanea-e-topicos-avancados.html#cb162-13"></a><span class="kw">samenames</span>(x) &lt;-<span class="st"> &quot;a&quot;</span></span>
<span id="cb162-14"><a href="r-miscelanea-e-topicos-avancados.html#cb162-14"></a><span class="co"># Removendo a primeira e a décima posição de x.</span></span>
<span id="cb162-15"><a href="r-miscelanea-e-topicos-avancados.html#cb162-15"></a><span class="kw">samenames</span>(x, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>)) &lt;-<span class="st"> &quot;a&quot;</span></span>
<span id="cb162-16"><a href="r-miscelanea-e-topicos-avancados.html#cb162-16"></a>x</span></code></pre></div>
<pre><code>## a a a a a a a a 
## 2 3 4 5 6 7 8 9</code></pre>
<p><strong>Observação</strong>:</p>

<div class="rmdobservation">
<div class="text-justify">
<p>A linguagem R possui diversos outros recursos, escritos em forma especial, que também são funções. Abaixo pontuarei alguns desses recursos, para que você tenha uma ideia, porém, existem mais:</p>
<ul>
<li><code>(x)</code> com representação prefixa dada por <code>`(`(x)</code>;</li>
<li><code>x[i]</code> com representação prefixa dada por <code>`[`(x, i)</code>;</li>
<li><code>x[[i]]</code> com representação prefixa dada por <code>`[[`(x, i)</code>;</li>
<li><code>{x}</code> com representação prefixa dada por <code>`{`(x)</code>;</li>
<li><code>if(condicao)</code> com representação prefixa dada por <code>`if`(condicao, se_verdade, se_falso)</code>;</li>
<li><code>for(variável in conjunto) ação</code> com representação prefixa dada por <code>`for`(variável, conjunto, ação)</code>;</li>
<li><code>while(condição) ação</code> com representação prefixa dada por <code>`while`(cond, action)</code>.</li>
</ul>
</div>
</div>

</div>
<div id="closures" class="section level3">
<h3><span class="header-section-number">5.2.8</span> Closures</h3>
<p>Como já sabemos, uma utilidade comum de funções anônimas está em criar pequenas funções que não vale a pena nomear. Normalmente são funções pequenas que são passadas como argumento à outras funções, fornecendo assim menos ruídos visuais no código e nos livrando da necessidade de pensarmos em um bom nome para a função.</p>
<p>Um outro importante uso de funções anônimas está na necessidade <a href="https://en.wikipedia.org/wiki/Closure_(computer_programming)"><strong>closures</strong></a>. O conceito de <strong>closures</strong> surgiu na década de 1960 para avaliação de expressões no <a href="https://en.wikipedia.org/wiki/Lambda_calculus"><strong><span class="math inline">\(\lambda\)</span>-calculus</strong></a> (um sistema formal na lógica matemática para representar a computação com base na abstração de funções) e teve sua primeira implementação computacional em 1970 como um recurso da linguagem de programação <a href="https://en.wikipedia.org/wiki/PAL_(programming_language)"><strong>PAL</strong></a>. Com o passar dos anos, diversas linguagens de programação permitiram o uso de <strong>closures</strong>, um recurso de programação muito utilizado quando necessitamos criar funções escritas por outras funções:</p>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p><strong>Closure</strong> possui esse nome por se tratar de uma função que encerra o seu ambiente, passando seus parâmetros para o ambiente da função mais interna, função esta que será retornada e que executará o trabalho desejado.</p>
</div>
</div>

<p>O trecho de código abaixo exemplifica o uso de <strong>closure</strong>, em que a função <code>potencia()</code> (função pai) poderá gerar novas funções de interesse, cujo trabalho será executado pela função anônima interna à função <code>potencia()</code>. Por exemplo, poderemos criar os objetos <code>quadrado</code> e <code>cubo</code> que serão as funções <code>quadrado()</code> e <code>cubo()</code>, respectivamente, sem a necessidade de implementar cada uma dessas funções.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="r-miscelanea-e-topicos-avancados.html#cb164-1"></a>potencia &lt;-<span class="st"> </span><span class="cf">function</span>(expoente) {</span>
<span id="cb164-2"><a href="r-miscelanea-e-topicos-avancados.html#cb164-2"></a>   <span class="co"># Função anônima.</span></span>
<span id="cb164-3"><a href="r-miscelanea-e-topicos-avancados.html#cb164-3"></a>   <span class="cf">function</span>(x) {</span>
<span id="cb164-4"><a href="r-miscelanea-e-topicos-avancados.html#cb164-4"></a>      x <span class="op">^</span><span class="st"> </span>expoente</span>
<span id="cb164-5"><a href="r-miscelanea-e-topicos-avancados.html#cb164-5"></a>   }</span>
<span id="cb164-6"><a href="r-miscelanea-e-topicos-avancados.html#cb164-6"></a>}</span>
<span id="cb164-7"><a href="r-miscelanea-e-topicos-avancados.html#cb164-7"></a></span>
<span id="cb164-8"><a href="r-miscelanea-e-topicos-avancados.html#cb164-8"></a><span class="co"># Criando as funções quandrado() e cubo().</span></span>
<span id="cb164-9"><a href="r-miscelanea-e-topicos-avancados.html#cb164-9"></a>quadrado &lt;-<span class="st"> </span><span class="kw">potencia</span>(<span class="dv">2</span>)</span>
<span id="cb164-10"><a href="r-miscelanea-e-topicos-avancados.html#cb164-10"></a>cubo &lt;-<span class="st"> </span><span class="kw">potencia</span>(<span class="dv">3</span>)</span>
<span id="cb164-11"><a href="r-miscelanea-e-topicos-avancados.html#cb164-11"></a></span>
<span id="cb164-12"><a href="r-miscelanea-e-topicos-avancados.html#cb164-12"></a><span class="co"># Utilizando as funções criadas pela função potencia():</span></span>
<span id="cb164-13"><a href="r-miscelanea-e-topicos-avancados.html#cb164-13"></a><span class="kw">quadrado</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="r-miscelanea-e-topicos-avancados.html#cb166-1"></a><span class="kw">cubo</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 27</code></pre>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<p>Perceba que as funções <code>quadrado()</code> e <code>cubo()</code> não foram implementadas diretamente. Além disso, nesse caso, note essas funções retornadas aos objetos <code>quadrado</code> e <code>cubo</code> são funções que possuem <code>x</code> como argumento que era argumento da função anônima.</p>
</div>
</div>

</div>
<div id="exercicios-2" class="section level3 unnumbered">
<h3>Exercícios</h3>
<ol style="list-style-type: decimal">
<li><p>Quais são os três componentes de uma função?</p></li>
<li><p>Contrua o objeto <code>y</code> que retorne a saída abaixo:</p>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
## attr(,&quot;att_1&quot;)
## [1] &quot;Isso é um atributo&quot;</code></pre></li>
<li><p>Remova o atributo <code>att_1</code> do objeto <code>y</code> acima.</p></li>
<li><p>O que o código abaixo retorna? Explique. <strong>Dica</strong>: para certificar-se que esteja entendendo, tente prever sem executar a função.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="r-miscelanea-e-topicos-avancados.html#cb169-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb169-2"><a href="r-miscelanea-e-topicos-avancados.html#cb169-2"></a>   f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb169-3"><a href="r-miscelanea-e-topicos-avancados.html#cb169-3"></a>      f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb169-4"><a href="r-miscelanea-e-topicos-avancados.html#cb169-4"></a>         x <span class="op">*</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb169-5"><a href="r-miscelanea-e-topicos-avancados.html#cb169-5"></a>      }</span>
<span id="cb169-6"><a href="r-miscelanea-e-topicos-avancados.html#cb169-6"></a>      <span class="kw">f</span>(x) <span class="op">*</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb169-7"><a href="r-miscelanea-e-topicos-avancados.html#cb169-7"></a>   }</span>
<span id="cb169-8"><a href="r-miscelanea-e-topicos-avancados.html#cb169-8"></a>   <span class="kw">f</span>(x) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb169-9"><a href="r-miscelanea-e-topicos-avancados.html#cb169-9"></a>}</span>
<span id="cb169-10"><a href="r-miscelanea-e-topicos-avancados.html#cb169-10"></a><span class="kw">f</span>(<span class="dv">7</span>)</span></code></pre></div></li>
<li><p>O que o código abaixo retorna? Explique. <strong>Dica</strong>: para certificar-se que esteja entendendo, tente prever sem executar a função.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="r-miscelanea-e-topicos-avancados.html#cb170-1"></a>   x &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb170-2"><a href="r-miscelanea-e-topicos-avancados.html#cb170-2"></a>   f &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb170-3"><a href="r-miscelanea-e-topicos-avancados.html#cb170-3"></a>      x &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb170-4"><a href="r-miscelanea-e-topicos-avancados.html#cb170-4"></a>      x &lt;&lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb170-5"><a href="r-miscelanea-e-topicos-avancados.html#cb170-5"></a>      x</span>
<span id="cb170-6"><a href="r-miscelanea-e-topicos-avancados.html#cb170-6"></a>   }</span>
<span id="cb170-7"><a href="r-miscelanea-e-topicos-avancados.html#cb170-7"></a>   <span class="kw">f</span>(); x</span></code></pre></div></li>
<li><p>O que o código abaixo retorna? <strong>Dica</strong>: para certificar-se que esteja entendendo, tente prever sem executar a função.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="r-miscelanea-e-topicos-avancados.html#cb171-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb171-2"><a href="r-miscelanea-e-topicos-avancados.html#cb171-2"></a>   y &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb171-3"><a href="r-miscelanea-e-topicos-avancados.html#cb171-3"></a>   g &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb171-4"><a href="r-miscelanea-e-topicos-avancados.html#cb171-4"></a>      y &lt;&lt;-<span class="st"> </span>y <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb171-5"><a href="r-miscelanea-e-topicos-avancados.html#cb171-5"></a>   }</span>
<span id="cb171-6"><a href="r-miscelanea-e-topicos-avancados.html#cb171-6"></a>   <span class="kw">list</span>(<span class="kw">rep</span>(<span class="dt">x =</span> <span class="kw">g</span>(), <span class="dt">times =</span> y), <span class="kw">rep</span>(<span class="dt">x =</span> <span class="kw">g</span>(), <span class="dt">times =</span> y), <span class="kw">rep</span>(<span class="dt">x =</span> <span class="kw">g</span>(), <span class="dt">times =</span> y))</span>
<span id="cb171-7"><a href="r-miscelanea-e-topicos-avancados.html#cb171-7"></a>}</span></code></pre></div></li>
<li><p>Implemente a função <code>%+%</code> que concatena duas strings. Permita que, por meio do uso prefixo da função, o usuário possa informar o caractere que separa as duas strings. Abaixo encontra-se um exemplo do uso infixo da função.</p>
<pre><code>&quot;Estatística&quot; %+% &quot;Computacional&quot;

## [1] &quot;Estatística Computacional&quot;</code></pre></li>
<li><p>Implemente a função segundo que trabalhe da seguinte forma:</p>
<pre><code>   x &lt;- 1:10
   segundo(x) &lt;- 5
   x

   ## [1] 1 5 3 4 5 6 7 8 9 10</code></pre></li>
<li><p>Implemente a função <code>troca()</code> que trabalhe da forma abaixo:</p>
<pre><code>   x &lt;- 1:10
   troca(x, 2) &lt;- 7
   x

   ## [1] 1 7 3 4 5 6 7 8 9 10</code></pre></li>
<li><p>Qual o retorno da função abaixo? Explique.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="r-miscelanea-e-topicos-avancados.html#cb175-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(y) {</span>
<span id="cb175-2"><a href="r-miscelanea-e-topicos-avancados.html#cb175-2"></a>    <span class="cf">function</span>(x) {</span>
<span id="cb175-3"><a href="r-miscelanea-e-topicos-avancados.html#cb175-3"></a>       x <span class="op">+</span><span class="st"> </span>y</span>
<span id="cb175-4"><a href="r-miscelanea-e-topicos-avancados.html#cb175-4"></a>    }</span>
<span id="cb175-5"><a href="r-miscelanea-e-topicos-avancados.html#cb175-5"></a>}</span>
<span id="cb175-6"><a href="r-miscelanea-e-topicos-avancados.html#cb175-6"></a>g &lt;-<span class="st"> </span><span class="kw">f</span>(<span class="dv">1</span>)</span>
<span id="cb175-7"><a href="r-miscelanea-e-topicos-avancados.html#cb175-7"></a><span class="kw">g</span>(<span class="dt">x =</span> <span class="dv">2</span>)</span></code></pre></div></li>
<li><p>Utilizando o conceito de <strong>closure</strong> e o operador <code>...</code> (<strong>dot-dot-dot</strong>), construa a função <code>cdf_expg(G)</code> que recebe como argumento uma função de distribuição (<strong>qualquer</strong>), seja ela denotada por <span class="math inline">\(G\)</span>. A função <code>cdf_expg(G)</code> deverá retornar a função de distribuição <span class="math inline">\(\mathrm{Exp}-G\)</span> definida por
<span class="math display">\[F(x) = G^a(x),\]</span>
com <span class="math inline">\(a &gt; 0\)</span>. Perceba que <span class="math inline">\(F\)</span> é uma nova distribuição de probabilidade com um parâmetro a mais (<span class="math inline">\(a &gt; 0\)</span>) e que possui a distribuição <span class="math inline">\(G\)</span> como caso particular quando <span class="math inline">\(a = 1\)</span>. Por exemplo, se <code>cdf_weibull</code> é a implementação da distribuição Weibull, então <code>cdf_expg(G = cdf_weibull)</code> deverá retornar uma função que implementa a distribuição <span class="math inline">\(\mathrm{Exp-Weibull}\)</span>.</p></li>
</ol>
<!-- cdf_weibull <- function(alpha, beta, x){ -->
<!--   pweibull(q = x, shape = alpha, scale = beta) -->
<!-- } -->
<!-- cdf_expg <- function(G){ -->
<!--   function(x, a, ...){ -->
<!--     G(x, ...) ^ a -->
<!--   } -->
<!-- } -->
<!-- cdf_expweibull <- cdf_expg(G = cdf_weibull) -->
</div>
</div>
<div id="funcionais" class="section level2">
<h2><span class="header-section-number">5.3</span> Funcionais</h2>
<p>Funcionais não são nada a mais que funções que recebe como argumento uma outra função como argumento e retorna um vetor como saída. O trecho de código que segue implementa o funcional <code>f()</code>, retornando um vetor como saída:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="r-miscelanea-e-topicos-avancados.html#cb176-1"></a><span class="co"># A função f() é um funcional.</span></span>
<span id="cb176-2"><a href="r-miscelanea-e-topicos-avancados.html#cb176-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, func) <span class="kw">func</span>(x)</span>
<span id="cb176-3"><a href="r-miscelanea-e-topicos-avancados.html#cb176-3"></a></span>
<span id="cb176-4"><a href="r-miscelanea-e-topicos-avancados.html#cb176-4"></a><span class="co"># Passando uma função à f() por meio do argumento func.</span></span>
<span id="cb176-5"><a href="r-miscelanea-e-topicos-avancados.html#cb176-5"></a><span class="co"># Foi passado à func uma função anônima.</span></span>
<span id="cb176-6"><a href="r-miscelanea-e-topicos-avancados.html#cb176-6"></a><span class="kw">f</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">10</span>), <span class="dt">func =</span> <span class="cf">function</span>(x) x <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1]  2  3  8 11</code></pre>
<p>Perceba que a função <code>f()</code> é um funcional, visto que <code>f()</code> recebe uma função por meio do argumento <code>func</code> e retorna um vetor como saída, que nesse caso é o vetor passado ao argumento <code>x</code> de <code>f()</code> acrescido de um. Considere agora o trecho que segue:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="r-miscelanea-e-topicos-avancados.html#cb178-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">mean</span>(<span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>))</span>
<span id="cb178-2"><a href="r-miscelanea-e-topicos-avancados.html#cb178-2"></a><span class="co"># A função loop() é um funcional.</span></span>
<span id="cb178-3"><a href="r-miscelanea-e-topicos-avancados.html#cb178-3"></a>loop &lt;-<span class="st"> </span><span class="cf">function</span>(x, func) {</span>
<span id="cb178-4"><a href="r-miscelanea-e-topicos-avancados.html#cb178-4"></a>   resultado &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb178-5"><a href="r-miscelanea-e-topicos-avancados.html#cb178-5"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x))</span>
<span id="cb178-6"><a href="r-miscelanea-e-topicos-avancados.html#cb178-6"></a>      resultado &lt;-<span class="st"> </span><span class="kw">c</span>(resultado, <span class="kw">func</span>())</span>
<span id="cb178-7"><a href="r-miscelanea-e-topicos-avancados.html#cb178-7"></a>   resultado</span>
<span id="cb178-8"><a href="r-miscelanea-e-topicos-avancados.html#cb178-8"></a>}</span>
<span id="cb178-9"><a href="r-miscelanea-e-topicos-avancados.html#cb178-9"></a></span>
<span id="cb178-10"><a href="r-miscelanea-e-topicos-avancados.html#cb178-10"></a><span class="kw">loop</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">func =</span> f)</span></code></pre></div>
<pre><code>## [1] 0.3702804 0.7174270 0.3805153</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="r-miscelanea-e-topicos-avancados.html#cb180-1"></a><span class="kw">loop</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">func =</span> f)</span></code></pre></div>
<pre><code>## [1] 0.5092227 0.4038002 0.5425011 0.5148392 0.2298425 0.3374357 0.3344574</code></pre>
<p>A função <code>loop()</code> é um funcional que reproduz a função passada ao argumento <code>func</code> um quantidade qualquer de vezes. No exemplo acima, <code>loop(x = 1:3, func = f)</code> e <code>loop(x = 1:7, func = f)</code> reproduz <code>f()</code> 3 (três) e 7 (sete) vezes, respectivamente. Em situações em que você deseja reproduzir uma função ou aplicá-la à cada posição de um vetor ou lista e isso se repete por diversas partes do seu código, o uso de um funcional poderá deixar seu código mais limpo, sem a necessidade de escrever muitas estruturas de repetições. No exemplo acima, se em outra parte do código houvesse a necessidade de reproduzir <code>f()</code> 10 (dez) vezes, bastaria fazer <code>loop(x = 1:10, func = f)</code> ao invés de escrever novamente um laço com alguma estrutura de repetição.</p>
<p>Escrever estruturas de repetições, na forma acima, não é muito útil do ponto de vista de desempenho computacional, uma vez que não há melhoria no desempenho do código que seria obtido ao se implementar os loops sem o uso do funcional <code>loop()</code>. Nesse exemplo, toda vez que chamamos <code>loop()</code>, o que internamente está sendo feito é um loop utilizando a estrutura de repetição <code>for</code>. A melhor forma, em R, de se fazer uso de funcionais é considerar os que já estão implementados de forma consistente, utilizando linguagens mais eficientes, como, por exemplo, os funcionais de R escritos em C/C++ ou Fortran (códigos mais antigos) e que estão disponíveis no <strong>R base</strong> ou em pacotes suplementares. Fazer uso desses funcionais nos trará o benefício de escrever estruturas de repetições sem a necessidade de implementar essa estrutura toda vez que necessitarmos, além do benefício de substituir uma estrutura de repetição de R, que naturalmente são lentas, por funcionais que são muito mais eficientes.</p>
<blockquote>
<p>“Para se tornar significativamente mais confiável, o código deve se tornar mais transparente. Em particular, condições aninhadas e loops devem ser vistos com grande suspeita. Fluxos de controle complicados confundem os programadores. O código bagunçado geralmente esconde bugs.”</p>
</blockquote>
<blockquote>
<p>— <a href="https://pt.wikipedia.org/wiki/Bjarne_Stroustrup"><strong>Bjarne Stroustrup</strong></a>, criador da linguagem de programação <a href="https://pt.wikipedia.org/wiki/C%2B%2B"><strong>C++</strong></a>.</p>
</blockquote>
<div id="funcionais-do-r-base" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Funcionais do R Base</h3>
<p>O pacote <strong>base</strong> da linguagem R (algumas vezes chamo de <strong>R Base</strong>) possui alguns funcionais que podem ser bastante úteis em diversas situações. Tentar evitar escrever estruturas de repetições por meio do uso de funcionais é uma prática útil e algo bastante comum em linguagens de programação com <a href="https://en.wikipedia.org/wiki/Functional_programming"><strong>paradigma funcional</strong></a> e em linguagens multiparadigmas, como é o caso da linguagem R.</p>
<p><strong>Observação</strong>:</p>

<div class="rmdobservation">
<div class="text-justify">
<p>Poderá existir diversas situações que não poderemos escapar do uso de estruturas de repetições, no caso do R, das estruturas <code>for</code>, <code>while</code> e <code>repeat</code>. Porém, existem diversas outras situações que aquilo que encontra-se dentro do loop é uma estrutura bem definida que poderá ser envolvida em uma função e repetida por um funcional. Dessa forma, sempre procure checar se você poderá envolver em uma função o conteúdo que seria colocado no interior de uma estrutura de repetição. Passar esse conteúdo como uma função à um funcional poderá trazer benefícios ao seu código.</p>
</div>
</div>

<div id="apply" class="section level4">
<h4><span class="header-section-number">5.3.1.1</span> apply()</h4>
<p>Trata-se de um funcional bastante conhecido em R, implementado no <strong>R Base</strong>. O funcional <code>apply()</code> é normalmente utilizado quando desejamos aplicar uma função em uma das dimensões de uma matriz, data frame ou tibble, sendo este último um estrutura de dados do pacote <a href="https://tibble.tidyverse.org/"><strong>tibble</strong></a>. A estrutura tibble trata-se de uma releitura moderna de um data frame com um método <code>print()</code> aprimorado. Porém, não se preocupe, quase tudo que você sabe sobre data frame será válido para um objeto da classe <strong>tbl</strong>. A forma geral do funcional <code>apply()</code> é dada por:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="r-miscelanea-e-topicos-avancados.html#cb182-1"></a><span class="kw">apply</span>(X, MARGIN, FUN, ...)</span></code></pre></div>
<p>em que:</p>
<ul>
<li><p><code>X</code>: é a matriz/data frame ou tibble em que será aplicada uma função sobre seus elementos;</p></li>
<li><p><code>MARGIN</code>: indica a dimensão em que a função irá ser aplicada. Se <code>MARGIN = 1</code> (padrão), temos que uma dada função será aplicada sobre as linhas de do objeto <code>X</code>. Fazendo <code>MARGIN = 1</code>, temos que uma dada função será aplicada sobre todas as colunas do objeto <code>X</code>;</p></li>
<li><p><code>FUN</code>: função que iremos aplicar em uma das dimensões do objeto <code>X</code>. Dessa forma, o funcional <code>apply()</code> tomará cada linha ou coluna (a depender de <code>MARGIN</code>) como sendo o primeiro arugmento da função passada à <code>FUN</code>;</p></li>
<li><p><code>...</code>: operador <a href="r-miscelanea-e-topicos-avancados.html#varargs-dot-dot-dot"><strong>dot-dot-dot</strong></a> discutido em tópicos anteriores. Isso permitirá que possamos acessar os argumentos da função passada à <code>FUN</code> passando estes argmento ao funcional <code>apply()</code>.</p></li>
</ul>
<p><strong>Exemplo</strong>: Aplicando a função <code>mean()</code> sobre linhas e colunas do objeto <code>M</code> (uma matriz). O uso do funcional <code>apply()</code> seria equivalente se <code>M</code> fosse um data frame ou uma tibble.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="r-miscelanea-e-topicos-avancados.html#cb183-1"></a><span class="co"># Construindo a matriz m de orden 5x5.</span></span>
<span id="cb183-2"><a href="r-miscelanea-e-topicos-avancados.html#cb183-2"></a>M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb183-3"><a href="r-miscelanea-e-topicos-avancados.html#cb183-3"></a><span class="co"># Aplicando a função mean() sobre cada linha de m.</span></span>
<span id="cb183-4"><a href="r-miscelanea-e-topicos-avancados.html#cb183-4"></a><span class="kw">apply</span>(<span class="dt">X =</span> M, <span class="dt">MARGIN =</span> <span class="dv">1</span>, mean)</span></code></pre></div>
<pre><code>## [1] 11 12 13 14 15</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="r-miscelanea-e-topicos-avancados.html#cb185-1"></a><span class="co"># Aplicando a função mean() sobre cada coluna de m.</span></span>
<span id="cb185-2"><a href="r-miscelanea-e-topicos-avancados.html#cb185-2"></a><span class="kw">apply</span>(<span class="dt">X =</span> M, <span class="dt">MARGIN =</span> <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1]  3  8 13 18 23</code></pre>
</div>
<div id="lapply-sapply-e-vapply" class="section level4">
<h4><span class="header-section-number">5.3.1.2</span> lapply(), sapply() e vapply()</h4>
<p>Os funcionais <code>lapply()</code>, <code>sapply()</code> e <code>vapply()</code> foi introduzido o mesmo tópico, visto que eles tem muito em comum. Tais funcionais permitem que venhamos aplicar uma função à elementos de um vetor ou elementos de uma lista.</p>
<p><strong>Uso</strong>:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="r-miscelanea-e-topicos-avancados.html#cb187-1"></a><span class="kw">lapply</span>(X, FUN, ...)</span>
<span id="cb187-2"><a href="r-miscelanea-e-topicos-avancados.html#cb187-2"></a></span>
<span id="cb187-3"><a href="r-miscelanea-e-topicos-avancados.html#cb187-3"></a><span class="kw">sapply</span>(X, FUN, ..., <span class="dt">simplify =</span> <span class="ot">TRUE</span>)</span>
<span id="cb187-4"><a href="r-miscelanea-e-topicos-avancados.html#cb187-4"></a></span>
<span id="cb187-5"><a href="r-miscelanea-e-topicos-avancados.html#cb187-5"></a><span class="kw">vapply</span>(X, FUN, FUN.VALUE, ...)</span></code></pre></div>
<p>O funcional <code>lapply()</code> retorna uma lista do mesmo tamanho que <code>X</code>, em que cada elemento é o resultado da aplicação de <code>FUN</code> no elemento correspondente de <code>X</code>. Já o funcional <code>sapply()</code> é bastante semelhante ao funcional <code>lapply()</code>, sendo o retorno a diferença mais notável, visto que <code>lapply()</code> sempre retornará uma lista e <code>sapply()</code> retorna uma estrutura que melhor poderá comportar as informações, havendo uma espécie de simplificação da estrutura a ser retornada. Considere o trecho de código que segue</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="r-miscelanea-e-topicos-avancados.html#cb188-1"></a><span class="co"># Criando um vetor double.</span></span>
<span id="cb188-2"><a href="r-miscelanea-e-topicos-avancados.html#cb188-2"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>))</span>
<span id="cb188-3"><a href="r-miscelanea-e-topicos-avancados.html#cb188-3"></a><span class="co"># A função f() retorna uma matrix de caracter.</span></span>
<span id="cb188-4"><a href="r-miscelanea-e-topicos-avancados.html#cb188-4"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb188-5"><a href="r-miscelanea-e-topicos-avancados.html#cb188-5"></a>   <span class="kw">as.character</span>(<span class="kw">round</span>(<span class="kw">sin</span>(x), <span class="dt">digits =</span> <span class="dv">2</span>))</span>
<span id="cb188-6"><a href="r-miscelanea-e-topicos-avancados.html#cb188-6"></a>}</span>
<span id="cb188-7"><a href="r-miscelanea-e-topicos-avancados.html#cb188-7"></a></span>
<span id="cb188-8"><a href="r-miscelanea-e-topicos-avancados.html#cb188-8"></a><span class="kw">lapply</span>(<span class="dt">X =</span> x, <span class="dt">FUN =</span> f)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;0.84&quot;  &quot;0.66&quot;  &quot;-0.76&quot; &quot;0.14&quot; 
## 
## [[2]]
## [1] &quot;0.84&quot;  &quot;0.91&quot;  &quot;0.14&quot;  &quot;-0.28&quot;</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="r-miscelanea-e-topicos-avancados.html#cb190-1"></a><span class="kw">sapply</span>(<span class="dt">X =</span> x, <span class="dt">FUN =</span> f)</span></code></pre></div>
<pre><code>##      [,1]    [,2]   
## [1,] &quot;0.84&quot;  &quot;0.84&quot; 
## [2,] &quot;0.66&quot;  &quot;0.91&quot; 
## [3,] &quot;-0.76&quot; &quot;0.14&quot; 
## [4,] &quot;0.14&quot;  &quot;-0.28&quot;</code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Perceba que para o exemplo acima, <code>lapply(X = x, FUN = f)</code> equivale a fazer <code>sapply(X = x, FUN = f, simplify = FALSE)</code>.</p>
</div>
</div>

<p>Por sua vez, o funcional <code>vapply()</code> é bastante similar ao funcional <code>sapply()</code>, porém, podemos especificar os tipos de valor de retorno. Considere o trecho de código abaixo que mostra o uso da função <code>vapply()</code>. Perceba, no código de segue, que <code>FUN.VALUE</code> recebe como argumento o tipo esperado de retorno da função <code>f()</code> e o tamanho do vetor retornado ao aplicar a função <code>f()</code> à cada elemento da lista passada à <code>X</code>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="r-miscelanea-e-topicos-avancados.html#cb192-1"></a><span class="co"># Criando um vetor double.</span></span>
<span id="cb192-2"><a href="r-miscelanea-e-topicos-avancados.html#cb192-2"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>))</span>
<span id="cb192-3"><a href="r-miscelanea-e-topicos-avancados.html#cb192-3"></a><span class="co"># A função f() retorna uma matrix de caracter.</span></span>
<span id="cb192-4"><a href="r-miscelanea-e-topicos-avancados.html#cb192-4"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb192-5"><a href="r-miscelanea-e-topicos-avancados.html#cb192-5"></a>  <span class="kw">as.character</span>(<span class="kw">trunc</span>(<span class="kw">sum</span>(x)))</span>
<span id="cb192-6"><a href="r-miscelanea-e-topicos-avancados.html#cb192-6"></a>}</span>
<span id="cb192-7"><a href="r-miscelanea-e-topicos-avancados.html#cb192-7"></a></span>
<span id="cb192-8"><a href="r-miscelanea-e-topicos-avancados.html#cb192-8"></a><span class="co"># O retorno será uma matriz.</span></span>
<span id="cb192-9"><a href="r-miscelanea-e-topicos-avancados.html#cb192-9"></a>resultado &lt;-<span class="st"> </span><span class="kw">vapply</span>(<span class="dt">X =</span> x, <span class="dt">FUN =</span> f, <span class="dt">FUN.VALUE =</span> <span class="kw">character</span>(<span class="dv">1</span>))</span>
<span id="cb192-10"><a href="r-miscelanea-e-topicos-avancados.html#cb192-10"></a>resultado</span></code></pre></div>
<pre><code>## [1] &quot;15&quot; &quot;12&quot;</code></pre>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>O funcional <code>vapply()</code> poderá dar um pouco mais de segurança quando comparado ao funcional <code>sapply()</code>, visto que poderemos especiticar o tipo de retorno esperado. Dessa forma, é de se esperar que a função <code>vapply()</code> poderá “reclamar” um pouco mais que a função <code>sapply()</code>.</p>
</div>
</div>

</div>
<div id="map-mapply" class="section level4">
<h4><span class="header-section-number">5.3.1.3</span> Map(), mapply()</h4>
<p>Considere a função <code>mp()</code> que recebe como argumento dois vetores de mesmo comprimento e que calcula a média ponderada do vetor passado ao argumento <code>x</code> considerando um vetor de pesos passado à <code>y</code>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="r-miscelanea-e-topicos-avancados.html#cb194-1"></a>mp &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</span>
<span id="cb194-2"><a href="r-miscelanea-e-topicos-avancados.html#cb194-2"></a>   <span class="co"># x é o vetor que desejamos calcular a média ponderada.</span></span>
<span id="cb194-3"><a href="r-miscelanea-e-topicos-avancados.html#cb194-3"></a>   <span class="co"># y é o vetor de pesos.</span></span>
<span id="cb194-4"><a href="r-miscelanea-e-topicos-avancados.html#cb194-4"></a>   <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y)) </span>
<span id="cb194-5"><a href="r-miscelanea-e-topicos-avancados.html#cb194-5"></a>      <span class="kw">stop</span>(<span class="st">&quot;O vetor x deve ter o mesmo comprimento do vetor de pesos y.&quot;</span>)</span>
<span id="cb194-6"><a href="r-miscelanea-e-topicos-avancados.html#cb194-6"></a>   <span class="kw">sum</span>(x<span class="op">*</span>y)<span class="op">/</span><span class="kw">sum</span>(y)</span>
<span id="cb194-7"><a href="r-miscelanea-e-topicos-avancados.html#cb194-7"></a>}</span>
<span id="cb194-8"><a href="r-miscelanea-e-topicos-avancados.html#cb194-8"></a><span class="kw">mp</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">6.5</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Considerando algum dos funcionais apresentados anteriormente, poderemos facilmente aplicar <code>mp()</code> à todos elementos de uma lista de vetores com vetor de pesos fixos, como mostra o código abaixo:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="r-miscelanea-e-topicos-avancados.html#cb196-1"></a>mp &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</span>
<span id="cb196-2"><a href="r-miscelanea-e-topicos-avancados.html#cb196-2"></a>   <span class="co"># x é o vetor que desejamos calcular a média ponderada.</span></span>
<span id="cb196-3"><a href="r-miscelanea-e-topicos-avancados.html#cb196-3"></a>   <span class="co"># y é o vetor de pesos.</span></span>
<span id="cb196-4"><a href="r-miscelanea-e-topicos-avancados.html#cb196-4"></a>   <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y)) </span>
<span id="cb196-5"><a href="r-miscelanea-e-topicos-avancados.html#cb196-5"></a>      <span class="kw">stop</span>(<span class="st">&quot;O vetor x deve ter o mesmo comprimento do vetor de pesos y.&quot;</span>)</span>
<span id="cb196-6"><a href="r-miscelanea-e-topicos-avancados.html#cb196-6"></a>   <span class="co"># Média ponderada.</span></span>
<span id="cb196-7"><a href="r-miscelanea-e-topicos-avancados.html#cb196-7"></a>   <span class="kw">sum</span>(x<span class="op">*</span>y)<span class="op">/</span><span class="kw">sum</span>(y)</span>
<span id="cb196-8"><a href="r-miscelanea-e-topicos-avancados.html#cb196-8"></a>}</span>
<span id="cb196-9"><a href="r-miscelanea-e-topicos-avancados.html#cb196-9"></a></span>
<span id="cb196-10"><a href="r-miscelanea-e-topicos-avancados.html#cb196-10"></a>valores &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">7.3</span>, <span class="fl">3.2</span>, <span class="fl">1.5</span>), <span class="kw">c</span>(<span class="fl">8.4</span>, <span class="fl">4.7</span>, <span class="fl">5.1</span>), <span class="kw">c</span>(<span class="dv">10</span>, <span class="fl">9.7</span>, <span class="fl">9.6</span>), <span class="kw">c</span>(<span class="fl">8.5</span>, <span class="fl">7.2</span>, <span class="fl">7.7</span>))</span>
<span id="cb196-11"><a href="r-miscelanea-e-topicos-avancados.html#cb196-11"></a>pesos &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>) <span class="co"># Pesos fixos.</span></span>
<span id="cb196-12"><a href="r-miscelanea-e-topicos-avancados.html#cb196-12"></a></span>
<span id="cb196-13"><a href="r-miscelanea-e-topicos-avancados.html#cb196-13"></a><span class="co"># Usando lapply():</span></span>
<span id="cb196-14"><a href="r-miscelanea-e-topicos-avancados.html#cb196-14"></a><span class="kw">lapply</span>(<span class="dt">X =</span> valores, <span class="dt">FUN =</span> mp, <span class="dt">y =</span> pesos)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4.91
## 
## [[2]]
## [1] 6.63
## 
## [[3]]
## [1] 9.83
## 
## [[4]]
## [1] 7.95</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="r-miscelanea-e-topicos-avancados.html#cb198-1"></a><span class="co"># Usando sapply():</span></span>
<span id="cb198-2"><a href="r-miscelanea-e-topicos-avancados.html#cb198-2"></a><span class="kw">sapply</span>(<span class="dt">X =</span> valores, <span class="dt">FUN =</span> mp, <span class="dt">y =</span> pesos, <span class="dt">simplify =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 4.91 6.63 9.83 7.95</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="r-miscelanea-e-topicos-avancados.html#cb200-1"></a><span class="co"># Usando vapply():</span></span>
<span id="cb200-2"><a href="r-miscelanea-e-topicos-avancados.html#cb200-2"></a><span class="kw">vapply</span>(<span class="dt">X =</span> valores, <span class="dt">FUN =</span> mp, <span class="dt">y =</span> pesos, <span class="dt">FUN.VALUE =</span> <span class="kw">double</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 4.91 6.63 9.83 7.95</code></pre>
<p>Ao contrário dos funcionais anteriores, em que apenas um dos argumentos da função varia, os funcionais <code>Map()</code> e <code>mapply()</code> permitirão que outros argumentos da função possa também variar. Por exemplo, considere uma pequena modificação do caso anterior, com a diferença de que o objeto <code>pesos</code> será uma lista de pesos. Esse problema poderá ser resolvido utilizando o funcional <code>Map()</code> e <code>mapply()</code>, como mostra o exemplo abaixo:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="r-miscelanea-e-topicos-avancados.html#cb202-1"></a>mp &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</span>
<span id="cb202-2"><a href="r-miscelanea-e-topicos-avancados.html#cb202-2"></a>   <span class="co"># x é o vetor que desejamos calcular a média ponderada.</span></span>
<span id="cb202-3"><a href="r-miscelanea-e-topicos-avancados.html#cb202-3"></a>   <span class="co"># y é o vetor de pesos.</span></span>
<span id="cb202-4"><a href="r-miscelanea-e-topicos-avancados.html#cb202-4"></a>   <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y)) </span>
<span id="cb202-5"><a href="r-miscelanea-e-topicos-avancados.html#cb202-5"></a>      <span class="kw">stop</span>(<span class="st">&quot;O vetor x deve ter o mesmo comprimento do vetor de pesos y.&quot;</span>)</span>
<span id="cb202-6"><a href="r-miscelanea-e-topicos-avancados.html#cb202-6"></a>   <span class="co"># Média ponderada.</span></span>
<span id="cb202-7"><a href="r-miscelanea-e-topicos-avancados.html#cb202-7"></a>   <span class="kw">sum</span>(x<span class="op">*</span>y)<span class="op">/</span><span class="kw">sum</span>(y)</span>
<span id="cb202-8"><a href="r-miscelanea-e-topicos-avancados.html#cb202-8"></a>}</span>
<span id="cb202-9"><a href="r-miscelanea-e-topicos-avancados.html#cb202-9"></a></span>
<span id="cb202-10"><a href="r-miscelanea-e-topicos-avancados.html#cb202-10"></a>valores &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">7.3</span>, <span class="fl">3.2</span>, <span class="fl">1.5</span>), <span class="kw">c</span>(<span class="fl">8.4</span>, <span class="fl">4.7</span>, <span class="fl">5.1</span>), <span class="kw">c</span>(<span class="dv">10</span>, <span class="fl">9.7</span>, <span class="fl">9.6</span>), <span class="kw">c</span>(<span class="fl">8.5</span>, <span class="fl">7.2</span>, <span class="fl">7.7</span>))</span>
<span id="cb202-11"><a href="r-miscelanea-e-topicos-avancados.html#cb202-11"></a>pesos &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="co"># Pesos não fixados.</span></span>
<span id="cb202-12"><a href="r-miscelanea-e-topicos-avancados.html#cb202-12"></a><span class="co"># Utilizando o funcional Map().</span></span>
<span id="cb202-13"><a href="r-miscelanea-e-topicos-avancados.html#cb202-13"></a><span class="kw">Map</span>(<span class="dt">f =</span> mp, <span class="dt">x =</span> valores, <span class="dt">y =</span> pesos)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4.91
## 
## [[2]]
## [1] 5.85
## 
## [[3]]
## [1] 9.8
## 
## [[4]]
## [1] 8.21</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="r-miscelanea-e-topicos-avancados.html#cb204-1"></a><span class="co"># Utilizando o funcional mapply().</span></span>
<span id="cb204-2"><a href="r-miscelanea-e-topicos-avancados.html#cb204-2"></a><span class="kw">mapply</span>(<span class="dt">FUN =</span> mp, <span class="dt">x =</span> valores, <span class="dt">y =</span> pesos)</span></code></pre></div>
<pre><code>## [1] 4.91 5.85 9.80 8.21</code></pre>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<ul>
<li><p>O funcional <code>mapply()</code> funciona de forma bastante semelhante à <code>Map()</code>, retornando um vetor ao invés de uma lista.</p></li>
<li><p>A linguagem R possui um função para o cálculo de média ponderanda. Veja a documentação da função <code>weighted.mean()</code>. Implementamos a função <code>mp()</code> apenas para deixar claro que os funcionais se aplicam à qualquer função de R, incluindo as funções que implementamos.</p></li>
</ul>
</div>
</div>

</div>
</div>
<div id="funcionais-do-pacote-purrr" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Funcionais do pacote purrr</h3>
<p>O pacote <a href="https://purrr.tidyverse.org/"><strong>purrr</strong></a> aprimora o conjunto de ferramentas de programação funcional da linguagem R. Este pacote fornece um conjunto completo, consistente e eficiente de ferramentas para trabalhar com funções e vetores. O pacote <strong>purrr</strong> encontra-se no CRAN (<strong><em>Comprehensive R Archive Network</em></strong>) do R e você poderá instalar facilmente fazendo <code>install.packages("purrr")</code>. Se desejar, você poderá instalar a versão do pacote mantida no GitHub fazendo <code>devtools::install_github("tidyverse/purrr")</code>, nesse caso, será preciso ter instalado o pacote <a href="https://github.com/r-lib/devtools"><strong>devtools</strong></a>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-82"></span>
<img src="images/logo_purrr.png" alt="Logo do pacote [**purrr**](https://purrr.tidyverse.org/) de autoria de [**Hadley Wickham**](https://github.com/hadley) (autor) e e [**Lionel Henry**](https://github.com/lionel-) (autor e mantenedor)." width="25%" />
<p class="caption">
Figura 5.3: Logo do pacote <a href="https://purrr.tidyverse.org/"><strong>purrr</strong></a> de autoria de <a href="https://github.com/hadley"><strong>Hadley Wickham</strong></a> (autor) e e <a href="https://github.com/lionel-"><strong>Lionel Henry</strong></a> (autor e mantenedor).
</p>
</div>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>As funções do pacote <strong>purrr</strong> são implementadas na linguagem C. Dessa forma, são funções tão eficientes quanto àquelas que são fornecidas pelos funcionais do R Base, com a vantagem de ser menos verbosas.</p>
</div>
</div>

<div id="map-e-variantes" class="section level4">
<h4><span class="header-section-number">5.3.2.1</span> map() e variantes</h4>
<p>O funcional <code>map()</code> é a função principal do pacote <strong>purrr</strong>, em que recebe como primeiro argumento um vetor/lista, uma função como segundo argumento e necessário, um conjunto de argumentos passado da função atribuida.</p>
<p><strong>Forma geral de uso</strong>:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="r-miscelanea-e-topicos-avancados.html#cb206-1"></a><span class="kw">map</span>(.x, .f, ...)</span>
<span id="cb206-2"><a href="r-miscelanea-e-topicos-avancados.html#cb206-2"></a><span class="kw">map_int</span>(.x, .f, ...)</span>
<span id="cb206-3"><a href="r-miscelanea-e-topicos-avancados.html#cb206-3"></a><span class="kw">map_dbl</span>(.x, .f, ...)</span>
<span id="cb206-4"><a href="r-miscelanea-e-topicos-avancados.html#cb206-4"></a><span class="kw">map_lgl</span>(.x, .f, ...)</span>
<span id="cb206-5"><a href="r-miscelanea-e-topicos-avancados.html#cb206-5"></a><span class="kw">map_chr</span>(.x, .f, ...)</span></code></pre></div>
<p>em que,</p>
<ul>
<li><p><code>.x</code>: é uma lista ou vetor atômico;</p></li>
<li><p><code>.f</code>: uma função, fórmula (por exemplo <code>~ .x + 2</code>) ou um vetor/lista.</p></li>
<li><p><code>...</code>: um conjunto adicional de argumentos que são mapeados para o objeto passada para o argumento <code>.f</code>;</p></li>
</ul>
<p><strong>Exemplo</strong>: Utilizando o funcional <code>map()</code> que aplica a função <code>sinal()</code> à cada elemento de um vetor atômico. A função irá retornar <code>"-"</code>, <code>"0"</code> ou <code>"+"</code>, a depender do valor passado à <code>x</code> em <code>f()</code>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="r-miscelanea-e-topicos-avancados.html#cb207-1"></a>sinal &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb207-2"><a href="r-miscelanea-e-topicos-avancados.html#cb207-2"></a>   <span class="co"># Varificando a classe de x e parando a execução da função</span></span>
<span id="cb207-3"><a href="r-miscelanea-e-topicos-avancados.html#cb207-3"></a>   <span class="co"># se x não for um objeto da classe numeric.</span></span>
<span id="cb207-4"><a href="r-miscelanea-e-topicos-avancados.html#cb207-4"></a>   <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.numeric</span>(x)) <span class="kw">stop</span> (<span class="st">&quot;x deve ter a classe numérica.&quot;</span>)</span>
<span id="cb207-5"><a href="r-miscelanea-e-topicos-avancados.html#cb207-5"></a></span>
<span id="cb207-6"><a href="r-miscelanea-e-topicos-avancados.html#cb207-6"></a>   <span class="cf">if</span> (x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="st">&quot;0&quot;</span></span>
<span id="cb207-7"><a href="r-miscelanea-e-topicos-avancados.html#cb207-7"></a>   <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="st">&quot;+&quot;</span></span>
<span id="cb207-8"><a href="r-miscelanea-e-topicos-avancados.html#cb207-8"></a>   <span class="cf">else</span> <span class="st">&quot;-&quot;</span></span>
<span id="cb207-9"><a href="r-miscelanea-e-topicos-avancados.html#cb207-9"></a>}</span>
<span id="cb207-10"><a href="r-miscelanea-e-topicos-avancados.html#cb207-10"></a></span>
<span id="cb207-11"><a href="r-miscelanea-e-topicos-avancados.html#cb207-11"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.7</span>, <span class="fl">-2.01</span>, <span class="dv">0</span>, <span class="dv">12</span>)</span>
<span id="cb207-12"><a href="r-miscelanea-e-topicos-avancados.html#cb207-12"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> sinal)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;+&quot;
## 
## [[2]]
## [1] &quot;-&quot;
## 
## [[3]]
## [1] &quot;0&quot;
## 
## [[4]]
## [1] &quot;+&quot;</code></pre>
<p>Perceba que o retorno de <code>map()</code> é uma lista assim como obteriamos ao utilizarmos o funcional <code>lapply()</code>. O exemplo acima poderia ser resolvido, com <code>lapply()</code>, fazendo <code>lapply(X = x, FUN = sinal)</code>. A grande vantagem do uso do funcional <code>map()</code> do pacote <strong>purrr</strong> é que podemos fazer uso de sufixos que nos ajudam na tarefa de converter o resultado para um vetor atômico do tipo desejado, utilizando alguma de suas variantes: <code>map_lgl()</code> (retorno de um vetor com elementos do tipo logical), <code>map_int()</code> (retorno de um vetor com elementos do tipo integer), <code>map_dbl()</code> (retorno de um vetor com elementos do tipo double) e <code>map_chr()</code> (retorno de um vetor com elementos do tipo character).</p>
<p><strong>Exemplo</strong>: Utilizando <code>map_chr()</code> para obtenção de um vetor de caracteres como saída. Isso evito termos que efetuar <code>unlist()</code> para transformarmos uma lista em um vetor atômico.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="r-miscelanea-e-topicos-avancados.html#cb209-1"></a>purrr<span class="op">::</span><span class="kw">map_chr</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> sinal)</span></code></pre></div>
<pre><code>## [1] &quot;+&quot; &quot;-&quot; &quot;0&quot; &quot;+&quot;</code></pre>
<p>Para o argumento <code>.f</code> do funcional <code>map()</code> bem como de seus variantes (<code>map_lgl()</code>, <code>map_int()</code>, <code>map_dbl()</code> e <code>map_chr()</code>), poderemos passar uma função anônima ou uma fórmula. Os três exemplos que seguem apresentam o uso do funcinal <code>map()</code> ou alguma de suas variantes, considerando funções com 1 (um), 2 (dois) ou 3 (três) argumentos. Independentemente de qual(is) varantiante(s) de <code>map()</code> for/forem utilizada(s) nos exemplos, o uso de todas as variântes são equivalentes.</p>
<p><strong>Exemplo (um argumento)</strong>: Uso do funcional <code>map_int()</code> para uma função com um único argumento. Nesse exemplo, desejamos somar 1 à cada elemento do vetor atômico (vetor homogêneo) <code>x &lt;- 1L:10L</code>. Note que, nesse exemplo, resolvemos o problema de somar o valor 1 (do tipo inteiro) aos valores de <code>x</code>, de 4 (quatro) formas distintas. Na primeira forma, definimos a função <code>soma1()</code> e passamos a função como argumento à <code>.f</code> do funcional <code>map_int()</code>. Na segunda forma, optou-se em passar uma função anônima para o argumento <code>.f</code>, uma vez que a função é curta e não necessitaríamos nos preocupar em atribuir um nome à ela. Nessa segunda forma, não haveria a necessidade da definição da função <code>soma1()</code>, uma vez que definimos a função diretamente no funcional, sem a necessidade de atribuição de um nome. Já na terceira e quarta forma, note que optamos em passar um objeto da classe <strong>formula</strong> (note o til, <code>~</code>). Como trata-se de uma função com um único argumento, podemos definir esse argumento por <code>.x</code> ou <code>.</code>.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="r-miscelanea-e-topicos-avancados.html#cb211-1"></a>x &lt;-<span class="st"> </span>1L<span class="op">:</span>10L</span>
<span id="cb211-2"><a href="r-miscelanea-e-topicos-avancados.html#cb211-2"></a>soma1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) x <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb211-3"><a href="r-miscelanea-e-topicos-avancados.html#cb211-3"></a><span class="co"># Foma 1: Passando à .f uma função soma1().</span></span>
<span id="cb211-4"><a href="r-miscelanea-e-topicos-avancados.html#cb211-4"></a>purrr<span class="op">::</span><span class="kw">map_int</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> soma1)</span>
<span id="cb211-5"><a href="r-miscelanea-e-topicos-avancados.html#cb211-5"></a><span class="co"># Forma 2: Passando à .f uma função anônima.</span></span>
<span id="cb211-6"><a href="r-miscelanea-e-topicos-avancados.html#cb211-6"></a>purrr<span class="op">::</span><span class="kw">map_int</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="cf">function</span>(x) x <span class="op">+</span><span class="st"> </span>1L)</span>
<span id="cb211-7"><a href="r-miscelanea-e-topicos-avancados.html#cb211-7"></a><span class="co"># Forma 3: Passando à .f uma formula.</span></span>
<span id="cb211-8"><a href="r-miscelanea-e-topicos-avancados.html#cb211-8"></a>purrr<span class="op">::</span><span class="kw">map_int</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x <span class="op">+</span><span class="st"> </span>1L)</span>
<span id="cb211-9"><a href="r-miscelanea-e-topicos-avancados.html#cb211-9"></a><span class="co"># Forma 4: Para funções com um único argumento, você poderá substituir</span></span>
<span id="cb211-10"><a href="r-miscelanea-e-topicos-avancados.html#cb211-10"></a><span class="co"># .x na fórmula passada ao argumento .f por um &quot;.&quot; (ponto).</span></span>
<span id="cb211-11"><a href="r-miscelanea-e-topicos-avancados.html#cb211-11"></a>purrr<span class="op">::</span><span class="kw">map_int</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>1L)</span></code></pre></div>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>É claro que poderiamos resolver o exemplo acima sem uso de funcional algum, uma vez que a linguagem R é vetorizada e poderiamos simplesmente fazer <code>x + 1L</code> para assim obtermos um vetor de interio. Porém, isso é um exemplo didático, em que o objetifo aqui é entender os funcionais do pacote <strong>purrr</strong> e não perdermos mais tempo com o entendimento da função passada ao funcional. Sempre tenha em mente que a função passada à <code>.f</code>, na maioria das vezes, não será tão simples a ponto de justificar resolver o problema sem o uso de um funcional.</p>
</div>
</div>

<p><strong>Exemplo (dois argumentos)</strong>: Uso do funcional <code>map()</code>, em que é aplicado a função <code>f()</code> sobre todos os elementos da lista <code>x</code>. O exemplo mostra que a função <code>map()</code> varia sobre os elementos do primeiro argumento <code>.x</code> e fixa o segundo argumento. Além disso, note que é possível passar uma função anônima ou uma fórmula ao argumento <code>.f</code> do funcional <code>map()</code>, assim como no exemplo anterior. Para o caso de passagem de uma fórmula, podemos utilizar <code>.</code> ou <code>.x</code> para se referir ao primeiro argumento de <code>f()</code> e <code>.y</code> para fazer referência ao segundo argumento.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="r-miscelanea-e-topicos-avancados.html#cb212-1"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">1.1</span>,<span class="fl">4.07</span>,<span class="fl">3.76</span>), <span class="kw">c</span>(<span class="fl">7.1</span>,<span class="fl">2.2</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb212-2"><a href="r-miscelanea-e-topicos-avancados.html#cb212-2"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb212-3"><a href="r-miscelanea-e-topicos-avancados.html#cb212-3"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">sqrt</span>(y))</span>
<span id="cb212-4"><a href="r-miscelanea-e-topicos-avancados.html#cb212-4"></a><span class="co"># Forma 1: Passando a função f() para o argumento .f</span></span>
<span id="cb212-5"><a href="r-miscelanea-e-topicos-avancados.html#cb212-5"></a><span class="co"># de map_dbl().</span></span>
<span id="cb212-6"><a href="r-miscelanea-e-topicos-avancados.html#cb212-6"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> f, <span class="dt">y =</span> y)</span>
<span id="cb212-7"><a href="r-miscelanea-e-topicos-avancados.html#cb212-7"></a><span class="co"># Forma 2: Passando uma função anônima de dois argumentos.</span></span>
<span id="cb212-8"><a href="r-miscelanea-e-topicos-avancados.html#cb212-8"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="cf">function</span>(x, y) <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">sqrt</span>(y)) , <span class="dt">y =</span> y)</span>
<span id="cb212-9"><a href="r-miscelanea-e-topicos-avancados.html#cb212-9"></a><span class="co"># Forma 3: Utilizamos .x e .y em situações de funções com 2 argumentos.</span></span>
<span id="cb212-10"><a href="r-miscelanea-e-topicos-avancados.html#cb212-10"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>.x <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">sqrt</span>(.y)), <span class="dt">.y =</span> y)</span>
<span id="cb212-11"><a href="r-miscelanea-e-topicos-avancados.html#cb212-11"></a><span class="co"># Forma 4: Aqui o x .x será substituido na ocorrência de &quot;.&quot; (ponto).</span></span>
<span id="cb212-12"><a href="r-miscelanea-e-topicos-avancados.html#cb212-12"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">sqrt</span>(.y)), <span class="dt">.y =</span> y)</span></code></pre></div>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Note que nesse exemplo não poderemos fazer uso das variantes do funcional <code>map()</code>. Isso se deve ao fato de <code>x</code> ser uma lista, o que implica que a função <code>f()</code> será aplicada à cada elemento da lista <code>x</code>. Sendo assim, esperamos que o retorno de <code>map()</code> será uma lista com a mesma quantidade de elementos de <code>x</code>.</p>
</div>
</div>

<p><strong>Exemplo (três ou mais argumentos)</strong>: Esse exemplo é muito parecido com o exemplo antrior (função <code>f()</code> com 2 (dois) argumentos). Aqui, temos que a função <code>f()</code> possui 3 (três) argumentos. Perceba porém, que ao se passar uma fórmula ao argumento <code>.f</code> do funcional <code>map()</code>, poderemos nos referir ao terceiro argumento com a notação <code>..3</code>.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="r-miscelanea-e-topicos-avancados.html#cb213-1"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb213-2"><a href="r-miscelanea-e-topicos-avancados.html#cb213-2"></a>y &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></span>
<span id="cb213-3"><a href="r-miscelanea-e-topicos-avancados.html#cb213-3"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb213-4"><a href="r-miscelanea-e-topicos-avancados.html#cb213-4"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, z) x <span class="op">*</span><span class="st"> </span>y <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>z</span>
<span id="cb213-5"><a href="r-miscelanea-e-topicos-avancados.html#cb213-5"></a><span class="co"># Forma 1: Passando a função f() para o argumento .f</span></span>
<span id="cb213-6"><a href="r-miscelanea-e-topicos-avancados.html#cb213-6"></a><span class="co"># de map_dbl().</span></span>
<span id="cb213-7"><a href="r-miscelanea-e-topicos-avancados.html#cb213-7"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> f, <span class="dt">y =</span> y, <span class="dt">z =</span> z)</span>
<span id="cb213-8"><a href="r-miscelanea-e-topicos-avancados.html#cb213-8"></a><span class="co"># Forma 2: Passando uma função anônima de dois argumentos.</span></span>
<span id="cb213-9"><a href="r-miscelanea-e-topicos-avancados.html#cb213-9"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="cf">function</span>(x, y, z) x <span class="op">*</span><span class="st"> </span>y <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>z , <span class="dt">y =</span> y, <span class="dt">z =</span> z)</span>
<span id="cb213-10"><a href="r-miscelanea-e-topicos-avancados.html#cb213-10"></a><span class="co"># Forma 3: Utilizamos .x e .y em situações de funções com 2 argumentos.</span></span>
<span id="cb213-11"><a href="r-miscelanea-e-topicos-avancados.html#cb213-11"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x <span class="op">*</span><span class="st"> </span>.y <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>..<span class="dv">3</span>, <span class="dt">y =</span> y, <span class="dt">..3 =</span> z)</span>
<span id="cb213-12"><a href="r-miscelanea-e-topicos-avancados.html#cb213-12"></a><span class="co"># Forma 4: Aqui o x .x será substituido na ocorrência de &quot;.&quot; (ponto).</span></span>
<span id="cb213-13"><a href="r-miscelanea-e-topicos-avancados.html#cb213-13"></a>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span>.y <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>..<span class="dv">3</span>, <span class="dt">y =</span> y, <span class="dt">..3 =</span> z)</span></code></pre></div>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Nas formas 3 e 4 do exercício acima, você poderá substituir <code>..3</code> por <code>z</code>, ou seja, considerar, por exemplo, <code>purrr::map(.x = x, .f = ~ .x * .y + 2 * ..3, y = y, z = z)</code> irá funcionar. Isso se deve ao fato do funcional <code>map()</code> ser uma função <strong>vararg</strong>, em que os argumentos adicionais (não pertencentes à <code>map()</code>) serão acrescentados na função passada ao argumento <code>.f</code> de <code>map()</code>.</p>
<p><strong>Se <code>f()</code> é uma função com <code>n</code> argumentos, você poderá referenciar os seus argumentos por <code>..1</code> (primeiro argumetno), <code>..2</code> (segundo argumento), <code>..3</code> (terceiro argumento), …, <code>..n</code>, com <code>n</code> um número inteiro qualquer.</strong></p>
</div>
</div>

<p><strong>Observação</strong>:</p>

<div class="rmdobservation">
<div class="text-justify">
<p>O uso de <code>.</code> para especificar o primeiro elemento de uma função passada como argumento à <code>.f</code> em um dos funcionais do pacote <strong>purrr</strong> poderá gerar conflitos em situações em que você esteja utilizando o pacote <strong>magrittr</strong> em que <code>.</code> tem um outro significado.</p>
</div>
</div>

</div>
<div id="map2-e-variantes" class="section level4">
<h4><span class="header-section-number">5.3.2.2</span> map2() e variantes</h4>
<p>O funcional <code>map2()</code> tem grande utilidade em situações em que desejamos percorrer simultaneamente dois argumentos, isto é, quando temos que a função passada como argumento à <code>.f</code> possui dois argumentos e desejamos aplicar a função, par a par, sobre os elementos passados aos argumentos <code>.x</code> e <code>.y</code>, respectivamente. Em outras palavras, o uso do funcional <code>map2()</code> é útil em situações em que temos interesse de não deixar fixo o segundo argumento da função passada à <code>.f</code>. Assim como nas variantes do funcional <code>map()</code>, temos que as variantes do funcional <code>map2()</code> (<code>map2_int()</code>, <code>map2_dbl()</code> <code>map2_lgl()</code> e <code>map2_chr()</code>) ireão retornar um vetor com elementos do tipo referente ao sufixo utilizado.</p>
<p><strong>Forma geral de uso</strong>:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="r-miscelanea-e-topicos-avancados.html#cb214-1"></a><span class="kw">map2</span>(.x, .y, .f, ...)</span>
<span id="cb214-2"><a href="r-miscelanea-e-topicos-avancados.html#cb214-2"></a><span class="kw">map2_int</span>(.x, .y, .f, ...)</span>
<span id="cb214-3"><a href="r-miscelanea-e-topicos-avancados.html#cb214-3"></a><span class="kw">map2_dbl</span>(.x, .y, .f, ...)</span>
<span id="cb214-4"><a href="r-miscelanea-e-topicos-avancados.html#cb214-4"></a><span class="kw">map2_lgl</span>(.x, .y, .f, ...)</span>
<span id="cb214-5"><a href="r-miscelanea-e-topicos-avancados.html#cb214-5"></a><span class="kw">map2_chr</span>(.x, .y, .f, ...)</span></code></pre></div>
<p><strong>Nota</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>O uso do funcional <code>map2()</code> é análago ao uso de <code>map()</code> e suas variantes, com a diferença que o segundo argumento não estará fixo.</p>
</div>
</div>

<p><strong>Exemplo</strong>: Uso da função <code>map2()</code> em que estão sendo somados, par a par, os elementos dos objetos <code>x</code> e <code>y</code>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="r-miscelanea-e-topicos-avancados.html#cb215-1"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb215-2"><a href="r-miscelanea-e-topicos-avancados.html#cb215-2"></a>y &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="dv">5</span><span class="op">:</span><span class="dv">12</span>)</span>
<span id="cb215-3"><a href="r-miscelanea-e-topicos-avancados.html#cb215-3"></a>purrr<span class="op">::</span><span class="kw">map2</span>(<span class="dt">.x =</span> x, <span class="dt">.y =</span> y, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x <span class="op">+</span><span class="st"> </span>.y)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2 4 6
## 
## [[2]]
## [1] 5 5
## 
## [[3]]
## [1]  8 10 12 14 16 18 20 22</code></pre>
</div>
<div id="pmap-e-variantes" class="section level4">
<h4><span class="header-section-number">5.3.2.3</span> pmap() e variantes</h4>
<p>Algo muito parecido com o funcional <code>Map()</code> e <code>mapply()</code>do <strong>R Base</strong> é o que podemos fazer com o funcional <code>pmap()</code> do pacote <strong>purrr</strong>. Analogamente ao que temos com <code>Map()</code> e <code>mapply()</code>, ao utilizar o funcional <code>pmap()</code> poderemos variar mais de um argumeto.</p>
<p><strong>Forma geral de uso</strong>:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="r-miscelanea-e-topicos-avancados.html#cb217-1"></a><span class="kw">pmap</span>(.l, .f, ...)</span>
<span id="cb217-2"><a href="r-miscelanea-e-topicos-avancados.html#cb217-2"></a><span class="kw">pmap_int</span>(.l, .f, ...)</span>
<span id="cb217-3"><a href="r-miscelanea-e-topicos-avancados.html#cb217-3"></a><span class="kw">pmap_dbl</span>(.l, .f, ...)</span>
<span id="cb217-4"><a href="r-miscelanea-e-topicos-avancados.html#cb217-4"></a><span class="kw">pmap_lgl</span>(.l, .f, ...)</span>
<span id="cb217-5"><a href="r-miscelanea-e-topicos-avancados.html#cb217-5"></a><span class="kw">pmap_chr</span>(.l, .f, ...)</span></code></pre></div>
<p><strong>Exemplo</strong>: Uso do funcional <code>pmap()</code> variando, par a par, sobre elementos de duas listas (<code>x</code> e <code>y</code>) e um vetor (<code>z</code>).</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="r-miscelanea-e-topicos-avancados.html#cb218-1"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb218-2"><a href="r-miscelanea-e-topicos-avancados.html#cb218-2"></a>y &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="dv">5</span><span class="op">:</span><span class="dv">12</span>)</span>
<span id="cb218-3"><a href="r-miscelanea-e-topicos-avancados.html#cb218-3"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb218-4"><a href="r-miscelanea-e-topicos-avancados.html#cb218-4"></a>purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="dt">.l =</span> <span class="kw">list</span>(x, y, z), <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x <span class="op">+</span><span class="st"> </span>.y <span class="op">+</span><span class="st"> </span>..<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 3 5 7
## 
## [[2]]
## [1] 7 7
## 
## [[3]]
## [1] 11 13 15 17 19 21 23 25</code></pre>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<p>O funcional <code>pmap()</code> poderá ser utilizado, de forma análoga ao exemplo acima, em situações em que a função passada ao argumento <code>.f</code> possa ter mais de três variáveis não fixadas. Porém, perceba que ao utilizar o funcional <code>pmap()</code>, nada impedirá que você tenha algumas dessas variáveis fixadas, se isso for de interesse. Esse fato também é válido para os funcionais <code>Map()</code> e <code>mapply()</code> do <strong>R Base</strong> e para o funcional <code>map2()</code> do pacote <strong>purrr</strong>.</p>
</div>
</div>

<p><strong>Exemplo</strong>: Uso do funcional <code>pmap()</code> variando em duas listas (<code>x</code>, <code>y</code>) e um vetor <code>z</code>. Perceba que a quantidade de elementos nos objetos <code>x</code>, <code>y</code> e <code>z</code> é a mesma, ou seja, os objetos <code>x</code> e <code>y</code> são duas listas com dois vetores, respectivamente e <code>z</code> é um vetor com dois elementos.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="r-miscelanea-e-topicos-avancados.html#cb220-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, z) x <span class="op">+</span><span class="st"> </span>y <span class="op">-</span><span class="st"> </span>z</span>
<span id="cb220-2"><a href="r-miscelanea-e-topicos-avancados.html#cb220-2"></a></span>
<span id="cb220-3"><a href="r-miscelanea-e-topicos-avancados.html#cb220-3"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">1</span>))</span>
<span id="cb220-4"><a href="r-miscelanea-e-topicos-avancados.html#cb220-4"></a>y &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb220-5"><a href="r-miscelanea-e-topicos-avancados.html#cb220-5"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="co"># Vetor fixo.</span></span>
<span id="cb220-6"><a href="r-miscelanea-e-topicos-avancados.html#cb220-6"></a></span>
<span id="cb220-7"><a href="r-miscelanea-e-topicos-avancados.html#cb220-7"></a>purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="dt">.l =</span> <span class="kw">list</span>(x, y, z), <span class="dt">.f =</span> f)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2 2 6
## 
## [[2]]
## [1]  4  4  8 10  5</code></pre>
</div>
<div id="invoke-e-invoke_map" class="section level4">
<h4><span class="header-section-number">5.3.2.4</span> invoke() e invoke_map()</h4>
<p>A funcional <code>invoke()</code> é bastante semelhante ao funcional <code>do.call()</code> do <strong>R Base</strong>. Ambos os funcionais são úteis quando temos os argumentos de uma função em uma lista e posteriormente desejamos invocar uma função passando a lista de argumentos.</p>
<p><strong>Exemplo</strong>: Passando a lista <code>runif_args</code> para a função <code>runif()</code> usando os funcionais do.call() (do <strong>R Base</strong>) e invoke (pacote <strong>purrr</strong>).</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="r-miscelanea-e-topicos-avancados.html#cb222-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>) <span class="co"># Fixando uma semente.</span></span>
<span id="cb222-2"><a href="r-miscelanea-e-topicos-avancados.html#cb222-2"></a><span class="co"># Lista de argumentos para passar à função runif().</span></span>
<span id="cb222-3"><a href="r-miscelanea-e-topicos-avancados.html#cb222-3"></a>runif_args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">10</span>)</span>
<span id="cb222-4"><a href="r-miscelanea-e-topicos-avancados.html#cb222-4"></a><span class="co"># Usando do.call() do R Base.</span></span>
<span id="cb222-5"><a href="r-miscelanea-e-topicos-avancados.html#cb222-5"></a><span class="kw">do.call</span>(<span class="dt">what =</span> runif, <span class="dt">args =</span> runif_args)</span></code></pre></div>
<pre><code>## [1] 8.966972 2.655087 3.721239</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="r-miscelanea-e-topicos-avancados.html#cb224-1"></a><span class="co"># Usando invoke() do pacote purrr.</span></span>
<span id="cb224-2"><a href="r-miscelanea-e-topicos-avancados.html#cb224-2"></a>purrr<span class="op">::</span><span class="kw">invoke</span>(<span class="dt">.f =</span> runif, <span class="dt">.x =</span> runif_args)</span></code></pre></div>
<pre><code>## [1] 5.728534 9.082078 2.016819</code></pre>
<p>Nas situações em que desejamos aplicar uma função à uma <strong>lista de listas</strong> de argumentos ou aplicar uma lista de argumentos à uma lista de funções, o funcional <code>invoke_map()</code> poderá ser de grande utilidade. O exemplo que segue mostra essas duas situações mencionadas.</p>
<p><strong>Exemplo</strong>:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="r-miscelanea-e-topicos-avancados.html#cb226-1"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(valor, por) valor <span class="op">+</span><span class="st"> </span>por</span>
<span id="cb226-2"><a href="r-miscelanea-e-topicos-avancados.html#cb226-2"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(valor, por) valor <span class="op">-</span><span class="st"> </span>por</span>
<span id="cb226-3"><a href="r-miscelanea-e-topicos-avancados.html#cb226-3"></a>f3 &lt;-<span class="st"> </span><span class="cf">function</span>(valor, por) valor <span class="op">*</span><span class="st"> </span>por</span>
<span id="cb226-4"><a href="r-miscelanea-e-topicos-avancados.html#cb226-4"></a>f4 &lt;-<span class="st"> </span><span class="cf">function</span>(valor, por) valor <span class="op">/</span><span class="st"> </span>por</span>
<span id="cb226-5"><a href="r-miscelanea-e-topicos-avancados.html#cb226-5"></a></span>
<span id="cb226-6"><a href="r-miscelanea-e-topicos-avancados.html#cb226-6"></a><span class="co"># Passando uma lista de listas de argumentos para a função f1.</span></span>
<span id="cb226-7"><a href="r-miscelanea-e-topicos-avancados.html#cb226-7"></a>purrr<span class="op">::</span><span class="kw">invoke_map</span>(<span class="dt">.f =</span> f1, <span class="dt">.x =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">valor =</span> <span class="dv">1</span>, <span class="dt">por =</span> <span class="dv">1</span>),</span>
<span id="cb226-8"><a href="r-miscelanea-e-topicos-avancados.html#cb226-8"></a>                                     <span class="kw">list</span>(<span class="dt">valor =</span> <span class="dv">2</span>, <span class="dt">por =</span> <span class="dv">2</span>), </span>
<span id="cb226-9"><a href="r-miscelanea-e-topicos-avancados.html#cb226-9"></a>                                     <span class="kw">list</span>(<span class="dt">valor =</span> <span class="fl">7.1</span>, <span class="dt">por =</span> <span class="dv">10</span>)))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 17.1</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="r-miscelanea-e-topicos-avancados.html#cb228-1"></a><span class="co"># Passando uma lista de funções para a lista de argumentos passada </span></span>
<span id="cb228-2"><a href="r-miscelanea-e-topicos-avancados.html#cb228-2"></a><span class="co"># à .x do funcional invoke_map().</span></span>
<span id="cb228-3"><a href="r-miscelanea-e-topicos-avancados.html#cb228-3"></a>purrr<span class="op">::</span><span class="kw">invoke_map</span>(<span class="dt">.f =</span> <span class="kw">list</span>(f1, f2, f3, f4), <span class="dt">.x =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">valor =</span> <span class="dv">2</span>, <span class="dt">por =</span> <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4
## 
## [[2]]
## [1] 0
## 
## [[3]]
## [1] 4
## 
## [[4]]
## [1] 1</code></pre>
</div>
</div>
<div id="exercicios-3" class="section level3 unnumbered">
<h3>Exercícios</h3>
<ol style="list-style-type: decimal">
<li><p>Considerando o data frame <strong>iris</strong> (150 observações e 5 variáveis), obtenha a média das variáveis quantitativas por meio do uso de um funcional.</p></li>
<li><p>O que o código abaixo faz? Reescreva o código abaixo, substitundo o loop <code>for()</code> pelo uso de um funcional. <strong>Dica</strong>: Utilize a função <code>sapply()</code>.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="r-miscelanea-e-topicos-avancados.html#cb230-1"></a>vetor &lt;-<span class="st"> </span>1L<span class="op">:</span>10L</span>
<span id="cb230-2"><a href="r-miscelanea-e-topicos-avancados.html#cb230-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb230-3"><a href="r-miscelanea-e-topicos-avancados.html#cb230-3"></a>   v &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb230-4"><a href="r-miscelanea-e-topicos-avancados.html#cb230-4"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(x)){</span>
<span id="cb230-5"><a href="r-miscelanea-e-topicos-avancados.html#cb230-5"></a>      v[i] &lt;-<span class="st"> </span>x[i] <span class="op">+</span><span class="st"> </span>x[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>] </span>
<span id="cb230-6"><a href="r-miscelanea-e-topicos-avancados.html#cb230-6"></a>   }</span>
<span id="cb230-7"><a href="r-miscelanea-e-topicos-avancados.html#cb230-7"></a></span>
<span id="cb230-8"><a href="r-miscelanea-e-topicos-avancados.html#cb230-8"></a>   <span class="co"># A função na.omit() remove ocorrências de NA </span></span>
<span id="cb230-9"><a href="r-miscelanea-e-topicos-avancados.html#cb230-9"></a>   <span class="co"># no vetor passado como argumento.</span></span>
<span id="cb230-10"><a href="r-miscelanea-e-topicos-avancados.html#cb230-10"></a>   v &lt;-<span class="st"> </span><span class="kw">na.omit</span>(v) </span>
<span id="cb230-11"><a href="r-miscelanea-e-topicos-avancados.html#cb230-11"></a>   <span class="kw">attributes</span>(v) &lt;-<span class="st"> </span><span class="ot">NULL</span>; v</span>
<span id="cb230-12"><a href="r-miscelanea-e-topicos-avancados.html#cb230-12"></a>}</span></code></pre></div></li>
</ol>
<!-- mydiff <- function(i, x){ -->
<!--    x[i] + x[i+1] -->
<!-- } -->
<!-- loop <- function() sapply(X = 1L:9L, FUN = mydiff, x = vetor) -->
<ol start="3" style="list-style-type: decimal">
<li>Refaça o exercício anterior utilizando a função <code>vapply()</code>.</li>
</ol>
<!-- vetor <- 1L:10L -->
<!-- mysum <- function(i, x)  x[i] + x[i+1] -->
<!-- result <- vapply(X = 1:length(vetor), FUN = mysum, FUN.VALUE = double(1), x = vetor) %>%  -->
<!--                  na.omit  -->
<!-- attributes(result) <- NULL -->
<ol start="4" style="list-style-type: decimal">
<li><p>Leia a descrição do funcional <code>accumulate()</code> do pacote <strong>purrr</strong> e entenda o código abaixo:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="r-miscelanea-e-topicos-avancados.html#cb231-1"></a>  x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb231-2"><a href="r-miscelanea-e-topicos-avancados.html#cb231-2"></a>  purrr<span class="op">::</span><span class="kw">accumulate</span>(<span class="dt">.x =</span> x, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw">sum</span>(.x) <span class="op">+</span><span class="st"> </span>.y)</span></code></pre></div></li>
<li><p>Reescreva o código abaixo utilizando o funcional <code>accumulate()</code> do pacote <strong>purrr</strong>.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="r-miscelanea-e-topicos-avancados.html#cb232-1"></a>acumular &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb232-2"><a href="r-miscelanea-e-topicos-avancados.html#cb232-2"></a>   vetor &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb232-3"><a href="r-miscelanea-e-topicos-avancados.html#cb232-3"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(x)){</span>
<span id="cb232-4"><a href="r-miscelanea-e-topicos-avancados.html#cb232-4"></a>      vetor[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(vetor[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span>x[i]</span>
<span id="cb232-5"><a href="r-miscelanea-e-topicos-avancados.html#cb232-5"></a>   }</span>
<span id="cb232-6"><a href="r-miscelanea-e-topicos-avancados.html#cb232-6"></a>   vetor</span>
<span id="cb232-7"><a href="r-miscelanea-e-topicos-avancados.html#cb232-7"></a>}</span></code></pre></div>
<!-- purrr::accumulate(.x = c(1, 2, 3), .f = ~ .x + .y) --></li>
<li><p>Implemente a função <code>isnumeric(x)</code> que deverá recebe um data frame e retornar um vetor lógico informando <code>TRUE</code>, se a coluna é numerica ou <code>FALSE</code>, caso contrário. Implemente de três formas, tal que:</p>
<ul>
<li><p><strong>Forma 1</strong>: Implementar utilizando a estrutura de repetição <code>for()</code>;</p></li>
<li><p><strong>Forma 2</strong>: Implementar utilizando o funcional <code>sapply()</code>;</p></li>
<li><p><strong>Forma 3</strong>: Implementar utilizando o functional <code>vapply()</code>.</p></li>
</ul></li>
<li><p>A função <code>unique()</code> quando aplicada à um vetor, retornará um outro vetor com os elementos não repetidos do vetor passado como argumento à <code>unique()</code>. Implemente a função <code>countdiff(x)</code> que recebe como argumento um vetor, matriz ou tabela (data frame), de forma que retorne a quantidade de elementos distintos no vetor ou nas colunas da matriz/tabala.</p></li>
<li><p>Considere o objeto <code>lista &lt;- list(1:2, list(c(8, 7), c(1, 4)))</code>. Utilizando o funcional <code>map()</code>, obtenha a saída abaixo. <strong>Dica</strong>: 1 - Use <code>map()</code> dentro de <code>map()</code>. 2 - Ao final, utilize o comando <code>flatten()</code> do pacote <strong>purrr</strong>. A saída a baixo é nada mais que somar 1 em cada elemento da lista.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="r-miscelanea-e-topicos-avancados.html#cb233-1"></a>  [[<span class="dv">1</span>]]</span>
<span id="cb233-2"><a href="r-miscelanea-e-topicos-avancados.html#cb233-2"></a>  [<span class="dv">1</span>] <span class="dv">2</span></span>
<span id="cb233-3"><a href="r-miscelanea-e-topicos-avancados.html#cb233-3"></a></span>
<span id="cb233-4"><a href="r-miscelanea-e-topicos-avancados.html#cb233-4"></a>  [[<span class="dv">2</span>]]</span>
<span id="cb233-5"><a href="r-miscelanea-e-topicos-avancados.html#cb233-5"></a>  [<span class="dv">1</span>] <span class="dv">3</span></span>
<span id="cb233-6"><a href="r-miscelanea-e-topicos-avancados.html#cb233-6"></a></span>
<span id="cb233-7"><a href="r-miscelanea-e-topicos-avancados.html#cb233-7"></a>  [[<span class="dv">3</span>]]</span>
<span id="cb233-8"><a href="r-miscelanea-e-topicos-avancados.html#cb233-8"></a>  [<span class="dv">1</span>] <span class="dv">9</span> <span class="dv">8</span></span>
<span id="cb233-9"><a href="r-miscelanea-e-topicos-avancados.html#cb233-9"></a></span>
<span id="cb233-10"><a href="r-miscelanea-e-topicos-avancados.html#cb233-10"></a>  [[<span class="dv">4</span>]]</span>
<span id="cb233-11"><a href="r-miscelanea-e-topicos-avancados.html#cb233-11"></a>  [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">5</span></span></code></pre></div></li>
</ol>
<!-- lista <- list(1:2, list(c(8, 7), c(1, 4))) -->
<!-- map(.x = lista, ~ map(., .f = ~ .x + 1)) %>%  flatten -->
<ol start="9" style="list-style-type: decimal">
<li><p>Por meio da documentação do funcional <code>map_if()</code> do pacote <strong>purrr</strong>, entenda o que o código abaixo faz:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="r-miscelanea-e-topicos-avancados.html#cb234-1"></a>   x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb234-2"><a href="r-miscelanea-e-topicos-avancados.html#cb234-2"></a>   purrr<span class="op">::</span><span class="kw">map_if</span>(<span class="dt">.x =</span> x, <span class="dt">.p =</span> <span class="op">~</span><span class="st"> </span>.x <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, </span>
<span id="cb234-3"><a href="r-miscelanea-e-topicos-avancados.html#cb234-3"></a>                 <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>.x, <span class="dt">.else =</span> <span class="op">~</span><span class="st"> </span>.x <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</span></code></pre></div></li>
<li><p>Considere o objeto <code>lista</code> definido por <code>lista &lt;- list(a = c(1, 3, 2), b = c(2, 3))</code>. Utilizando o funcional <code>map_if()</code>, multiplique os elementos pares por 2 de forma a obter a saída abaixo:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="r-miscelanea-e-topicos-avancados.html#cb235-1"></a><span class="op">$</span>a</span>
<span id="cb235-2"><a href="r-miscelanea-e-topicos-avancados.html#cb235-2"></a><span class="op">$</span>a[[<span class="dv">1</span>]]</span>
<span id="cb235-3"><a href="r-miscelanea-e-topicos-avancados.html#cb235-3"></a>[<span class="dv">1</span>] <span class="dv">1</span></span>
<span id="cb235-4"><a href="r-miscelanea-e-topicos-avancados.html#cb235-4"></a></span>
<span id="cb235-5"><a href="r-miscelanea-e-topicos-avancados.html#cb235-5"></a><span class="op">$</span>a[[<span class="dv">2</span>]]</span>
<span id="cb235-6"><a href="r-miscelanea-e-topicos-avancados.html#cb235-6"></a>[<span class="dv">1</span>] <span class="dv">3</span></span>
<span id="cb235-7"><a href="r-miscelanea-e-topicos-avancados.html#cb235-7"></a></span>
<span id="cb235-8"><a href="r-miscelanea-e-topicos-avancados.html#cb235-8"></a><span class="op">$</span>a[[<span class="dv">3</span>]]</span>
<span id="cb235-9"><a href="r-miscelanea-e-topicos-avancados.html#cb235-9"></a>[<span class="dv">1</span>] <span class="dv">4</span></span>
<span id="cb235-10"><a href="r-miscelanea-e-topicos-avancados.html#cb235-10"></a></span>
<span id="cb235-11"><a href="r-miscelanea-e-topicos-avancados.html#cb235-11"></a><span class="op">$</span>b</span>
<span id="cb235-12"><a href="r-miscelanea-e-topicos-avancados.html#cb235-12"></a><span class="op">$</span>b[[<span class="dv">1</span>]]</span>
<span id="cb235-13"><a href="r-miscelanea-e-topicos-avancados.html#cb235-13"></a>[<span class="dv">1</span>] <span class="dv">4</span></span>
<span id="cb235-14"><a href="r-miscelanea-e-topicos-avancados.html#cb235-14"></a></span>
<span id="cb235-15"><a href="r-miscelanea-e-topicos-avancados.html#cb235-15"></a><span class="op">$</span>b[[<span class="dv">2</span>]]</span>
<span id="cb235-16"><a href="r-miscelanea-e-topicos-avancados.html#cb235-16"></a>[<span class="dv">1</span>] <span class="dv">3</span></span></code></pre></div>
<p><strong>Dica</strong>: Tente construir algo como <code>map(.x = lista, .f = ~ map_if())</code>.</p></li>
</ol>
<!-- purrr::map(.x = lista, .f = ~ map_if(.x, .p = ~ .x %% 2 == 0 , .f = ~ .x * 2)) -->
<ol start="11" style="list-style-type: decimal">
<li>A função <code>split()</code> divide um data frame em grupos de um fator. Por exemplo, faça <code>iris %$% split(., Species)</code>. Dado isso, considere o conjunto de dados <strong>starwars</strong> do pacote <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> (<code>install.packages("dplyr")</code>) que possui várias descrições dos personagens de Star Wars. Obtenha a quantidade de personagens por espécies utilizando o funcional <code>map()</code>.</li>
</ol>
<!-- purrr::map(.x = split(starwars, starwars$species), .f = ~dim(.x)[1]) -->
</div>
</div>
<div id="sistema-s3" class="section level2">
<h2><span class="header-section-number">5.4</span> Sistema S3</h2>
<p>S3 é o primeiro e mais simples sistema de <a href="https://pt.wikipedia.org/wiki/Orienta%C3%A7%C3%A3o_a_objetos"><strong>Orientação à Objeto (OO)</strong></a> da linguagem R. Por ser o primeiro sistema de OO da linguagem R, S3 é o sistema mais utilizado nos pacotes disponíveis no <a href="https://cran.r-project.org/"><strong>Comprehensive R Archive Network - CRAN</strong></a>, além de ser o sistema de OO utilizado na implementação dos pacotes <strong>base</strong> (<strong>R Base</strong>) e no pacote <strong>stats</strong>, ambos pacotes disponíveis por padrão em qualquer instalação de R. Aliás, o <strong>base</strong> é o principal pacote de R, sendo este o pacote de define a linguagem R com suas funções básicas. A linguagem R permite o uso de outros sistemas de OO como o S4, RC e R6, sendo o sistema R6 disponível pelo pacote <a href="https://r6.r-lib.org/"><strong>R6</strong></a> o mais formal e disponível em forma de um pacote desenvolvido por <a href="https://github.com/wch"><strong>Winston Chang</strong></a>.</p>
<p>O S3 implementa um estilo de OO chamado OO de função genérica. Esse sistema é diferente da maioria das linguagens de programação com paradigma de OO, como, por exemplo, Java, C++, Ruby, Python e C#, que implementam o sistema de OO por transmissão de mensagens. Com a passagem de mensagens para um objeto, este determina qual método (função) irá chamar. Nessas linguagens, invocamos um método para um objeto fazendo algo como <code>objeto.metodo()</code>, em que <code>objeto</code> é um objeto qualquer pertencente à uma classe e <code>metodo()</code> é uma função qualquer disponível à objetos dessa classe. Por exemplo, você poderia ter algo como <code>M.inverse()</code> que calcularia a inversa do objeto <code>M</code> da classe <code>matrix</code>. Dessa forma, se o objeto <code>M</code> é assinado com uma classe, os métodos (funções) disponíveis para esse objeto estão encapsulados no interior do objeto. OO, em R, de forma mais próxima aos sistemas de linguagens OO tracionais é possível com o sistema R6 do pacote <a href="https://r6.r-lib.org/"><strong>R6</strong></a>. Esse sistema é utilizado no pacote <a href="https://github.com/tidyverse/ggplot2"><strong>ggplot2</strong></a>.</p>
<p>Ao contrário dos sistemas tradicionais de OO, no sistema de OO S3, os métodos não estão dentro (encapsulados) dos objetos. Esses são invocados por uma função genérica que é responsável por invocar o método correto. Considere o exemplo abaixo:</p>
<p><strong>Exemplo</strong>:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="r-miscelanea-e-topicos-avancados.html#cb236-1"></a>vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">1.2</span>, <span class="fl">4.4</span>)</span>
<span id="cb236-2"><a href="r-miscelanea-e-topicos-avancados.html#cb236-2"></a>modelo &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> mtcars, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb236-3"><a href="r-miscelanea-e-topicos-avancados.html#cb236-3"></a><span class="co"># Calculando o sumário de um vetor.</span></span>
<span id="cb236-4"><a href="r-miscelanea-e-topicos-avancados.html#cb236-4"></a><span class="kw">summary</span>(vetor)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    1.40    2.50    3.10    4.05    7.00</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="r-miscelanea-e-topicos-avancados.html#cb238-1"></a><span class="co"># Obtendo o sumário de um modelo de regressão.</span></span>
<span id="cb238-2"><a href="r-miscelanea-e-topicos-avancados.html#cb238-2"></a><span class="kw">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ cyl + disp + wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4020 -1.4067 -0.4948  1.3471  6.0717 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 41.072990   2.839375  14.466 1.61e-14 ***
## cyl         -1.778054   0.606451  -2.932  0.00664 ** 
## disp         0.007275   0.011797   0.617  0.54243    
## wt          -3.623447   1.037898  -3.491  0.00161 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.595 on 28 degrees of freedom
## Multiple R-squared:  0.8325, Adjusted R-squared:  0.8146 
## F-statistic: 46.39 on 3 and 28 DF,  p-value: 5.446e-11</code></pre>
<p>Perceba que a função <code>summary()</code> atuou de formas distintas sobre os objetos <code>vetor</code> e <code>modelo</code> que pertencem às classes <strong>numeric</strong> e <strong>lm</strong>, respectivamente. A função <code>summary()</code> invocou o método para realizar o trabalho correto sobre o objeto em questão. Trata-se de uma função genérica (uma interface) responsável por invocar o método correto. Essa função estará associada à diversas outras funções. É a função genérica que irá despachar o método (função) correta para trabalhar com objeto em questão. Note que a função <code>summary()</code> (função genérica) é uma implementação muito simples. Veja o seu conteúdo abaixo:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="r-miscelanea-e-topicos-avancados.html#cb240-1"></a><span class="kw">body</span>(<span class="dt">fun =</span> summary)</span></code></pre></div>
<pre><code>## UseMethod(&quot;summary&quot;)</code></pre>
<p>Para o exemplo acima, a função genérica <code>summary()</code> invocou os métodos <code>default()</code> e <code>lm</code> para trabalharem sobre os objetos <code>vetor</code> e <code>modelo</code>, respectivamente. Por exemplo, você poderia ter feito o papel da função genérica <code>summary()</code>, fazendo:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="r-miscelanea-e-topicos-avancados.html#cb242-1"></a>vetor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">1.2</span>, <span class="fl">4.4</span>)</span>
<span id="cb242-2"><a href="r-miscelanea-e-topicos-avancados.html#cb242-2"></a>modelo &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> mtcars, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb242-3"><a href="r-miscelanea-e-topicos-avancados.html#cb242-3"></a><span class="co"># Calculando o sumário de um vetor.</span></span>
<span id="cb242-4"><a href="r-miscelanea-e-topicos-avancados.html#cb242-4"></a><span class="kw">summary.default</span>(vetor)</span>
<span id="cb242-5"><a href="r-miscelanea-e-topicos-avancados.html#cb242-5"></a><span class="co"># Obtendo o sumário de um modelo de regressão.</span></span>
<span id="cb242-6"><a href="r-miscelanea-e-topicos-avancados.html#cb242-6"></a><span class="kw">summary.lm</span>(modelo)</span></code></pre></div>
<p>Além dos métodos <code>default()</code> e <code>lm()</code> associados à função genérica <code>summary()</code>, diversos outros métodos podem ser despachado por <code>summary()</code>. Faça em um prompt de comando da linguagem R, por exemplo, <code>summary</code> + <strong>Tab</strong> para obter uma lista dos métodos disponíveis para a função genérica <code>summary()</code>. Uma outra forma mais eficiente de fazer isso é utilizando a função <code>methods()</code>, como mostra o código abaixo:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="r-miscelanea-e-topicos-avancados.html#cb243-1"></a><span class="co"># Listando todos os métodos associados </span></span>
<span id="cb243-2"><a href="r-miscelanea-e-topicos-avancados.html#cb243-2"></a><span class="co"># à função genérica summary().</span></span>
<span id="cb243-3"><a href="r-miscelanea-e-topicos-avancados.html#cb243-3"></a><span class="kw">methods</span>(<span class="dt">generic.function =</span> summary) <span class="co"># or methods(generic.function = &quot;summary&quot;)</span></span></code></pre></div>
<pre><code>##  [1] summary.aov                    summary.aovlist*              
##  [3] summary.aspell*                summary.check_packages_in_dir*
##  [5] summary.cohesiveBlocks*        summary.connection            
##  [7] summary.data.frame             summary.Date                  
##  [9] summary.default                summary.ecdf*                 
## [11] summary.factor                 summary.gexf*                 
## [13] summary.ggplot*                summary.glm                   
## [15] summary.hcl_palettes*          summary.igraph*               
## [17] summary.infl*                  summary.lm                    
## [19] summary.loess*                 summary.manova                
## [21] summary.matrix                 summary.mlm*                  
## [23] summary.nls*                   summary.packageStatus*        
## [25] summary.POSIXct                summary.POSIXlt               
## [27] summary.ppr*                   summary.prcomp*               
## [29] summary.princomp*              summary.proc_time             
## [31] summary.rlang_error*           summary.rlang_trace*          
## [33] summary.srcfile                summary.srcref                
## [35] summary.stepfun                summary.stl*                  
## [37] summary.table                  summary.tukeysmooth*          
## [39] summary.vctrs_sclr*            summary.vctrs_vctr*           
## [41] summary.warnings               summary.XMLInternalDocument*  
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>Para saber se uma determinada função é genérica e em caso afirmavo saber qual método foi despachado, o uso do pacote <a href="https://github.com/r-lib/sloop"><strong>sloop</strong></a> poderá ser útil. O pacote encontra-se no CRAN e poderá ser instalado fazendo <code>install.packages("devtools")</code>. Considere o exemplo que segue:</p>
<p><strong>Exemplo</strong>:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="r-miscelanea-e-topicos-avancados.html#cb245-1"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(1L<span class="op">:</span>4L, <span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb245-2"><a href="r-miscelanea-e-topicos-avancados.html#cb245-2"></a></span>
<span id="cb245-3"><a href="r-miscelanea-e-topicos-avancados.html#cb245-3"></a><span class="co"># Indica que print() é um objeto do sistema S3</span></span>
<span id="cb245-4"><a href="r-miscelanea-e-topicos-avancados.html#cb245-4"></a><span class="co"># de OO e além disso, informa que trata-se de</span></span>
<span id="cb245-5"><a href="r-miscelanea-e-topicos-avancados.html#cb245-5"></a><span class="co"># uma função genérica.</span></span>
<span id="cb245-6"><a href="r-miscelanea-e-topicos-avancados.html#cb245-6"></a>sloop<span class="op">::</span><span class="kw">ftype</span>(<span class="dt">f =</span> print)</span></code></pre></div>
<pre><code>## [1] &quot;S3&quot;      &quot;generic&quot;</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="r-miscelanea-e-topicos-avancados.html#cb247-1"></a><span class="co"># A seta indica qual método está sendo utilizado para </span></span>
<span id="cb247-2"><a href="r-miscelanea-e-topicos-avancados.html#cb247-2"></a><span class="co"># imprimir o objeto x. Nesse caso, print(x) despacha</span></span>
<span id="cb247-3"><a href="r-miscelanea-e-topicos-avancados.html#cb247-3"></a><span class="co"># o método default() associado à função genérica print().</span></span>
<span id="cb247-4"><a href="r-miscelanea-e-topicos-avancados.html#cb247-4"></a>sloop<span class="op">::</span><span class="kw">s3_dispatch</span>(<span class="kw">print</span>(x))</span></code></pre></div>
<pre><code>##    print.matrix
##    print.integer
##    print.numeric
## =&gt; print.default</code></pre>
<div id="classes" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Classes</h3>
<p>No sistema S3 não há uma definição formal de classe. Para definir um objeto como pertencente à uma determinada classe, bastará definir um atributo de classe ao objeto utilizando as funções <code>structure()</code> ou <code>class&lt;-</code>(). O exempo que deixará claro como isso poderá ser feito:</p>
<p><strong>Exemplo</strong>:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="r-miscelanea-e-topicos-avancados.html#cb249-1"></a><span class="co"># Fazendo list() tpertencer à uma classe qualquer</span></span>
<span id="cb249-2"><a href="r-miscelanea-e-topicos-avancados.html#cb249-2"></a><span class="co"># de nome &quot;any_class&quot;.</span></span>
<span id="cb249-3"><a href="r-miscelanea-e-topicos-avancados.html#cb249-3"></a>x &lt;-<span class="st"> </span><span class="kw">structure</span>(<span class="kw">list</span>(), <span class="dt">class =</span> <span class="st">&quot;any_class&quot;</span>)</span>
<span id="cb249-4"><a href="r-miscelanea-e-topicos-avancados.html#cb249-4"></a><span class="kw">class</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;any_class&quot;</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="r-miscelanea-e-topicos-avancados.html#cb251-1"></a><span class="co"># ou</span></span>
<span id="cb251-2"><a href="r-miscelanea-e-topicos-avancados.html#cb251-2"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb251-3"><a href="r-miscelanea-e-topicos-avancados.html#cb251-3"></a><span class="kw">class</span>(x) &lt;-<span class="st"> &quot;any_class&quot;</span></span>
<span id="cb251-4"><a href="r-miscelanea-e-topicos-avancados.html#cb251-4"></a><span class="kw">class</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;any_class&quot;</code></pre>
<p><strong>Importante</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<p>Perceba que a classe de um objeto não é nada mais que um atributo do objeto, em que esse atributo tem o nome <strong>class</strong>. Faça, por exemplo <code>attributes(x)</code> para obter uma lista de atributos associados à um objeto. Você poderá incluir qualquer outro atributo ao objeto <code>x</code>, se for de seu interesse, porém, deverá existir apenas um atributo de nome <strong>class</strong> que controla a classe do objeto.</p>
</div>
</div>

<p><strong>Exemplo</strong>: Você poderá determinar qual a classe de um objeto fazendo e perguntar se um objeto pertence à uma instância de classe, como mostra o código que segue:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="r-miscelanea-e-topicos-avancados.html#cb253-1"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb253-2"><a href="r-miscelanea-e-topicos-avancados.html#cb253-2"></a><span class="kw">class</span>(x) &lt;-<span class="st"> &quot;any_class&quot;</span></span>
<span id="cb253-3"><a href="r-miscelanea-e-topicos-avancados.html#cb253-3"></a><span class="co"># Perguntando a classe do objeto x.</span></span>
<span id="cb253-4"><a href="r-miscelanea-e-topicos-avancados.html#cb253-4"></a><span class="kw">class</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;any_class&quot;</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="r-miscelanea-e-topicos-avancados.html#cb255-1"></a><span class="co"># Perguntando e o objeto x pertência à instância de </span></span>
<span id="cb255-2"><a href="r-miscelanea-e-topicos-avancados.html#cb255-2"></a><span class="co"># classe de nome any_class.</span></span>
<span id="cb255-3"><a href="r-miscelanea-e-topicos-avancados.html#cb255-3"></a><span class="kw">inherits</span>(x, <span class="dt">what =</span> <span class="st">&quot;any_class&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="criando-funcoes-genericas" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Criando funções genéricas</h3>
<p>O trabalho de um S3 genérico é executar o envio do método, ou seja, encontrar a implementação específica para uma classe. O envio do método é realizado por <code>UseMethod()</code>.</p>
<p><strong>Exemplo</strong>: Veja que <code>print()</code> e <code>summary()</code> são funções genéricas, cuja a implementação faz uso da função <code>UseMethod()</code>.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="r-miscelanea-e-topicos-avancados.html#cb257-1"></a>sloop<span class="op">::</span><span class="kw">ftype</span>(summary)</span></code></pre></div>
<pre><code>## [1] &quot;S3&quot;      &quot;generic&quot;</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="r-miscelanea-e-topicos-avancados.html#cb259-1"></a>sloop<span class="op">::</span><span class="kw">ftype</span>(print)</span></code></pre></div>
<pre><code>## [1] &quot;S3&quot;      &quot;generic&quot;</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="r-miscelanea-e-topicos-avancados.html#cb261-1"></a><span class="co"># Corpo da função genérica summary().</span></span>
<span id="cb261-2"><a href="r-miscelanea-e-topicos-avancados.html#cb261-2"></a><span class="kw">body</span>(summary)</span></code></pre></div>
<pre><code>## UseMethod(&quot;summary&quot;)</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="r-miscelanea-e-topicos-avancados.html#cb263-1"></a><span class="co"># Corpo da função genérica print().</span></span>
<span id="cb263-2"><a href="r-miscelanea-e-topicos-avancados.html#cb263-2"></a><span class="kw">body</span>(print)</span></code></pre></div>
<pre><code>## UseMethod(&quot;print&quot;)</code></pre>
<p>A função <code>UseMethod()</code> usa dois argumentos: o nome da função genérica (obrigatório) e o argumento a ser usado para o método de envio (opcional). Se você omitir o segundo argumento, ele será despachado com base no primeiro argumento, que é quase sempre o que é desejado.</p>
<p><strong>Exemplo</strong>: Criando a função genérica <code>f()</code>. O método <code>default()</code> é um método auxiliar que será utilizado caso a classe o argumento passado à função <code>f()</code> pertença à uma classe que não há um método associado á função genérica <code>f()</code>. Perceba que <code>f(x)</code> fará uso do método <code>myclass()</code> e <code>f(y)</code> fará uso do método <code>default()</code>, uma vez que <code>y</code> não foi assinado com um objeto pertencente à classe <strong>myclass</strong>.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="r-miscelanea-e-topicos-avancados.html#cb265-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">UseMethod</span>(<span class="st">&quot;f&quot;</span>)</span>
<span id="cb265-2"><a href="r-miscelanea-e-topicos-avancados.html#cb265-2"></a><span class="co"># Função que trabalha com objeto da classe myclass.</span></span>
<span id="cb265-3"><a href="r-miscelanea-e-topicos-avancados.html#cb265-3"></a>f.myclass &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb265-4"><a href="r-miscelanea-e-topicos-avancados.html#cb265-4"></a>   <span class="kw">warning</span>(<span class="st">&quot;Foi executado o método myclass: mesmo que f.myclass(x)&quot;</span>)</span>
<span id="cb265-5"><a href="r-miscelanea-e-topicos-avancados.html#cb265-5"></a>   <span class="kw">print</span>(x <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb265-6"><a href="r-miscelanea-e-topicos-avancados.html#cb265-6"></a>}</span>
<span id="cb265-7"><a href="r-miscelanea-e-topicos-avancados.html#cb265-7"></a>f.default &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb265-8"><a href="r-miscelanea-e-topicos-avancados.html#cb265-8"></a>   <span class="kw">warning</span>(<span class="st">&quot;Foi executado o método default: mesmo que f.default(x)&quot;</span>)</span>
<span id="cb265-9"><a href="r-miscelanea-e-topicos-avancados.html#cb265-9"></a>   <span class="kw">print</span>(x)</span>
<span id="cb265-10"><a href="r-miscelanea-e-topicos-avancados.html#cb265-10"></a>} </span>
<span id="cb265-11"><a href="r-miscelanea-e-topicos-avancados.html#cb265-11"></a>x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span>1L<span class="op">:</span>10L</span>
<span id="cb265-12"><a href="r-miscelanea-e-topicos-avancados.html#cb265-12"></a><span class="kw">class</span>(x) &lt;-<span class="st"> &quot;myclass&quot;</span></span>
<span id="cb265-13"><a href="r-miscelanea-e-topicos-avancados.html#cb265-13"></a><span class="kw">f</span>(x)</span></code></pre></div>
<pre><code>## Warning in f.myclass(x): Foi executado o método myclass: mesmo que
## f.myclass(x)</code></pre>
<pre><code>##  [1]  2  3  4  5  6  7  8  9 10 11
## attr(,&quot;class&quot;)
## [1] &quot;myclass&quot;</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="r-miscelanea-e-topicos-avancados.html#cb268-1"></a><span class="co"># Será executado o método default, uma vez que o objeto</span></span>
<span id="cb268-2"><a href="r-miscelanea-e-topicos-avancados.html#cb268-2"></a><span class="co"># y não foi assinado com a classe myclass.</span></span>
<span id="cb268-3"><a href="r-miscelanea-e-topicos-avancados.html#cb268-3"></a><span class="kw">f</span>(y)</span></code></pre></div>
<pre><code>## Warning in f.default(y): Foi executado o método default: mesmo que
## f.default(x)</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="r-miscelanea-e-topicos-avancados.html#cb271-1"></a><span class="co"># Checando se f é um objeto da classe S3 e se trata-se </span></span>
<span id="cb271-2"><a href="r-miscelanea-e-topicos-avancados.html#cb271-2"></a><span class="co"># de uma função genérica.</span></span>
<span id="cb271-3"><a href="r-miscelanea-e-topicos-avancados.html#cb271-3"></a>sloop<span class="op">::</span><span class="kw">ftype</span>(f)</span></code></pre></div>
<pre><code>## [1] &quot;S3&quot;      &quot;generic&quot;</code></pre>
<p><strong>Observação</strong>:</p>

<div class="rmdobservation">
<div class="text-justify">
<p>Perceba que utiliza <code>.</code> no nome de uma função não ocasionará problemas de conflito, mas poderá nos deixar com dúvidas, uma vez que não sabemos se o que está antes do ponto é uma função genérica e logo após o seu método ou se apenas trata-se de uma função que usa <code>.</code> no seu nome. Por exemplo, se olharmos apenas para <code>f.a()</code> não ficará claro se <code>f()</code> é uma função genérica e <code>a()</code> um método de <code>f()</code> ou se temos uma função comum de nome <code>f.a</code>.</p>
</div>
</div>

</div>
<div id="exercicio" class="section level3 unnumbered">
<h3>Exercício</h3>
<p>1 - A função função <code>dim()</code> é uma função genérica? Explique. Em caso afirmativo, quantos métodos possui essa função?</p>
<p>2 - Explique o por quê da saída do código que segue:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="r-miscelanea-e-topicos-avancados.html#cb273-1"></a>x &lt;-<span class="st"> </span>1L<span class="op">:</span>10L</span>
<span id="cb273-2"><a href="r-miscelanea-e-topicos-avancados.html#cb273-2"></a><span class="kw">class</span>(x) &lt;-<span class="st"> &quot;test&quot;</span></span>
<span id="cb273-3"><a href="r-miscelanea-e-topicos-avancados.html#cb273-3"></a><span class="kw">t</span>(x)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  x
## t = 5.7446, df = 9, p-value = 0.0002782
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  3.334149 7.665851
## sample estimates:
## mean of x 
##       5.5</code></pre>
<p>3 - Crie o método <code>print.conc(x, y, sep = "", ...)</code> para a função genérica <code>print()</code>. O método deverá concatenar dois objetos da classe <strong>conc</strong>. O método deverá funcionar da forma abaixo:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="r-miscelanea-e-topicos-avancados.html#cb275-1"></a>str1 &lt;-<span class="st"> &quot;Estudando&quot;</span> </span>
<span id="cb275-2"><a href="r-miscelanea-e-topicos-avancados.html#cb275-2"></a><span class="kw">class</span>(str1) &lt;-<span class="st"> &quot;conc&quot;</span></span>
<span id="cb275-3"><a href="r-miscelanea-e-topicos-avancados.html#cb275-3"></a>str2 &lt;-<span class="st"> &quot;R&quot;</span></span>
<span id="cb275-4"><a href="r-miscelanea-e-topicos-avancados.html#cb275-4"></a><span class="kw">print</span>(<span class="dt">x =</span> str1, <span class="dt">y =</span> str2, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Estudando&quot;
## attr(,&quot;class&quot;)
## [1] &quot;conc&quot;</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="r-miscelanea-e-topicos-avancados.html#cb277-1"></a><span class="co"># [1] &quot;Estudando R&quot;</span></span></code></pre></div>
<!-- print.paste <- function(x, y, sep = "", ...){ -->
<!--   if (is.character(x) == FALSE || is.character(x) == FALSE) -->
<!--     stop("Os argumentos devem ser strings.") -->
<!--   paste(x, y, sep = sep, ...) -->
<!-- } -->
<!-- str1 <- "Pedro" -->
<!-- class(str1) <- "paste" -->
<!-- str2 <- "Rafael" -->
<!-- print(x = str1, y = str2)     -->
<p>4 - Informe a saída do código abaixo. Explique!</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="r-miscelanea-e-topicos-avancados.html#cb278-1"></a>y &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb278-2"><a href="r-miscelanea-e-topicos-avancados.html#cb278-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb278-3"><a href="r-miscelanea-e-topicos-avancados.html#cb278-3"></a>   y &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb278-4"><a href="r-miscelanea-e-topicos-avancados.html#cb278-4"></a>   <span class="kw">UseMethod</span>(<span class="st">&quot;f&quot;</span>)</span>
<span id="cb278-5"><a href="r-miscelanea-e-topicos-avancados.html#cb278-5"></a>}</span>
<span id="cb278-6"><a href="r-miscelanea-e-topicos-avancados.html#cb278-6"></a>f.numeric &lt;-<span class="st"> </span><span class="cf">function</span>(x) y</span>
<span id="cb278-7"><a href="r-miscelanea-e-topicos-avancados.html#cb278-7"></a><span class="kw">f</span>(<span class="dv">10</span>); <span class="kw">f.numeric</span>(<span class="dv">7</span>)</span></code></pre></div>
<p>5 - Informe a saída do código abaixo. Explique!</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="r-miscelanea-e-topicos-avancados.html#cb279-1"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">UseMethod</span>(<span class="st">&quot;g&quot;</span>)</span>
<span id="cb279-2"><a href="r-miscelanea-e-topicos-avancados.html#cb279-2"></a></span>
<span id="cb279-3"><a href="r-miscelanea-e-topicos-avancados.html#cb279-3"></a>g.character &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">paste</span>(<span class="st">&quot;char&quot;</span>, x)</span>
<span id="cb279-4"><a href="r-miscelanea-e-topicos-avancados.html#cb279-4"></a>g.numeric &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">paste</span>(<span class="st">&quot;num&quot;</span>, x)</span>
<span id="cb279-5"><a href="r-miscelanea-e-topicos-avancados.html#cb279-5"></a>g.default &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="st">&quot;?&quot;</span></span>
<span id="cb279-6"><a href="r-miscelanea-e-topicos-avancados.html#cb279-6"></a></span>
<span id="cb279-7"><a href="r-miscelanea-e-topicos-avancados.html#cb279-7"></a><span class="kw">g</span>(<span class="st">&quot;1&quot;</span>)</span>
<span id="cb279-8"><a href="r-miscelanea-e-topicos-avancados.html#cb279-8"></a><span class="kw">g</span>(<span class="dv">1</span>)</span>
<span id="cb279-9"><a href="r-miscelanea-e-topicos-avancados.html#cb279-9"></a><span class="kw">g</span>(<span class="ot">TRUE</span>)</span></code></pre></div>
<p>6 - A função abaixo implementa o método <code>summary.character()</code>. O que esse método faz? Por que não foi preciso assinar o objeto <code>x</code>? Entenda o código:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="r-miscelanea-e-topicos-avancados.html#cb280-1"></a>summary.character &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb280-2"><a href="r-miscelanea-e-topicos-avancados.html#cb280-2"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="kw">inherits</span>(x, <span class="dt">what =</span> <span class="st">&quot;character&quot;</span>)) <span class="kw">stop</span>(<span class="st">&quot;x must be of character type&quot;</span>)  </span>
<span id="cb280-3"><a href="r-miscelanea-e-topicos-avancados.html#cb280-3"></a>  n_char &lt;-<span class="st"> </span><span class="kw">nchar</span>(x)</span>
<span id="cb280-4"><a href="r-miscelanea-e-topicos-avancados.html#cb280-4"></a>  vetor_chr &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="dt">x =</span> x, <span class="dt">split =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb280-5"><a href="r-miscelanea-e-topicos-avancados.html#cb280-5"></a>  <span class="cf">if</span> (<span class="kw">is.list</span>(vetor_chr) <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){</span>
<span id="cb280-6"><a href="r-miscelanea-e-topicos-avancados.html#cb280-6"></a>    list_factor &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> vetor_chr, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(.x))</span>
<span id="cb280-7"><a href="r-miscelanea-e-topicos-avancados.html#cb280-7"></a>    n_diff &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dt">.x =</span> list_factor, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(.x)))</span>
<span id="cb280-8"><a href="r-miscelanea-e-topicos-avancados.html#cb280-8"></a>  } <span class="cf">else</span> </span>
<span id="cb280-9"><a href="r-miscelanea-e-topicos-avancados.html#cb280-9"></a>    n_diff &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(<span class="kw">as.factor</span>(vetor_chr)))</span>
<span id="cb280-10"><a href="r-miscelanea-e-topicos-avancados.html#cb280-10"></a>  </span>
<span id="cb280-11"><a href="r-miscelanea-e-topicos-avancados.html#cb280-11"></a>  <span class="kw">list</span>(<span class="dt">nchr =</span> n_char, <span class="dt">ndiff =</span> n_diff)</span>
<span id="cb280-12"><a href="r-miscelanea-e-topicos-avancados.html#cb280-12"></a>}</span>
<span id="cb280-13"><a href="r-miscelanea-e-topicos-avancados.html#cb280-13"></a><span class="kw">summary</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;aabb&quot;</span>, <span class="st">&quot;aaa&quot;</span>))</span></code></pre></div>
<pre><code>## $nchr
## [1] 4 3
## 
## $ndiff
## $ndiff[[1]]
## [1] 2
## 
## $ndiff[[2]]
## [1] 1</code></pre>
<p>7 - Construa a função genérica <code>mydiag(x)</code> que recebe como argumento uma matriz ou tabela (data frame) que podem conter valores numéricos ou caracters, com o número de linhas é igual ao número de colunas. Depois, defina dois métodos, <code>mydiag.numeric()</code> e <code>mydiag.character()</code> que retorna a soma da diagonal principal do objeto passado à <code>x</code>. Para a matriz/tabela de caracteres, considere A/a como 1, B/b como 2, …, Z/z como 26, respectivamente. <strong>Dicas</strong>: 1 - As função <code>tolower()</code> poderá ajudar a converter um caracter em letra maiúscila para minúscula. 2 - Para o caso de matriz/tabela com strings, considere apenas o primeiro caracter da string. Por exemplo:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="r-miscelanea-e-topicos-avancados.html#cb282-1"></a>m1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb282-2"><a href="r-miscelanea-e-topicos-avancados.html#cb282-2"></a><span class="kw">mydiag</span>(m1)</span>
<span id="cb282-3"><a href="r-miscelanea-e-topicos-avancados.html#cb282-3"></a><span class="co"># [1] 5</span></span>
<span id="cb282-4"><a href="r-miscelanea-e-topicos-avancados.html#cb282-4"></a>m2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="st">&quot;casa&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;barco&quot;</span>, <span class="st">&quot;terra&quot;</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb282-5"><a href="r-miscelanea-e-topicos-avancados.html#cb282-5"></a><span class="kw">mydiag</span>(m2)</span>
<span id="cb282-6"><a href="r-miscelanea-e-topicos-avancados.html#cb282-6"></a><span class="co"># [1] 23</span></span></code></pre></div>
<p>8 - Leia o artigo <a href="https://projecteuclid.org/download/pdfview_1/euclid.ss/1408368569"><strong>Object-Oriented Programming, Functional Programming and R</strong></a> de John M. Chambers. Nesse artigo, o autor disserta sobre os paradigmas de programação disponíveis em R e trás um pouco da evolução da linguagem.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="relatorio-markdown-em-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="topicos-em-estatistica-computacional.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/prdm0/aulas_computacional/edit/master/r.Rmd",
"text": "Editar"
},
"history": {
"link": null,
"text": null
},
"download": ["aulas_r.pdf"],
"toc": {
"collapse": null
},
"toolbar": {
"position": "fixed",
"download": ["aulas_r.pdf", "Aulas de R"],
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
